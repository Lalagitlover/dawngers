try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="c50cf7e4-f114-4e02-a578-f104ced7373f",e._sentryDebugIdIdentifier="sentry-dbid-c50cf7e4-f114-4e02-a578-f104ced7373f")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6012],{138:function(e,t,n){"use strict";var o,r=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(o=function(e){return(o=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t})(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=o(e),a=0;a<n.length;a++)"default"!==n[a]&&r(t,e,n[a]);return i(t,e),t}),s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionSplitPackages=void 0;let l=n(83151),d=c(n(331)),u=n(11769),h=n(82091),f=a(n(33394)),g=n(33394),p="ConnectionReceiveKey",v="ConnectionSendKey",b="ConnectionSenderVersionKey";class _{constructor(e){this.splitMessageSendArray=new Map,this.splitMessageReceivedArray=new Map,this.splitMessageSenderVersionMap=new Map,this.splitPackageCache=d.default.createInstance({name:l.OKXCONNECTOR_STORAGE_PROTOCOL_CACHE+e})}init(e){return s(this,void 0,void 0,function*(){if(yield this.recoverFromCache(),this.splitMessageSendArray.size>0){for(let[t,n]of this.splitMessageSendArray.entries())for(let o=0;o<n.length;){let r=n[o];try{yield e((0,h.safeJsonStringify)(r),t),f.logDebug(`Successfully sent payload: ${(0,h.safeJsonStringify)(r)} to topic: ${t}`),n.splice(o,1)}catch(e){f.logError(`Failed to send payload: ${(0,h.safeJsonStringify)(r)} to topic: ${t}`,e),r.retryCount=(r.retryCount||0)+1,r.retryCount>3?(f.logError(`Payload failed after 3 retries: ${(0,h.safeJsonStringify)(r)}`),n.splice(o,1)):o++}}yield this.syncCache()}})}tryParseMessageSplitPayload(e){var t;let n;try{if(e.trimStart().startsWith("{")){let o=(0,h.safeJsonParse)(e);o&&o.protocol_version&&o.protocol_version>=2&&o.package_group_id&&(null===(t=o.package_group_id)||void 0===t?void 0:t.length)>0&&(n=o)}else(0,g.logDebug)("not split packages")}catch(e){(0,g.logDebug)("not split packages")}return n}updateTopicSenderVersion(e,t){return s(this,void 0,void 0,function*(){this.splitMessageSenderVersionMap.set(e,t),yield this.syncCache(),(0,g.logDebug)("get update topic sender version: ",e,t)})}sendSplitPackages(e,t,n,o){return s(this,void 0,void 0,function*(){if(!e){f.logError("sendSplitPackages invalid topic");return}let r=this.splitMessageSenderVersionMap.get(e),i=t.length;try{if(i<63e3)throw Error(`no need to split (size:${i})`);if(!r||r&&r<2)throw Error(`version not support split (version: ${r})`);let n=[];for(let e=0;e<t.length;e+=63e3)e+63e3<t.length?n.push(t.slice(e,e+63e3)):n.push(t.slice(e));let a=(0,u.generateGroupId)(),s=n.map((t,o)=>({topicId:e,protocol_version:2,total_count:n.length,package_index:o,package_group_id:a,content:t}));this.mergePackageArray(!0,s);for(let t=0;t<s.length;){let n=s[t],r=(0,h.safeJsonStringify)(n);try{yield o(r,e),f.logDebug(`Successfully sent payload: ${r} to topic: ${e}`),s.splice(t,1)}catch(o){f.logError(`Failed to send payload: ${r} to topic: ${e}`,o),n.retryCount=(n.retryCount||0)+1,n.retryCount>3?(f.logError(`Payload failed after 3 retries: ${r}`),s.splice(t,1)):t++}}this.splitMessageSendArray.set(e,[]),yield this.syncCache()}catch(o){(0,g.logDebug)("send split packages no split"),(0,g.logDebug)(o),yield n(e,t)}})}onReceivedPackageCheck(e){return s(this,void 0,void 0,function*(){this.mergePackageArray(!1,[e]);let t=new Map,n=e.topicId;this.splitMessageReceivedArray.forEach((n,o)=>{o==e.topicId&&n.forEach(e=>{if(e.messageObject.package_group_id){let n=t.get(e.messageObject.package_group_id);n||(n=[]),n.push(e),t.set(e.messageObject.package_group_id,n)}})}),(0,g.logDebug)("on received message, check message cache");let o={isSplitPackage:!1};if(e.messageObject.package_group_id){o.isSplitPackage=!0;let r=t.get(e.messageObject.package_group_id);if(null==r?void 0:r.length){let t=new Set;if(r.forEach(e=>{void 0!==e.messageObject.package_index&&t.add(e.messageObject.package_index)}),t.size==e.messageObject.total_count){r.sort((e,t)=>(e.messageObject.package_index||0===e.messageObject.package_index)&&(t.messageObject.package_index||0===t.messageObject.package_index)?e.messageObject.package_index-t.messageObject.package_index:0);let e=r.reduce((e,t)=>(e.push(t.messageObject.content),e),[]),t=r.reduce((e,t)=>(e.push(t.messageId),e),[]);o.isSplitPackage=!0,o.finalMessage=e.join(""),o.completeMessageIdList=t;let i=this.splitMessageReceivedArray.get(n);i&&(i=i.filter(e=>!t.includes(e.messageId)),this.splitMessageReceivedArray.set(n,i)),yield this.syncCache()}}}return o})}mergePackageArray(e,t){return s(this,void 0,void 0,function*(){if((0,g.logDebug)("append sending array"),e){let e=t.filter(e=>{let t=e.topicId,n=!0,o=this.splitMessageSendArray.get(t);return null==o||o.forEach(t=>{t.package_group_id==e.package_group_id&&t.total_count==e.total_count&&t.package_index==e.package_index&&(n=!1)}),n});if(e.length>0){let t=e[0].topicId,n=this.splitMessageSendArray.get(t);n||(n=[]),n=n.concat(e),this.splitMessageSendArray.set(t,n),(0,g.logDebug)("append sending array (after filted): ",n)}}else{let e=t.filter(e=>{let t=e.topicId,n=!0,o=this.splitMessageReceivedArray.get(t);return null==o||o.forEach(t=>{t.messageId==e.messageId&&(n=!1)}),n});if(e.length>0){let t=e[0].topicId,n=this.splitMessageReceivedArray.get(t);n||(n=[]),n=n.concat(e),this.splitMessageReceivedArray.set(t,n),(0,g.logDebug)("append received array (after filted): ",n)}}})}syncCache(){return s(this,void 0,void 0,function*(){(0,g.logDebug)("sync split message cache"),yield this.splitPackageCache.setItem(p,this.splitMessageReceivedArray),yield this.splitPackageCache.setItem(v,this.splitMessageSendArray),yield this.splitPackageCache.setItem(b,this.splitMessageSenderVersionMap)})}recoverFromCache(){return s(this,void 0,void 0,function*(){let e=yield this.splitPackageCache.getItem(p);e?this.splitMessageReceivedArray=e:this.splitMessageReceivedArray=new Map;let t=yield this.splitPackageCache.getItem(v);t?this.splitMessageSendArray=t:this.splitMessageSendArray=new Map;let n=yield this.splitPackageCache.getItem(b);n?this.splitMessageSenderVersionMap=n:this.splitMessageSenderVersionMap=new Map})}}t.ConnectionSplitPackages=_},331:(e,t,n)=>{e.exports=(function e(t,n,o){function r(a,s){if(!n[a]){if(!t[a]){if(i)return i(a,!0);var c=Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){return r(t[a][1][e]||e)},l,l.exports,e,t,n,o)}return n[a].exports}for(var i=void 0,a=0;a<o.length;a++)r(o[a]);return r})({1:[function(e,t,o){(function(e){"use strict";var n,o,r=e.MutationObserver||e.WebKitMutationObserver;if(r){var i=0,a=new r(d),s=e.document.createTextNode("");a.observe(s,{characterData:!0}),n=function(){s.data=i=++i%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){d(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(d,0)};else{var c=new e.MessageChannel;c.port1.onmessage=d,n=function(){c.port2.postMessage(0)}}var l=[];function d(){o=!0;for(var e,t,n=l.length;n;){for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}o=!1}t.exports=function(e){1!==l.push(e)||o||n()}}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";var o=e(1);function r(){}var i={},a=["REJECTED"],s=["FULFILLED"],c=["PENDING"];function l(e){if("function"!=typeof e)throw TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==r&&f(this,e)}function d(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function u(e,t,n){o(function(){var o;try{o=t(n)}catch(t){return i.reject(e,t)}o===e?i.reject(e,TypeError("Cannot resolve promise with itself")):i.resolve(e,o)})}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var n=!1;function o(t){!n&&(n=!0,i.reject(e,t))}function r(t){!n&&(n=!0,i.resolve(e,t))}var a=g(function(){t(r,o)});"error"===a.status&&o(a.value)}function g(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}t.exports=l,l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===a)return this;var n=new this.constructor(r);return this.state!==c?u(n,this.state===s?e:t,this.outcome):this.queue.push(new d(n,e,t)),n},d.prototype.callFulfilled=function(e){i.resolve(this.promise,e)},d.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},d.prototype.callRejected=function(e){i.reject(this.promise,e)},d.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},i.resolve=function(e,t){var n=g(h,t);if("error"===n.status)return i.reject(e,n.value);var o=n.value;if(o)f(e,o);else{e.state=s,e.outcome=t;for(var r=-1,a=e.queue.length;++r<a;)e.queue[r].callFulfilled(t)}return e},i.reject=function(e,t){e.state=a,e.outcome=t;for(var n=-1,o=e.queue.length;++n<o;)e.queue[n].callRejected(t);return e},l.resolve=function(e){return e instanceof this?e:i.resolve(new this(r),e)},l.reject=function(e){var t=new this(r);return i.reject(t,e)},l.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(TypeError("must be an array"));var n=e.length,o=!1;if(!n)return this.resolve([]);for(var a=Array(n),s=0,c=-1,l=new this(r);++c<n;)!function(e,r){t.resolve(e).then(function(e){a[r]=e,++s!==n||o||(o=!0,i.resolve(l,a))},function(e){o||(o=!0,i.reject(l,e))})}(e[c],c);return l},l.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(TypeError("must be an array"));var n=e.length,o=!1;if(!n)return this.resolve([]);for(var a=-1,s=new this(r);++a<n;)!function(e){t.resolve(e).then(function(e){o||(o=!0,i.resolve(s,e))},function(e){o||(o=!0,i.reject(s,e))})}(e[a]);return s}},{1:1}],3:[function(e,t,o){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function i(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(r){if("TypeError"!==r.name)throw r;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),o=0;o<e.length;o+=1)n.append(e[o]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var a=Promise;function s(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function c(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function l(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function d(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var u="local-forage-detect-blob-support",h=void 0,f={},g=Object.prototype.toString,p="readonly",v="readwrite";function b(e){var t=f[e.name],n={};n.promise=new a(function(e,t){n.resolve=e,n.reject=t}),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then(function(){return n.promise}):t.dbReady=n.promise}function _(e){var t=f[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function y(e,t){var n=f[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function m(e,t){return new a(function(n,o){if(f[e.name]=f[e.name]||S(),e.db){if(!t)return n(e.db);b(e),e.db.close()}var i=[e.name];t&&i.push(e.version);var a=r.open.apply(r,i);t&&(a.onupgradeneeded=function(t){var n=a.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(u)}catch(n){if("ConstraintError"===n.name)console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw n}}),a.onerror=function(e){e.preventDefault(),o(a.error)},a.onsuccess=function(){var t=a.result;t.onversionchange=function(e){e.target.close()},n(t),_(e)}})}function O(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),o=e.version<e.db.version,r=e.version>e.db.version;if(o&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),r||n){if(n){var i=e.db.version+1;i>e.version&&(e.version=i)}return!0}return!1}function C(e){return i([function(e){for(var t=e.length,n=new ArrayBuffer(t),o=new Uint8Array(n),r=0;r<t;r++)o[r]=e.charCodeAt(r);return n}(atob(e.data))],{type:e.type})}function E(e){return e&&e.__local_forage_encoded_blob}function w(e){var t=this,n=t._initReady().then(function(){var e=f[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return c(n,e,e),n}function N(e,t,n,o){void 0===o&&(o=1);try{var r=e.db.transaction(e.storeName,t);n(null,r)}catch(r){if(o>0&&(!e.db||"InvalidStateError"===r.name||"NotFoundError"===r.name))return a.resolve().then(function(){if(!e.db||"NotFoundError"===r.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),m(e,!0)}).then(function(){return(function(e){b(e);for(var t=f[e.name],n=t.forages,o=0;o<n.length;o++){var r=n[o];r._dbInfo.db&&(r._dbInfo.db.close(),r._dbInfo.db=null)}return e.db=null,m(e,!1).then(function(t){return(e.db=t,O(e))?m(e,!0):t}).then(function(o){e.db=t.db=o;for(var r=0;r<n.length;r++)n[r]._dbInfo.db=o}).catch(function(t){throw y(e,t),t})})(e).then(function(){N(e,t,n,o-1)})}).catch(n);n(r)}}function S(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}var T={_driver:"asyncStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var o in e)n[o]=e[o];var r=f[n.name];r||(r=S(),f[n.name]=r),r.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=w);var i=[];function s(){return a.resolve()}for(var c=0;c<r.forages.length;c++){var l=r.forages[c];l!==t&&i.push(l._initReady().catch(s))}var d=r.forages.slice(0);return a.all(i).then(function(){return n.db=r.db,m(n,!1)}).then(function(e){return(n.db=e,O(n,t._defaultConfig.version))?m(n,!0):e}).then(function(e){n.db=r.db=e,t._dbInfo=n;for(var o=0;o<d.length;o++){var i=d[o];i!==t&&(i._dbInfo.db=n.db,i._dbInfo.version=n.version)}})},_support:function(){try{if(!r||!r.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var n=this,o=new a(function(t,o){n.ready().then(function(){N(n._dbInfo,p,function(r,i){if(r)return o(r);try{var a=i.objectStore(n._dbInfo.storeName).openCursor(),s=1;a.onsuccess=function(){var n=a.result;if(n){var o=n.value;E(o)&&(o=C(o));var r=e(o,n.key,s++);void 0!==r?t(r):n.continue()}else t()},a.onerror=function(){o(a.error)}}catch(e){o(e)}})}).catch(o)});return s(o,t),o},getItem:function(e,t){var n=this;e=l(e);var o=new a(function(t,o){n.ready().then(function(){N(n._dbInfo,p,function(r,i){if(r)return o(r);try{var a=i.objectStore(n._dbInfo.storeName).get(e);a.onsuccess=function(){var e=a.result;void 0===e&&(e=null),E(e)&&(e=C(e)),t(e)},a.onerror=function(){o(a.error)}}catch(e){o(e)}})}).catch(o)});return s(o,t),o},setItem:function(e,t,n){var o=this;e=l(e);var r=new a(function(n,r){var s;o.ready().then(function(){return(s=o._dbInfo,"[object Blob]"===g.call(t))?(function(e){return"boolean"==typeof h?a.resolve(h):new a(function(t){var n=e.transaction(u,v),o=i([""]);n.objectStore(u).put(o,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/);t(navigator.userAgent.match(/Edge\//)||!e||parseInt(e[1],10)>=43)}}).catch(function(){return!1}).then(function(e){return h=e})})(s.db).then(function(e){return e?t:new a(function(e,n){var o=new FileReader;o.onerror=n,o.onloadend=function(n){e({__local_forage_encoded_blob:!0,data:btoa(n.target.result||""),type:t.type})},o.readAsBinaryString(t)})}):t}).then(function(t){N(o._dbInfo,v,function(i,a){if(i)return r(i);try{var s=a.objectStore(o._dbInfo.storeName);null===t&&(t=void 0);var c=s.put(t,e);a.oncomplete=function(){void 0===t&&(t=null),n(t)},a.onabort=a.onerror=function(){var e=c.error?c.error:c.transaction.error;r(e)}}catch(e){r(e)}})}).catch(r)});return s(r,n),r},removeItem:function(e,t){var n=this;e=l(e);var o=new a(function(t,o){n.ready().then(function(){N(n._dbInfo,v,function(r,i){if(r)return o(r);try{var a=i.objectStore(n._dbInfo.storeName).delete(e);i.oncomplete=function(){t()},i.onerror=function(){o(a.error)},i.onabort=function(){var e=a.error?a.error:a.transaction.error;o(e)}}catch(e){o(e)}})}).catch(o)});return s(o,t),o},clear:function(e){var t=this,n=new a(function(e,n){t.ready().then(function(){N(t._dbInfo,v,function(o,r){if(o)return n(o);try{var i=r.objectStore(t._dbInfo.storeName).clear();r.oncomplete=function(){e()},r.onabort=r.onerror=function(){var e=i.error?i.error:i.transaction.error;n(e)}}catch(e){n(e)}})}).catch(n)});return s(n,e),n},length:function(e){var t=this,n=new a(function(e,n){t.ready().then(function(){N(t._dbInfo,p,function(o,r){if(o)return n(o);try{var i=r.objectStore(t._dbInfo.storeName).count();i.onsuccess=function(){e(i.result)},i.onerror=function(){n(i.error)}}catch(e){n(e)}})}).catch(n)});return s(n,e),n},key:function(e,t){var n=this,o=new a(function(t,o){if(e<0){t(null);return}n.ready().then(function(){N(n._dbInfo,p,function(r,i){if(r)return o(r);try{var a=i.objectStore(n._dbInfo.storeName),s=!1,c=a.openKeyCursor();c.onsuccess=function(){var n=c.result;if(!n){t(null);return}0===e?t(n.key):s?t(n.key):(s=!0,n.advance(e))},c.onerror=function(){o(c.error)}}catch(e){o(e)}})}).catch(o)});return s(o,t),o},keys:function(e){var t=this,n=new a(function(e,n){t.ready().then(function(){N(t._dbInfo,p,function(o,r){if(o)return n(o);try{var i=r.objectStore(t._dbInfo.storeName).openKeyCursor(),a=[];i.onsuccess=function(){var t=i.result;if(!t){e(a);return}a.push(t.key),t.continue()},i.onerror=function(){n(i.error)}}catch(e){n(e)}})}).catch(n)});return s(n,e),n},dropInstance:function(e,t){t=d.apply(this,arguments);var n,o=this.config();if((e="function"!=typeof e&&e||{}).name||(e.name=e.name||o.name,e.storeName=e.storeName||o.storeName),e.name){var i=e.name===o.name&&this._dbInfo.db?a.resolve(this._dbInfo.db):m(e,!1).then(function(t){var n=f[e.name],o=n.forages;n.db=t;for(var r=0;r<o.length;r++)o[r]._dbInfo.db=t;return t});n=e.storeName?i.then(function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;b(e);var o=f[e.name],i=o.forages;t.close();for(var s=0;s<i.length;s++){var c=i[s];c._dbInfo.db=null,c._dbInfo.version=n}return new a(function(t,o){var i=r.open(e.name,n);i.onerror=function(e){i.result.close(),o(e)},i.onupgradeneeded=function(){i.result.deleteObjectStore(e.storeName)},i.onsuccess=function(){var e=i.result;e.close(),t(e)}}).then(function(e){o.db=e;for(var t=0;t<i.length;t++){var n=i[t];n._dbInfo.db=e,_(n._dbInfo)}}).catch(function(t){throw(y(e,t)||a.resolve()).catch(function(){}),t})}}):i.then(function(t){b(e);var n=f[e.name],o=n.forages;t.close();for(var i=0;i<o.length;i++)o[i]._dbInfo.db=null;return new a(function(t,n){var o=r.deleteDatabase(e.name);o.onerror=function(){var e=o.result;e&&e.close(),n(o.error)},o.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},o.onsuccess=function(){var e=o.result;e&&e.close(),t(e)}}).then(function(e){n.db=e;for(var t=0;t<o.length;t++)_(o[t]._dbInfo)}).catch(function(t){throw(y(e,t)||a.resolve()).catch(function(){}),t})})}else n=a.reject("Invalid arguments");return s(n,t),n}},R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",D=/^~~local_forage_type~([^~]+)~/,I="__lfsc__:",P=I.length,k="arbf",K="blob",A="si08",x="ui08",L="uic8",M="si16",j="si32",U="ur16",W="ui32",X="fl32",H="fl64",B=P+k.length,J=Object.prototype.toString;function q(e){var t,n,o,r,i,a=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var l=new ArrayBuffer(a),d=new Uint8Array(l);for(t=0;t<s;t+=4)n=R.indexOf(e[t]),o=R.indexOf(e[t+1]),r=R.indexOf(e[t+2]),i=R.indexOf(e[t+3]),d[c++]=n<<2|o>>4,d[c++]=(15&o)<<4|r>>2,d[c++]=(3&r)<<6|63&i;return l}function $(e){var t,n=new Uint8Array(e),o="";for(t=0;t<n.length;t+=3)o+=R[n[t]>>2],o+=R[(3&n[t])<<4|n[t+1]>>4],o+=R[(15&n[t+1])<<2|n[t+2]>>6],o+=R[63&n[t+2]];return n.length%3==2?o=o.substring(0,o.length-1)+"=":n.length%3==1&&(o=o.substring(0,o.length-2)+"=="),o}var F={serialize:function(e,t){var n="";if(e&&(n=J.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===J.call(e.buffer))){var o,r=I;e instanceof ArrayBuffer?(o=e,r+=k):(o=e.buffer,"[object Int8Array]"===n?r+=A:"[object Uint8Array]"===n?r+=x:"[object Uint8ClampedArray]"===n?r+=L:"[object Int16Array]"===n?r+=M:"[object Uint16Array]"===n?r+=U:"[object Int32Array]"===n?r+=j:"[object Uint32Array]"===n?r+=W:"[object Float32Array]"===n?r+=X:"[object Float64Array]"===n?r+=H:t(Error("Failed to get type for BinaryArray"))),t(r+$(o))}else if("[object Blob]"===n){var i=new FileReader;i.onload=function(){t(I+K+("~~local_forage_type~"+e.type+"~")+$(this.result))},i.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}},deserialize:function(e){if(e.substring(0,P)!==I)return JSON.parse(e);var t,n=e.substring(B),o=e.substring(P,B);if(o===K&&D.test(n)){var r=n.match(D);t=r[1],n=n.substring(r[0].length)}var a=q(n);switch(o){case k:return a;case K:return i([a],{type:t});case A:return new Int8Array(a);case x:return new Uint8Array(a);case L:return new Uint8ClampedArray(a);case M:return new Int16Array(a);case U:return new Uint16Array(a);case j:return new Int32Array(a);case W:return new Uint32Array(a);case X:return new Float32Array(a);case H:return new Float64Array(a);default:throw Error("Unkown type: "+o)}},stringToBuffer:q,bufferToString:$};function V(e,t,n,o){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,o)}function G(e,t,n,o,r,i){e.executeSql(n,o,r,function(e,a){a.code===a.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],function(e,s){s.rows.length?i(e,a):V(e,t,function(){e.executeSql(n,o,r,i)},i)},i):i(e,a)},i)}function z(e,t,n,o){var r=this;e=l(e);var i=new a(function(i,a){r.ready().then(function(){void 0===t&&(t=null);var s=t,c=r._dbInfo;c.serializer.serialize(t,function(t,l){l?a(l):c.db.transaction(function(n){G(n,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,t],function(){i(s)},function(e,t){a(t)})},function(t){if(t.code===t.QUOTA_ERR){if(o>0){i(z.apply(r,[e,s,n,o-1]));return}a(t)}})})}).catch(a)});return s(i,n),i}var Y={_driver:"webSQLStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var o in e)n[o]="string"!=typeof e[o]?e[o].toString():e[o];var r=new a(function(e,o){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return o(e)}n.db.transaction(function(r){V(r,n,function(){t._dbInfo=n,e()},function(e,t){o(t)})},o)});return n.serializer=F,r},_support:"function"==typeof openDatabase,iterate:function(e,t){var n=this,o=new a(function(t,o){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){G(n,r,"SELECT * FROM "+r.storeName,[],function(n,o){for(var i=o.rows,a=i.length,s=0;s<a;s++){var c=i.item(s),l=c.value;if(l&&(l=r.serializer.deserialize(l)),void 0!==(l=e(l,c.key,s+1))){t(l);return}}t()},function(e,t){o(t)})})}).catch(o)});return s(o,t),o},getItem:function(e,t){var n=this;e=l(e);var o=new a(function(t,o){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){G(n,r,"SELECT * FROM "+r.storeName+" WHERE key = ? LIMIT 1",[e],function(e,n){var o=n.rows.length?n.rows.item(0).value:null;o&&(o=r.serializer.deserialize(o)),t(o)},function(e,t){o(t)})})}).catch(o)});return s(o,t),o},setItem:function(e,t,n){return z.apply(this,[e,t,n,1])},removeItem:function(e,t){var n=this;e=l(e);var o=new a(function(t,o){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){G(n,r,"DELETE FROM "+r.storeName+" WHERE key = ?",[e],function(){t()},function(e,t){o(t)})})}).catch(o)});return s(o,t),o},clear:function(e){var t=this,n=new a(function(e,n){t.ready().then(function(){var o=t._dbInfo;o.db.transaction(function(t){G(t,o,"DELETE FROM "+o.storeName,[],function(){e()},function(e,t){n(t)})})}).catch(n)});return s(n,e),n},length:function(e){var t=this,n=new a(function(e,n){t.ready().then(function(){var o=t._dbInfo;o.db.transaction(function(t){G(t,o,"SELECT COUNT(key) as c FROM "+o.storeName,[],function(t,n){e(n.rows.item(0).c)},function(e,t){n(t)})})}).catch(n)});return s(n,e),n},key:function(e,t){var n=this,o=new a(function(t,o){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){G(n,r,"SELECT key FROM "+r.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,n){t(n.rows.length?n.rows.item(0).key:null)},function(e,t){o(t)})})}).catch(o)});return s(o,t),o},keys:function(e){var t=this,n=new a(function(e,n){t.ready().then(function(){var o=t._dbInfo;o.db.transaction(function(t){G(t,o,"SELECT key FROM "+o.storeName,[],function(t,n){for(var o=[],r=0;r<n.rows.length;r++)o.push(n.rows.item(r).key);e(o)},function(e,t){n(t)})})}).catch(n)});return s(n,e),n},dropInstance:function(e,t){t=d.apply(this,arguments);var n,o=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||o.name,e.storeName=e.storeName||o.storeName);var r=this;return s(n=e.name?new a(function(t){var n;(n=e.name===o.name?r._dbInfo.db:openDatabase(e.name,"","",0),e.storeName)?t({db:n,storeNames:[e.storeName]}):t(new a(function(e,t){n.transaction(function(o){o.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(t,o){for(var r=[],i=0;i<o.rows.length;i++)r.push(o.rows.item(i).name);e({db:n,storeNames:r})},function(e,n){t(n)})},function(e){t(e)})}))}).then(function(e){return new a(function(t,n){e.db.transaction(function(o){for(var r=[],i=0,s=e.storeNames.length;i<s;i++)r.push(function(e){return new a(function(t,n){o.executeSql("DROP TABLE IF EXISTS "+e,[],function(){t()},function(e,t){n(t)})})}(e.storeNames[i]));a.all(r).then(function(){t()}).catch(function(e){n(e)})},function(e){n(e)})})}):a.reject("Invalid arguments"),t),n}};function Q(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}var Z={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var n in e)t[n]=e[n];return(t.keyPrefix=Q(e,this._defaultConfig),!function(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}()||localStorage.length>0)?(this._dbInfo=t,t.serializer=F,a.resolve()):a.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var n=this,o=n.ready().then(function(){for(var t=n._dbInfo,o=t.keyPrefix,r=o.length,i=localStorage.length,a=1,s=0;s<i;s++){var c=localStorage.key(s);if(0===c.indexOf(o)){var l=localStorage.getItem(c);if(l&&(l=t.serializer.deserialize(l)),void 0!==(l=e(l,c.substring(r),a++)))return l}}});return s(o,t),o},getItem:function(e,t){var n=this;e=l(e);var o=n.ready().then(function(){var t=n._dbInfo,o=localStorage.getItem(t.keyPrefix+e);return o&&(o=t.serializer.deserialize(o)),o});return s(o,t),o},setItem:function(e,t,n){var o=this;e=l(e);var r=o.ready().then(function(){void 0===t&&(t=null);var n=t;return new a(function(r,i){var a=o._dbInfo;a.serializer.serialize(t,function(t,o){if(o)i(o);else try{localStorage.setItem(a.keyPrefix+e,t),r(n)}catch(e){("QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&i(e),i(e)}})})});return s(r,n),r},removeItem:function(e,t){var n=this;e=l(e);var o=n.ready().then(function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return s(o,t),o},clear:function(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var o=localStorage.key(n);0===o.indexOf(e)&&localStorage.removeItem(o)}});return s(n,e),n},length:function(e){var t=this.keys().then(function(e){return e.length});return s(t,e),t},key:function(e,t){var n=this,o=n.ready().then(function(){var t,o=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(o.keyPrefix.length)),t});return s(o,t),o},keys:function(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo,n=localStorage.length,o=[],r=0;r<n;r++){var i=localStorage.key(r);0===i.indexOf(e.keyPrefix)&&o.push(i.substring(e.keyPrefix.length))}return o});return s(n,e),n},dropInstance:function(e,t){if(t=d.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n,o=this.config();e.name=e.name||o.name,e.storeName=e.storeName||o.storeName}var r=this;return s(n=e.name?new a(function(t){t(e.storeName?Q(e,r._defaultConfig):e.name+"/")}).then(function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}}):a.reject("Invalid arguments"),t),n}},ee=function(e,t){for(var n,o=e.length,r=0;r<o;){if((n=e[r])===t||"number"==typeof n&&"number"==typeof t&&isNaN(n)&&isNaN(t))return!0;r++}return!1},et=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},en={},eo={},er={INDEXEDDB:T,WEBSQL:Y,LOCALSTORAGE:Z},ei=[er.INDEXEDDB._driver,er.WEBSQL._driver,er.LOCALSTORAGE._driver],ea=["dropInstance"],es=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ea),ec={description:"",driver:ei.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function el(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(et(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}t.exports=new(function(){function e(t){for(var n in!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,e),er)if(er.hasOwnProperty(n)){var o=er[n],r=o._driver;this[n]=r,en[r]||this.defineDriver(o)}this._defaultConfig=el({},ec),this._config=el({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(e){if((void 0===e?"undefined":o(e))==="object"){if(this._ready)return Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var o=new a(function(t,n){try{var o=e._driver,r=Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver){n(r);return}for(var i=es.concat("_initStorage"),c=0,l=i.length;c<l;c++){var d=i[c];if((!ee(ea,d)||e[d])&&"function"!=typeof e[d]){n(r);return}}!function(){for(var t=function(e){return function(){var t=Error("Method "+e+" is not implemented by the current driver"),n=a.reject(t);return s(n,arguments[arguments.length-1]),n}},n=0,o=ea.length;n<o;n++){var r=ea[n];e[r]||(e[r]=t(r))}}();var u=function(n){en[o]&&console.info("Redefining LocalForage driver: "+o),en[o]=e,eo[o]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(u,n):u(!!e._support):u(!0)}catch(e){n(e)}});return c(o,t,n),o},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var o=en[e]?a.resolve(en[e]):a.reject(Error("Driver not found."));return c(o,t,n),o},e.prototype.getSerializer=function(e){var t=a.resolve(F);return c(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return c(n,e,e),n},e.prototype.setDriver=function(e,t,n){var o=this;et(e)||(e=[e]);var r=this._getSupportedDrivers(e);function i(){o._config.driver=o.driver()}function s(e){return o._extend(e),i(),o._ready=o._initStorage(o._config),o._ready}var l=null!==this._driverSet?this._driverSet.catch(function(){return a.resolve()}):a.resolve();return this._driverSet=l.then(function(){var e=r[0];return o._dbInfo=null,o._ready=null,o.getDriver(e).then(function(e){o._driver=e._driver,i(),o._wrapLibraryMethodsWithReady(),o._initDriver=function(){var e=0;return function t(){for(;e<r.length;){var n=r[e];return e++,o._dbInfo=null,o._ready=null,o.getDriver(n).then(s).catch(t)}i();var c=Error("No available storage method found.");return o._driverSet=a.reject(c),o._driverSet}()}})}).catch(function(){i();var e=Error("No available storage method found.");return o._driverSet=a.reject(e),o._driverSet}),c(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!eo[e]},e.prototype._extend=function(e){el(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,o=e.length;n<o;n++){var r=e[n];this.supports(r)&&t.push(r)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=es.length;e<t;e++)!function(e,t){e[t]=function(){var n=arguments;return e.ready().then(function(){return e[t].apply(e,n)})}}(this,es[e])},e.prototype.createInstance=function(t){return new e(t)},e}())},{3:3}]},{},[4])(4)},803:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OkxwalletInjectConnector=void 0;let o=n(88193);class r extends o.InjectConnector{constructor(){super(),this.walletName="OKX Wallet extension",this.walletNameKey="walletModal.mobileConnectionModal.connectInjected"}}t.OkxwalletInjectConnector=r},1461:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.NAMES_CHAINS=t.TON_CHAINS=t.COSMOS_CHAINS=t.APTOS_CHAINS=t.SUI_CHAINS=t.SOLANA_CHAINS=t.BTC_CHAINS=t.shortUniversalLink=t.downloadUrl=t.okxDeeplink=t.tonConnectSdkVersion=t.standardDeeplink=t.standardUniversalLink=t.OpenAppLinkType=t.NameSpaceKeyStarknet=t.NameSpaceKeyTron=t.NameSpaceKeyCosmos=t.NameSpaceKeyAptos=t.NameSpaceKeyBtc=t.NameSpaceKeySui=t.NameSpaceKeyTON=t.NameSpaceKeySOL=t.NameSpaceKeyEip155=void 0,r(n(68836),t);var i=n(67679);Object.defineProperty(t,"NameSpaceKeyEip155",{enumerable:!0,get:function(){return i.NameSpaceKeyEip155}}),Object.defineProperty(t,"NameSpaceKeySOL",{enumerable:!0,get:function(){return i.NameSpaceKeySOL}}),Object.defineProperty(t,"NameSpaceKeyTON",{enumerable:!0,get:function(){return i.NameSpaceKeyTON}}),Object.defineProperty(t,"NameSpaceKeySui",{enumerable:!0,get:function(){return i.NameSpaceKeySui}}),Object.defineProperty(t,"NameSpaceKeyBtc",{enumerable:!0,get:function(){return i.NameSpaceKeyBtc}}),Object.defineProperty(t,"NameSpaceKeyAptos",{enumerable:!0,get:function(){return i.NameSpaceKeyAptos}}),Object.defineProperty(t,"NameSpaceKeyCosmos",{enumerable:!0,get:function(){return i.NameSpaceKeyCosmos}}),Object.defineProperty(t,"NameSpaceKeyTron",{enumerable:!0,get:function(){return i.NameSpaceKeyTron}}),Object.defineProperty(t,"NameSpaceKeyStarknet",{enumerable:!0,get:function(){return i.NameSpaceKeyStarknet}}),Object.defineProperty(t,"OpenAppLinkType",{enumerable:!0,get:function(){return i.OpenAppLinkType}});var a=n(2856);Object.defineProperty(t,"standardUniversalLink",{enumerable:!0,get:function(){return a.standardUniversalLink}}),Object.defineProperty(t,"standardDeeplink",{enumerable:!0,get:function(){return a.standardDeeplink}}),Object.defineProperty(t,"tonConnectSdkVersion",{enumerable:!0,get:function(){return a.tonConnectSdkVersion}}),Object.defineProperty(t,"okxDeeplink",{enumerable:!0,get:function(){return a.okxDeeplink}}),Object.defineProperty(t,"downloadUrl",{enumerable:!0,get:function(){return a.downloadUrl}}),Object.defineProperty(t,"shortUniversalLink",{enumerable:!0,get:function(){return a.shortUniversalLink}}),r(n(85236),t);var s=n(49865);Object.defineProperty(t,"BTC_CHAINS",{enumerable:!0,get:function(){return s.BTC_CHAINS}}),Object.defineProperty(t,"SOLANA_CHAINS",{enumerable:!0,get:function(){return s.SOLANA_CHAINS}}),Object.defineProperty(t,"SUI_CHAINS",{enumerable:!0,get:function(){return s.SUI_CHAINS}}),Object.defineProperty(t,"APTOS_CHAINS",{enumerable:!0,get:function(){return s.APTOS_CHAINS}}),Object.defineProperty(t,"COSMOS_CHAINS",{enumerable:!0,get:function(){return s.COSMOS_CHAINS}}),Object.defineProperty(t,"TON_CHAINS",{enumerable:!0,get:function(){return s.TON_CHAINS}}),Object.defineProperty(t,"NAMES_CHAINS",{enumerable:!0,get:function(){return s.NAMES_CHAINS}})},2476:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})};function o(e,t){return n(this,void 0,void 0,function*(){return new Promise((n,o)=>{var r,i;if(null===(r=null==t?void 0:t.signal)||void 0===r?void 0:r.aborted){o(Error("Delay aborted"));return}let a=setTimeout(()=>n(),e);null===(i=null==t?void 0:t.signal)||void 0===i||i.addEventListener("abort",()=>{clearTimeout(a),o(Error("Delay aborted"))})})})}Object.defineProperty(t,"__esModule",{value:!0}),t.callForSuccess=function(e,t){return n(this,void 0,void 0,function*(){var n,r;let i;let a=null!==(n=null==t?void 0:t.attempts)&&void 0!==n?n:3,s=null!==(r=null==t?void 0:t.delayMs)&&void 0!==r?r:800;if("function"!=typeof e)throw Error(`Expected a function, got ${typeof e}`);let c=0;for(;c<a;)try{return yield e()}catch(e){i=e,++c<a&&(yield o(s))}throw i})},t.delay=o},2856:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OKX_MINI_WALLET_NAME=t.OKX_APP_WALLET_NAME=t.stackDeepLink=t.tgwalletAppName=t.tgwalletName=t.tonConnectSdkVersion=t.standardDeeplink=t.downloadUrl=t.shortUniversalLink=t.standardUniversalLink=t.okxDeeplink=void 0,t.getTestTwaUrl=function(){return window.okxTesttwaUrl},t.getTestTgTwaUrl=function(){return window.okxTestTgtwaUrl},t.getBotNameAndAppName=function(e){let t=new URL(e).pathname.split("/").filter(Boolean);if(t.length>=2)return{botName:t[0],appName:t[1]}},t.okxDeeplink="okx://web3",t.standardUniversalLink="undefined"!=typeof window&&window.location.hostname.includes("okx.com")?"https://link.okx.com/download":"https://www.okx.com/download",t.shortUniversalLink="undefined"!=typeof window&&window.location.hostname.includes("okx.com")?"https://link.okx.com/ul/connect":"https://www.okx.com/ul/connect",t.downloadUrl="https://www.okx.com/download",t.standardDeeplink=`${t.okxDeeplink}/wallet/connect`,t.tonConnectSdkVersion="1",t.tgwalletName="OKX_WALLET_BOT",t.tgwalletAppName="start",t.stackDeepLink="okx://web3?stack=true",t.OKX_APP_WALLET_NAME="OKX Wallet",t.OKX_MINI_WALLET_NAME="OKX Mini Wallet"},7536:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TgwalletConnector=void 0;let o=n(66122),r=n(14103),i=n(62332);class a extends o.WsConnector{constructor(){super(),this.walletName="OKX Mini Wallet",this.walletNameKey="walletModal.mobileConnectionModal.connectMini"}getTag(){return r.OKX_TG_WALLET}openWallet(e,t){e&&e.connectRequest&&(o=(0,i.encodeTWAConnectURLParams)(Object.assign(Object.assign({},e.connectRequest),{redirect:"none"})));var n,o,r=(0,i.getTelegramWalletTWAUrl)(o,null!==(n=null==e?void 0:e.tmaReturnUrl)&&void 0!==n?n:"back");(0,i.openOKXTMAWalletlinkWithFallback)(r)}}t.TgwalletConnector=a},9423:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.openLink=s,t.openLinkBlank=function(e){s(e,"_blank")},t.openDeeplinkWithFallback=function(e,t){let n=()=>{!(d("safari")||l("android")&&d("firefox"))&&t()},o=setTimeout(()=>n(),500);window.addEventListener("blur",()=>clearTimeout(o),{once:!0}),l("android")&&(0,a.inTg)()?s(e,"_blank"):s(e,"_self")},t.isMobileUserAgent=function(){var e;let t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.slice(0,4)))&&(t=!0),t},t.getUserAgent=c,t.isOS=l,t.isBrowser=d;let r=o(n(51945)),i=n(33394),a=n(19903);function s(e,t="_self"){(0,i.logDebug)("openLink",e,t),window.open(e,t,"noopener noreferrer")}function c(){var e,t,n;let o,i;let a=new r.default().getResult(),s=null===(e=a.os.name)||void 0===e?void 0:e.toLowerCase(),c=null===(t=a.device.model)||void 0===t?void 0:t.toLowerCase();switch(!0){case"ipad"===c:o="ipad";break;case"ios"===s:o="ios";break;case"android"===s:o="android";break;case"mac os"===s:o="macos";break;case"linux"===s:o="linux";break;case null==s?void 0:s.includes("windows"):o="windows"}let l=null===(n=a.browser.name)||void 0===n?void 0:n.toLowerCase();switch(!0){case"chrome"===l:i="chrome";break;case"firefox"===l:i="firefox";break;case null==l?void 0:l.includes("safari"):i="safari";break;case null==l?void 0:l.includes("opera"):i="opera"}return{os:o,browser:i}}function l(...e){return e.includes(c().os)}function d(...e){return e.includes(c().browser)}},10737:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkMetaData=function(e){if(!e)throw new o.OKXConnectError(o.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR,"You have to specify a `dappMetaData`in the options.");if(!e.name)throw new o.OKXConnectError(o.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR,"dappName is required");return!0};let o=n(1461)},11509:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SolProvider=void 0;let i=n(1461),a=n(62332),s=r(n(1560)),c=n(66352),l=n(97950);class d{constructor(){this.accountChangedSolanaPublicKeyHandler=null}send(e){return o(this,void 0,void 0,function*(){var t;try{let r;yield this.restoreConnect(),(0,a.logDebug)("SolProvider send request:",JSON.stringify(e));let c=e.method;if(e.injectParams)switch(c){case"solana_signMessage":if(e.injectParams&&"object"==typeof e.injectParams&&"message"in e.injectParams){var n=null===(t=e.injectParams)||void 0===t?void 0:t.message;let o=new TextEncoder().encode(n),i=yield window.okxwallet.solana.signMessage(o,"utf8");return r={method:e.method,result:s.default.encode(i.signature)},(0,a.logDebug)("SolProvider send result:",JSON.stringify(i)),r}throw new i.OKXConnectError(i.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`param is error method: '${c}'`);case"solana_signTransaction":{let t=yield window.okxwallet.solana.signTransaction(e.injectParams);return(0,a.logDebug)("SolProvider send bufferResult:",JSON.stringify(t)),r={method:e.method,injectResult:t},(0,a.logDebug)("SolProvider send result:",(0,a.safeJsonStringify)(r)),r}case"solana_signAllTransactions":{let t=yield window.okxwallet.solana.signAllTransactions(e.injectParams);return(0,a.logDebug)("SolProvider send result:",(0,a.safeJsonStringify)(t)),r={method:e.method,injectResult:t}}case"solana_signAndSendTransaction":var o=yield window.okxwallet.solana.signAndSendTransaction(e.injectParams);return(0,a.logDebug)("SolProvider send result:",(0,a.safeJsonStringify)(o)),r={method:e.method,injectResult:o};default:throw new i.OKXConnectError(i.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED,`method: '${c}'`)}else throw new i.OKXConnectError(i.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`param is error method: '${c}'`)}catch(e){throw(0,a.logDebug)("SolProvider send error:",e),e}})}connectReady(){return!0}disconnect(){}restoreConnect(){return(0,c.isDevice)("mobile")?this.connect():Promise.resolve()}parseConnectResponse(e,t,n,r,s,c){return o(this,void 0,void 0,function*(){let e=[];r.forEach(t=>{t.namespace===i.NameSpaceKeySOL&&e.push(...t.chains)});let t=[],n={},o={};if(e.forEach(e=>{let r=s.address.find(t=>"501"===t.chainId&&501===t.coinType||t.namespaceChainId===e);r&&(t.push(e+":"+r.address),o&&"publicKey"in o?n[e]=o:n[e]={publicKey:r.publicKey})}),t&&t.length>0){let e={namespace:i.NameSpaceKeySOL,addresses:t,methods:[...l.SOLANAMethods],extra:n};return(0,a.logDebug)("parseConnectResponse nameSpaceResponse :",JSON.stringify(e)),e}})}connect(){return o(this,void 0,void 0,function*(){return window.okxwallet.solana.connect()})}singleConnect(){return this.connect()}addListener(e){console.log("window.okxwallet configEventWithKey:","sol"),this.accountChangedSolanaPublicKeyHandler=t=>{console.log("window.okxwallet configEventWithKey_solana:",Date.now(),"sol",t),t&&e()},window.okxwallet.solana.on("accountChanged",this.accountChangedSolanaPublicKeyHandler)}removeListener(){this.accountChangedSolanaPublicKeyHandler&&window.okxwallet.solana.removeListener("accountChanged",this.accountChangedSolanaPublicKeyHandler)}}t.SolProvider=d},11589:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SessionCrypto=void 0;let r=o(n(87124)),i=n(11769);class a{constructor(e){this.nonceLength=24,this.sessionKeyPair=e?this.createKeypairFromString(e):this.createKeypair()}createKeypair(){return r.default.box.keyPair()}createKeypairFromString(e){return{publicKey:(0,i.hexToByteArray)(e.publicKey),secretKey:(0,i.hexToByteArray)(e.secretKey)}}createNonce(){return r.default.randomBytes(this.nonceLength)}get keyPair(){return this.sessionKeyPair}encrypt(e,t){let n=new TextEncoder().encode(e),o=this.createNonce(),a=r.default.box(n,o,(0,i.hexToByteArray)(t),this.keyPair.secretKey),s=(0,i.concatUint8Arrays)(o,a);var c=(0,i.toHexString)(s),l=new TextEncoder().encode(c);return(0,i.base64encode)(l,!1)}encryptWallet(e,t){let n=new TextEncoder().encode(e),o=this.createNonce(),a=r.default.box(n,o,(0,i.hexToByteArray)(t),this.keyPair.secretKey),s=(0,i.concatUint8Arrays)(o,a);return(0,i.base64encode)(s,!1)}decrypt(e,t){let n=(0,i.base64decode)(e,!0).toUint8Array(),[o,a]=(0,i.splitToUint8Arrays)(n,this.nonceLength),s=r.default.box.open(a,o,(0,i.hexToByteArray)(t),this.keyPair.secretKey);if(!s)throw Error(`Decryption error: 
 message: ${e.toString()} 
 sender pubkey: ${t.toString()} 
 keypair pubkey: ${(0,i.toHexString)(this.keyPair.publicKey)} 
 keypair secretkey: ${(0,i.toHexString)(this.keyPair.secretKey)}`);return new TextDecoder().decode(s)}decryptWallet(e,t){let n=(0,i.base64decode)(e,!0),o=(0,i.hexToByteArray)(n.toString()),[a,s]=(0,i.splitToUint8Arrays)(o,this.nonceLength),c=r.default.box.open(s,a,(0,i.hexToByteArray)(t),this.keyPair.secretKey);if(!c)throw Error(`Decryption error: 
 message: ${e.toString()} 
 sender pubkey: ${t.toString()} 
 keypair pubkey: ${(0,i.toHexString)(this.keyPair.publicKey)} 
 keypair secretkey: ${(0,i.toHexString)(this.keyPair.secretKey)}`);return new TextDecoder().decode(c)}stringifyKeypair(){return{publicKey:(0,i.toHexString)(this.keyPair.publicKey),secretKey:(0,i.toHexString)(this.keyPair.secretKey)}}}t.SessionCrypto=a},11769:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.chainName2IdMap=t.isValidObject=t.RANDOM_LENGTH=t.isBrowser=t.resolveLocalStorage=t.hasLocalStorage=t.hasBuiltInWebSocket=t.resolveWebSocketImplementation=void 0,t.hexToByteArray=function(e){if(e.length%2!=0)throw Error(`Cannot convert ${e} to bytesArray`);let t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)t[n/2]=parseInt(e.slice(n,n+2),16);return t},t.getChainId=function(e){return e.includes(":")?e.split(":")[1]:e},t.toHexString=function(e){let t="";return e.forEach(e=>{t+=("0"+(255&e).toString(16)).slice(-2)}),t},t.concatUint8Arrays=function(e,t){let n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n},t.splitToUint8Arrays=function(e,t){if(t>=e.length)throw Error("Index is out of buffer");return[e.slice(0,t),e.slice(t)]},t.base64encode=function(e,t){let n;return e instanceof Uint8Array?n=e:("string"!=typeof e&&(e=(0,c.safeJsonStringify)(e)),n=i.default.decodeUTF8(e)),function(e,t){let n=i.default.encodeBase64(e);return t?encodeURIComponent(n):n}(n,t)},t.base64decode=function(e,t){var n;let o=(n=e,t&&(n=decodeURIComponent(n)),i.default.decodeBase64(n));return{toString:()=>i.default.encodeUTF8(o),toObject(){try{return(0,c.safeJsonParse)(i.default.encodeUTF8(o))}catch(e){return null}},toUint8Array:()=>o}},t.checkWSUrl=function(e){let t=e.match(RegExp(/^\w+:/,"gi"));if(!t||!t.length)return!1;let n=t[0];return void 0!==n&&RegExp("^wss?:").test(n)},t.hashKey=g,t.generateRandomBytes32=p,t.generateTopic=function(){let e=p();return(0,l.logDebug)(`generate topic called ${e}`),g((0,a.toString)(e,f))},t.generateGroupId=function(){let e=r.default.randomBytes(16);return(0,l.logDebug)(`generate groupid called ${e}`),g((0,a.toString)(e,f))},t.isInIOSLine=function(){return navigator.userAgent.includes("Safari Line/")&&v()},t.isInIOSLark=function(){return navigator.userAgent.includes("Lark/")&&v()},t.isInIOSChrome=function(){return navigator.userAgent.includes("CriOS/")&&v()},t.isInIOSWeChat=function(){return navigator.userAgent.includes("MicroMessenger/")&&v()},t.isIos=v,t.getLastSixMd5Hash=function(e){return u.default.MD5(e).toString().slice(-6)},t.toSafeBase64FromBase64=function(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},t.useShortLink=function(){return!0},t.replaceChainNameToChainId=function(e){return t.chainName2IdMap.forEach((t,n)=>{e.includes(n)&&(e=e.replace(n,t))}),e},t.replaceChainIdToChainName=function(e){return t.chainName2IdMap.forEach((t,n)=>{e.includes(t)&&(e=e.replace(t,n))}),e},t.getNamespaceKeyByChain=function(e){for(let[t,n]of Object.entries(h.NAMES_CHAINS))if(Object.values(n).includes(e))return t;return e};let r=o(n(87124)),i=o(n(46579)),a=n(60687),s=n(25414),c=n(82091),l=n(33394),d=n(74302),u=o(n(15563)),h=n(1461),f="base16";function g(e,t=f){(0,l.logDebug)(`hash key called ${e}`);let n=(0,s.hash)((0,d.okxfromString)(e,t));return(0,a.toString)(n,t)}function p(){return r.default.randomBytes(t.RANDOM_LENGTH)}function v(){let e=navigator.userAgent,t=navigator.maxTouchPoints||0,n=/iPad|iPhone|iPod/.test(e)&&!window.MSStream,o=e.includes("Mac")&&t>1;return(0,l.logDebug)(`utils isIos >>>isIOSDevice: ${n}    >> isIPadOS: ${o}`),n||o}t.resolveWebSocketImplementation=()=>{if("undefined"!=typeof WebSocket);else if(void 0!==n.g&&void 0!==n.g.WebSocket)return n.g.WebSocket;else if("undefined"!=typeof window&&void 0!==window.WebSocket)return window.WebSocket;else if("undefined"!=typeof self&&void 0!==self.WebSocket)return self.WebSocket;return WebSocket},t.hasBuiltInWebSocket=()=>"undefined"!=typeof WebSocket||void 0!==n.g&&void 0!==n.g.WebSocket||"undefined"!=typeof window&&void 0!==window.WebSocket||"undefined"!=typeof self&&void 0!==self.WebSocket,t.hasLocalStorage=()=>void 0!==n.g&&void 0!==n.g.localStorage||"undefined"!=typeof window&&void 0!==window.localStorage,t.resolveLocalStorage=()=>void 0!==n.g&&void 0!==n.g.localStorage?n.g.localStorage:"undefined"!=typeof window&&void 0!==window.localStorage?window.localStorage:localStorage,t.isBrowser=()=>"undefined"!=typeof window,t.RANDOM_LENGTH=32,t.isValidObject=e=>Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length,t.chainName2IdMap=new Map,t.chainName2IdMap.set("aptos:mainnet","aptos:637"),t.chainName2IdMap.set("movement:testnet","aptos:70000060"),t.chainName2IdMap.set("movement:mainnet","aptos:70000066"),t.chainName2IdMap.set("soon:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","svm:70000069"),t.chainName2IdMap.set("soon:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","svm:70000067"),t.chainName2IdMap.set("eclipse:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","svm:70000068"),t.chainName2IdMap.set("sonic:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","svm:70000073")},11801:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.BtcProvider=void 0;let r=n(1461),i=n(62332),a=n(97950),s=n(66352);class c{constructor(){this.accountChangedBtcHandler=null}connect(){return window.okxwallet.unisat.connect()}switchChain(e){return o(this,void 0,void 0,function*(){let t=window.okxwallet.unisat;switch(e){case r.BTC_CHAINS.MAINNET:yield t.switchChain("BITCOIN_MAINNET");break;case r.BTC_CHAINS.FRACTAL:yield t.switchChain("FRACTAL_BITCOIN_MAINNET")}})}connectReady(){return!0}parseConnectResponse(e,t,n,i,s){return o(this,void 0,void 0,function*(){try{let e=[];i.forEach(t=>{t.namespace===r.NameSpaceKeyBtc&&e.push(...t.chains)});let t=[],n={};if(0==e.length)return;let c=(e,t)=>e.find(e=>{let n="bitcoin"===e.name&&t===r.BTC_CHAINS.MAINNET||"fractalbitcoin"===e.name&&t===r.BTC_CHAINS.FRACTAL;return 0===e.coinType&&n||e.namespaceChainId===t}),l=e.map(e=>o(this,void 0,void 0,function*(){let o=c(s.address,e);if(!o)return;t.push(e+":"+o.address);let r=yield this.connect();n[e]={publicKey:r.publicKey,compressedPublicKey:r.compressedPublicKey}}));if(yield Promise.all(l),t&&t.length>0)return{namespace:r.NameSpaceKeyBtc,addresses:t,methods:[...a.BtcMethods],extra:n};return}catch(e){throw e}})}restoreConnect(){return o(this,void 0,void 0,function*(){return(0,s.isDevice)("mobile")?this.connect():Promise.resolve()})}send(e){return o(this,void 0,void 0,function*(){try{(0,i.logDebug)("btcProvider send request:",JSON.stringify(e));let t=e.method,n=e.chainId;if(yield this.restoreConnect(),yield this.switchChain(n),e.params)switch(t){case"btc_signMessage":{let{signStr:t,type:n}=e.params||{},o=yield window.okxwallet.unisat.signMessage(t,n);return{method:e.method,result:o}}case"btc_send":{let{from:t,to:n,value:o,satBytes:r}=e.params||{},i=yield window.okxwallet.unisat.send({from:t,to:n,value:o,satBytes:r});return{method:e.method,result:i}}case"btc_signPsbts":{let t;let{psbtHexs:n,options:o}=e.params||{};if(Array.isArray(n)&&1===n.length){let e;t=[Array.isArray(o)?yield window.okxwallet.unisat.signPsbt(n[0],o.length>0&&"object"==typeof o[0]?o[0]:void 0):yield window.okxwallet.unisat.signPsbt(n[0])]}else t=yield window.okxwallet.unisat.signPsbts(n,o);return{method:e.method,result:(0,i.safeJsonStringify)(t)}}case"btc_signAndPushPsbt":{let{psbtHex:t,options:n}=e.params||{},o=yield window.okxwallet.unisat.signPsbt(t,n),r=yield window.okxwallet.unisat.pushPsbt(o);return{method:e.method,result:(0,i.safeJsonStringify)({signedPsbt:o,txHash:r})}}case"btc_sendInscription":{let{address:t,inscriptionId:n,options:o}=e.injectParams||{},r=yield window.okxwallet.unisat.sendInscription(t,n,o);return{method:e.method,result:r}}case"btc_inscribeTransfer":if(this.hasFunction("inscribeTransfer")){let{ticker:t,amount:n}=e.params||{},o=yield window.okxwallet.unisat.inscribeTransfer(t,n);return{method:e.method,result:o}}case"btc_sendRunes":if(this.hasFunction("sendRunes")){let{address:t,runeid:n,amount:o,options:r}=e.injectParams||{},i=yield window.okxwallet.unisat.sendRunes(t,n,o,r);return{method:e.method,result:i}}default:throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED,`method: '${t}' not support`)}else throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR,`param is error method: '${t}'`)}catch(e){throw(0,i.logDebug)("BtcProvider send error:",e),e}})}hasFunction(e){return!!window.okxwallet&&!!window.okxwallet.unisat&&"function"==typeof window.okxwallet.unisat[e]}singleConnect(e){return o(this,void 0,void 0,function*(){return 1==e.chains.length&&this.connect()})}addListener(e){this.accountChangedBtcHandler=t=>{console.log("window.okxwallet btc:",Date.now(),"btc",t),t&&t.length>0&&e()},window.okxwallet.unisat.on("accountsChanged",this.accountChangedBtcHandler)}removeListener(){window.okxwallet.unisat.removeListener("accountsChanged",this.accountChangedBtcHandler)}}t.BtcProvider=c},12302:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppwalletConnector=void 0;let o=n(66122),r=n(14103),i=n(62332),a=n(2856),s=n(1461);class c extends o.WsConnector{constructor(){super(),this.walletName="OKX App",this.walletNameKey="walletModal.mobileConnectionModal.connectApp"}getTag(){return r.OKX_APP_WALLET}openWallet(e,t){var n;let o=null!=t?t:s.OpenAppLinkType.UniversalLink;if(e&&e.connectRequest){(0,i.logDebug)(`appwallet-connector openwallet before useSHortLink engineConnectInfo.connectRequest JSON ${JSON.stringify(e)}`);let t=e.connectRequest;(0,i.useShortLink)()||(t=Object.assign(Object.assign({},e.connectRequest),{redirect:null!==(n=e.redirect)&&void 0!==n?n:"none"}));let{universalLink:r,deepLink:a}=(0,i.getOKXLink)(t);(0,i.openOKXDeeplinkWithFallback)(a,r,o)}else(0,i.isOS)("android")?(0,i.openDeeplinkWithFallback)(a.stackDeepLink,()=>{}):(0,i.openOKXDeeplinkWithFallback)(a.standardDeeplink,a.shortUniversalLink,o)}}t.AppwalletConnector=c},13958:function(e,t,n){"use strict";var o,r=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(o=function(e){return(o=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t})(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=o(e),a=0;a<n.length;a++)"default"!==n[a]&&r(t,e,n[a]);return i(t,e),t}),s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MULTICODEC_ED25519_LENGTH=t.MULTICODEC_ED25519_HEADER=t.MULTICODEC_ED25519_BASE=t.MULTICODEC_ED25519_ENCODING=t.DID_METHOD=t.DID_PREFIX=t.DID_DELIMITER=t.KEY_PAIR_SEED_LENGTH=t.DATA_ENCODING=t.JSON_ENCODING=t.JWT_ENCODING=t.JWT_DELIMITER=t.JWT_IRIDIUM_TYP=t.JWT_IRIDIUM_ALG=t.JWTHeaderType=void 0,t.generateKeyPair=function(){return h.default.sign.keyPair()},t.decodeJSON=p,t.encodeJSON=v,t.encodeIss=b,t.decodeIss=_,t.encodeSig=y,t.decodeSig=m,t.encodeData=O,t.decodeData=function(e){var n,o;let r=(0,g.okxtoString)(e,t.DATA_ENCODING).split(t.JWT_DELIMITER);return{header:p(null!==(n=r[0])&&void 0!==n?n:"{}"),payload:p(null!==(o=r[1])&&void 0!==o?o:"{}")}},t.encodeJWT=C,t.decodeJWT=E,t.signJWT=function(e,n,o,r){return s(this,arguments,void 0,function*(e,n,o,r,i=Math.floor(Date.now())){let a={alg:t.JWT_IRIDIUM_ALG,typ:t.JWT_IRIDIUM_TYP},s={iss:b(r.publicKey),sub:e,aud:n,act:"authenticate user",iat:i,exp:i+o},c=O({header:a,payload:s});return f.logDebug(`get sec kp: ${r.secretKey} {${r.secretKey.length}}`),C({header:a,payload:s,signature:h.default.sign.detached(c,r.secretKey)})})},t.verifyJWT=function(e){return s(this,void 0,void 0,function*(){let{header:n,payload:o,data:r,signature:i}=E(e);if(n.alg!==t.JWT_IRIDIUM_ALG||n.typ!==t.JWT_IRIDIUM_TYP)throw Error("JWT must use EdDSA algorithm");let a=_(o.iss);return l.verify(a,r,i)})};let l=a(n(65716)),d=n(82091),u=n(11769),h=c(n(87124)),f=a(n(33394)),g=n(74302);function p(e){return(0,d.safeJsonParse)((0,g.okxtoString)((0,g.okxfromString)(e,t.JWT_ENCODING),t.JSON_ENCODING))}function v(e){return(0,g.okxtoString)((0,g.okxfromString)((0,d.safeJsonStringify)(e),t.JSON_ENCODING),t.JWT_ENCODING)}function b(e){f.logDebug(`publicKey: ${(0,u.toHexString)(e)}`);var n=(0,g.okxtoString)(e,t.MULTICODEC_ED25519_ENCODING);return[t.DID_PREFIX,t.DID_METHOD,n].join(t.DID_DELIMITER)}function _(e){let[n,o,r]=e.split(t.DID_DELIMITER);if(n!==t.DID_PREFIX||o!==t.DID_METHOD)throw Error('Issuer must be a DID with method "key"');if(void 0===r)throw Error("multicodec is undefined");let i=(0,g.okxfromString)(r,t.MULTICODEC_ED25519_ENCODING);if(void 0===i||i.length!==t.MULTICODEC_ED25519_LENGTH)throw Error("Issuer must be a public key with length 32 bytes");return i}function y(e){return(0,g.okxtoString)(e,t.JWT_ENCODING)}function m(e){return(0,g.okxfromString)(e,t.JWT_ENCODING)}function O(e){return(0,g.okxfromString)([v(e.header),v(e.payload)].join(t.JWT_DELIMITER),t.DATA_ENCODING)}function C(e){return[v(e.header),v(e.payload),y(e.signature)].join(t.JWT_DELIMITER)}function E(e){var n,o,r;let i=e.split(t.JWT_DELIMITER),a=p(null!==(n=i[0])&&void 0!==n?n:"{}"),s=p(null!==(o=i[1])&&void 0!==o?o:"{}");return{header:a,payload:s,signature:m(null!==(r=i[2])&&void 0!==r?r:"{}"),data:(0,g.okxfromString)(i.slice(0,2).join(t.JWT_DELIMITER),t.DATA_ENCODING)}}t.JWTHeaderType="dapp",t.JWT_IRIDIUM_ALG="EdDSA",t.JWT_IRIDIUM_TYP="JWT",t.JWT_DELIMITER=".",t.JWT_ENCODING="base64url",t.JSON_ENCODING="utf8",t.DATA_ENCODING="utf8",t.KEY_PAIR_SEED_LENGTH=32,t.DID_DELIMITER=":",t.DID_PREFIX="did",t.DID_METHOD="key",t.MULTICODEC_ED25519_ENCODING="base58btc",t.MULTICODEC_ED25519_BASE="z",t.MULTICODEC_ED25519_HEADER="K36",t.MULTICODEC_ED25519_LENGTH=32},14103:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OKX_TG_WALLET=t.OKX_APP_WALLET=t.OKX_INJECT_WALLET=void 0,t.getTagByappName=function(e){var n="";if(e)switch(e){case o.OKXWalletName:n=t.OKX_APP_WALLET;break;case r.OKXMiniWalletName:n=t.OKX_TG_WALLET;break;case r.OKXInjectWalletName:n=t.OKX_INJECT_WALLET}return n};let o=n(1461),r=n(78944);t.OKX_INJECT_WALLET="okx_inject_wallet",t.OKX_APP_WALLET="okx_app_wallet",t.OKX_TG_WALLET="okx_tg_wallet"},14904:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildNameSpacesByConnectResponse=function(e){return r(e)},t.buildRequestAccountNameSpacesByConnectResponse=r,t.buildAccountNameSpaces=i;let o=n(33394);function r(e){let t={};(0,o.logDebug)("buildRequestAccountNameSpacesByConnectResponse start connectResponse111>>",JSON.stringify(e));let n=e.payload.responses.find(e=>"requestAccounts"===e.name);if(n&&n.accounts){let e=[];for(let t of n.accounts)"ton"===t.namespace?t.data&&t.data.ton_addr&&t.data.ton_addr.address&&t.data.ton_addr.address.length>0&&((0,o.logDebug)("buildRequestAccountNameSpacesByConnectResponse start TON>>",JSON.stringify(t)),e.push(t)):((0,o.logDebug)("buildRequestAccountNameSpacesByConnectResponse start other>>",JSON.stringify(t)),e.push(t));n.accounts=e}let r=e.payload.responses.find(e=>"ton_addr"===e.name),a=e.payload.responses.find(e=>"ton_proof"===e.name);if(r&&!n){(0,o.logDebug)("buildRequestAccountNameSpacesByConnectResponse adapt ton data >>");let e=r.address;e="ton:"+r.network+":"+e;let t={ton_addr:r};a&&(t.ton_proof=a),n={name:"requestAccounts",accounts:[{namespace:"ton",addresses:[e],methods:["ton_sendTransaction"],extra:{},data:t}]}}return(0,o.logDebug)("buildRequestAccountNameSpacesByConnectResponse end universalResponse>>>",JSON.stringify(n)),i(n.accounts,t),t}function i(e,t){e.forEach(e=>{var n=[],r=[];e.addresses.forEach(e=>{var t=e.split(":");if((0,o.logDebug)("buildRequestAccountNameSpacesByConnectResponse addressArr>>",t.length),t.length>=3){let i=t.slice(0,2).join(":");n.push(i),r.push(e),(0,o.logDebug)("buildRequestAccountNameSpacesByConnectResponse chain:>>",i,"addressItem:",e)}}),e.data&&e.data.ton_addr&&(e.data.ton_addr.name="ton_addr"),e.data&&e.data.ton_proof&&(e.data.ton_proof.name="ton_proof"),t[e.namespace]={chains:n,accounts:r,methods:e.methods,extra:e.extra,payload:e.data},(0,o.logDebug)("buildRequestAccountNameSpacesByConnectResponse result>>",JSON.stringify(t))})}},15985:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.SuiProvider=void 0;let r=n(1461),i=n(62332),a=n(66352),s=n(97950);class c{constructor(){this.accountChangedHandler=null}connectReady(){return!0}getSuiPublicKey(){return o(this,void 0,void 0,function*(){return(yield this.connect()).accounts[0].publicKey})}parseConnectResponse(e,t,n,a,c,l){return o(this,void 0,void 0,function*(){try{let e=[];a.forEach(t=>{t.namespace===r.NameSpaceKeySui&&e.push(...t.chains)});let t=[],n={};if(0==e.length)return;let o=yield this.getSuiPublicKey();if(e.forEach(e=>{var r;(0,i.getChainId)(e);let a=c.address.find(t=>784===t.coinType||t.namespaceChainId===e);a&&(t.push(e+":"+a.address),n[e]={publicKey:null!==(r=a.publicKey)&&void 0!==r?r:o})}),t&&t.length>0)return{namespace:r.NameSpaceKeySui,addresses:t,methods:[...s.SuiMethods],extra:n};return}catch(e){throw e}})}restoreConnect(){return(0,a.isDevice)("mobile")?this.connect():Promise.resolve()}getSuiWallet(){return window.okxwallet.sui}send(e){return o(this,void 0,void 0,function*(){try{let t;yield this.restoreConnect(),(0,i.logDebug)("suiProvider send request:",JSON.stringify(e));let n=e.method;if(e.injectParams&&this.getSuiWallet()){let o=e.injectParams;switch(n){case"sui_signTransactionBlock":let r=yield this.getSuiWallet().features["sui:signTransactionBlock"].signTransactionBlock(o);t={method:"sui_signTransactionBlock",result:r.signature};break;case"sui_signAndExecuteTransactionBlock":let i=yield this.getSuiWallet().features["sui:signAndExecuteTransactionBlock"].signAndExecuteTransactionBlock(o);t={method:"sui_signAndExecuteTransactionBlock",result:i.digest};break;case"sui_signMessage":let a=yield this.getSuiWallet().features["sui:signMessage"].signMessage(o);t={method:"sui_signMessage",result:a.signature};break;case"sui_signPersonalMessage":let s=yield this.getSuiWallet().features["sui:signPersonalMessage"].signPersonalMessage(o);t={method:"sui_signPersonalMessage",result:s.signature}}}return t}catch(e){throw(0,i.logDebug)("suiProvider send error:",e),e}})}connect(){return o(this,void 0,void 0,function*(){var e;return null===(e=this.getSuiWallet())||void 0===e?void 0:e.features["standard:connect"].connect()})}singleConnect(){return this.connect()}addListener(e){console.log("window.okxwallet configEventWithKey:","sui"),this.accountChangedHandler=t=>{console.log("window.okxwallet configEventWithKey_sui:",Date.now(),"sui",t),t&&e()},window.okxwallet.sui.on("accountChanged",this.accountChangedHandler)}removeListener(){this.accountChangedHandler&&window.okxwallet.sui.removeListener("accountChanged",this.accountChangedHandler)}}t.SuiProvider=c},17322:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.OKXReporter=t.OKXReportSide=t.OKXReportType=t.versionStr=void 0;let i=r(n(52315)),a=n(33394),s=n(29477),c=n(62332),l=r(n(331)),d=r(n(87124));t.versionStr="1.8.0";let u=["https://www.okx.com/dappstat/wallet-connect","https://www.okx.ac/dappstat/wallet-connect"],h="OKX_RP_UUID_CK",f={headers:{Accept:"*/*","Content-Type":"text/plain"},method:"POST"};t.OKXReportType={PAGE_IN:"page_in",PAGE_OUT:"page_out",CLICK:"click",LOG:"log"},t.OKXReportSide={DAPP:"dapp",WALLET:"wallet"};let g=(e,...t)=>o(void 0,[e,...t],void 0,function*(e,t={},n=5e3){for(let o of e)try{let e=new AbortController,r=e.signal,a=(0,i.default)(o,Object.assign(Object.assign({},t),{signal:r})),s=new Promise((t,o)=>setTimeout(()=>{e.abort(),o(Error("Request timed out"))},n)),c=yield Promise.race([a,s]);if(c.ok)return c;if(502==c.status)return console.error("Fetch error status 502",o),c}catch(e){console.error(`Fetch error for ${o}:`,e)}throw console.error("'All fetch attempts failed.'"),Error("All fetch attempts failed.")});class p{constructor(){this.currentSide=t.OKXReportSide.DAPP,this.currentVersion=t.versionStr,this.storage=l.default.createInstance({name:"OKXReporter"}),this.recordList=[],this.currentUUID=(0,c.toHexString)(d.default.randomBytes(16))}configVersionAndSide(e,t,n){this.currentVersion=e+a.logVersion,this.currentSide=t,this.appName=n}get recordCacheKey(){return"OKX_RP_CK@"+this.appName}get reportPlatform(){return(0,c.isMobileUserAgent)()?(0,c.isIos)()?"iOS":"android":"pc"}beginReport(){return o(this,void 0,void 0,function*(){this.startErrorCatching();let e=yield this.storage.getItem(this.recordCacheKey),t=yield this.storage.getItem(h);t?this.currentUUID=t:this.storage.setItem(h,this.currentUUID),e&&(this.recordList=e,(0,a.logDebug)("resume records from cache length: ",this.recordList.length),yield this.sendCachedRecords())})}startErrorCatching(){(0,s.getWindow)()&&(0,a.logDebug)("begin capture console error")}cachedErrors(){return this.recordList}sendRecord(e){return o(this,void 0,void 0,function*(){return new Promise((t,n)=>o(this,void 0,void 0,function*(){try{let o=JSON.stringify(e);(0,a.logDebug)("[REPORT] record: ",o);let r=yield g(u,Object.assign(Object.assign({},f),{body:o}));(0,a.logDebug)("[REPORT] get rsp:",r),r&&r.status&&200==r.status?(this.recordList=this.recordList.filter(t=>t.timestamp!=e.timestamp||t.content!=e.content),yield this.storage.setItem(this.recordCacheKey,this.recordList),t(!0)):n(!1)}catch(e){(0,a.logDebug)("send record error:",e),t(!0)}}))})}sendRecordContent(e,t,n){return o(this,arguments,void 0,function*(e,t,n,o,r,i,a,c,l){var d,u,h,f;let g=null===(d=(0,s.getWindow)())||void 0===d?void 0:d.location.pathname,p=null===(u=(0,s.getWindow)())||void 0===u?void 0:u.location.origin;g&&p&&(p+=g);let v=null===(h=(0,s.getWindow)())||void 0===h?void 0:h.navigator.language,b=null===(f=(0,s.getWindow)())||void 0===f?void 0:f.navigator.userAgent,_=this.reportPlatform,y={uuid:this.currentUUID,version:this.currentVersion,content:e,action:n,side:this.currentSide,timestamp:new Date().getTime(),url:p,lang:v,type:t,platform:_,"user-agent":b,reverved1:o,reverved2:r,reverved3:i,reverved4:a,reverved5:c,reverved6:l};yield this.markRecordItem(y),yield this.sendRecord(y)})}sendCachedRecords(){return o(this,void 0,void 0,function*(){return new Promise((e,t)=>o(this,void 0,void 0,function*(){let n=this.recordList.map(e=>this.sendRecord(e));(0,a.logDebug)("[REPORT] submit & clean recorded caches begin @",new Date().toUTCString()),Promise.allSettled(n).then(n=>{(0,a.logDebug)("[REPORT] submit & clean recorded caches ends @",new Date().toUTCString());let o=[];n.forEach((e,t)=>{"rejected"==e.status&&o.push(t)}),this.recordList=this.recordList.filter((e,t)=>!o.includes(t)),this.storage.setItem(this.recordCacheKey,this.recordList).then(function(t){e()}).catch(function(e){t(e)})})}))})}markRecordItem(e){return o(this,void 0,void 0,function*(){if(this.recordList.push(e),this.recordList.length>100){let e=this.recordList.length-100;this.recordList.splice(0,e)}return new Promise((t,n)=>{this.storage.setItem(this.recordCacheKey,this.recordList).then(function(n){t(e)}).catch(function(e){n(e)})})})}}t.OKXReporter=p},19019:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SystemRandomSource=void 0;let o=n(36294),r=n(61125);class i{constructor(){if(this.isAvailable=!1,this.name="",this._source=new o.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new r.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw Error("System random byte generator is not available.");return this._source.randomBytes(e)}}t.SystemRandomSource=i},19903:(e,t,n)=>{"use strict";var o,r,i,a,s,c,l;Object.defineProperty(t,"__esModule",{value:!0}),t.isTmaPlatform=function(...e){return e.includes(p)},t.isInTMA=b,t.inTg=function(){return _()||b()},t.isInTelegramBrowser=_,t.sendExpand=function(){m("web_app_expand",{})},t.sendOpenTelegramLink=function(e,t){var n;let o=new URL(e);if("http:"!==o.protocol&&"https:"!==o.protocol){if(t)return t();throw new h.OKXConnectError(h.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Url protocol is not supported: ${o}`)}if("t.me"!==o.hostname){if(t)return t();throw new h.OKXConnectError(h.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Url host is not supported: ${o}`)}let r=o.pathname+o.search;y()||(n="6.1",C(v,"6.1")>=0)?m("web_app_open_tg_link",{path_full:r}):(0,f.openLinkBlank)("https://t.me"+r)},t.versionCompare=C;let d=n(29477),u=n(33394),h=n(1461),f=n(9423),g={};try{let e=location.hash.toString();g=function(e){e=e.replace(/^#/,"");let t={};if(!e.length)return t;if(0>e.indexOf("=")&&0>e.indexOf("?"))return t._path=O(e),t;let n=e.indexOf("?");n>=0&&(t._path=O(e.substr(0,n)),e=e.substr(n+1));let o=function(e){let t,n,o,r,i={};if(!e.length)return i;let a=e.split("&");for(t=0;t<a.length;t++)o=O((n=a[t].split("="))[0]),r=null==n[1]?null:O(n[1]),i[o]=r;return i}(e);for(let e in o)t[e]=o[e];return t}(e)}catch(e){}let p="unknown";if((null==g?void 0:g.tgWebAppPlatform)&&(p=null!==(o=g.tgWebAppPlatform)&&void 0!==o?o:"unknown"),"unknown"===p){let e=(0,d.getWindow)();p=null!==(a=null===(i=null===(r=null==e?void 0:e.Telegram)||void 0===r?void 0:r.WebApp)||void 0===i?void 0:i.platform)&&void 0!==a?a:"unknown"}let v="6.0";if((null==g?void 0:g.tgWebAppVersion)&&(v=g.tgWebAppVersion),!v){let e=(0,d.getWindow)();v=null!==(l=null===(c=null===(s=null==e?void 0:e.Telegram)||void 0===s?void 0:s.WebApp)||void 0===c?void 0:c.version)&&void 0!==l?l:"6.0"}function b(){var e;return"unknown"!==p||!!(null===(e=(0,d.getWindow)())||void 0===e?void 0:e.TelegramWebviewProxy)}function _(){var e;let t=!!(null===(e=(0,d.getWindow)())||void 0===e?void 0:e.TelegramWebview);return(b()||t)&&"unknown"===p}function y(){try{let e=(0,d.getWindow)();if(!e)return!1;return null!=e.parent&&e!==e.parent}catch(e){return!1}}function m(e,t){try{let n=(0,d.getWindow)();if(!n)throw new h.OKXConnectError(h.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Can't post event to parent window: window is not defined");if(void 0!==n.TelegramWebviewProxy)(0,u.logDebug)("postEvent",e,t),n.TelegramWebviewProxy.postEvent(e,JSON.stringify(t));else if(n.external&&"notify"in n.external)(0,u.logDebug)("postEvent",e,t),n.external.notify(JSON.stringify({eventType:e,eventData:t}));else if(y()){let o=JSON.stringify({eventType:e,eventData:t});(0,u.logDebug)("postEvent",e,t),n.parent.postMessage(o,"*")}else throw new h.OKXConnectError(h.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"Can't post event to TMA")}catch(e){(0,u.logError)(`Can't post event to parent window: ${e}`)}}function O(e){try{return e=e.replace(/\+/g,"%20"),decodeURIComponent(e)}catch(t){return e}}function C(e,t){let n,o,r,i;"string"!=typeof e&&(e=""),"string"!=typeof t&&(t="");let a=e.replace(/^\s+|\s+$/g,"").split("."),s=t.replace(/^\s+|\s+$/g,"").split(".");for(o=0,n=Math.max(a.length,s.length);o<n;o++)if((r=parseInt(a[o])||0)!==(i=parseInt(s[o])||0)){if(r>i)return 1;return -1}return 0}},24139:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CONNECT_METHOD_RECV_DISCONNECT=t.CONNECT_METHOD_DISCONNECT=t.CONNECT_METHOD_BATCH_FETCHMSG=t.CONNECT_METHOD_FETCHMSG=t.CONNECT_METHOD_RECEIVE=t.CONNECT_METHOD_UNSUB=t.CONNECT_METHOD_SUB=t.CONNECT_METHOD_PUBLISH=t.CONNECT_METHOD_LOGIN=t.CONNECT_METHOD_PUSH=void 0,t.CONNECT_METHOD_PUSH="push",t.CONNECT_METHOD_LOGIN="login",t.CONNECT_METHOD_PUBLISH="publish",t.CONNECT_METHOD_SUB="subscribe",t.CONNECT_METHOD_UNSUB="unsubscribe",t.CONNECT_METHOD_RECEIVE="receive",t.CONNECT_METHOD_FETCHMSG="fetchMessages",t.CONNECT_METHOD_BATCH_FETCHMSG="batchFetchMessages",t.CONNECT_METHOD_DISCONNECT="disconnect",t.CONNECT_METHOD_RECV_DISCONNECT="receiveDisconnect"},25414:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(86271),r=n(94306);t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var i=function(){function e(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return e.prototype._initState=function(){this._state[0]=0x6a09e667,this._state[1]=0xbb67ae85,this._state[2]=0x3c6ef372,this._state[3]=0xa54ff53a,this._state[4]=0x510e527f,this._state[5]=0x9b05688c,this._state[6]=0x1f83d9ab,this._state[7]=0x5be0cd19},e.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},e.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},e.prototype.update=function(e,t){if(void 0===t&&(t=e.length),this._finished)throw Error("SHA256: can't update because hash was finished.");var n=0;if(this._bytesHashed+=t,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&t>0;)this._buffer[this._bufferLength++]=e[n++],t--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(t>=this.blockSize&&(n=s(this._temp,this._state,e,n,t),t%=this.blockSize);t>0;)this._buffer[this._bufferLength++]=e[n++],t--;return this},e.prototype.finish=function(e){if(!this._finished){var t=this._bytesHashed,n=this._bufferLength,r=t%64<56?64:128;this._buffer[n]=128;for(var i=n+1;i<r-8;i++)this._buffer[i]=0;o.writeUint32BE(t/0x20000000|0,this._buffer,r-8),o.writeUint32BE(t<<3,this._buffer,r-4),s(this._temp,this._state,this._buffer,0,r),this._finished=!0}for(var i=0;i<this.digestLength/4;i++)o.writeUint32BE(this._state[i],e,4*i);return this},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e.prototype.saveState=function(){if(this._finished)throw Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},e.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},e.prototype.cleanSavedState=function(e){r.wipe(e.state),e.buffer&&r.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},e}();t.SHA256=i;var a=new Int32Array([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]);function s(e,t,n,r,i){for(;i>=64;){for(var s=t[0],c=t[1],l=t[2],d=t[3],u=t[4],h=t[5],f=t[6],g=t[7],p=0;p<16;p++){var v=r+4*p;e[p]=o.readUint32BE(n,v)}for(var p=16;p<64;p++){var b=e[p-2],_=(b>>>17|b<<15)^(b>>>19|b<<13)^b>>>10,y=((b=e[p-15])>>>7|b<<25)^(b>>>18|b<<14)^b>>>3;e[p]=(_+e[p-7]|0)+(y+e[p-16]|0)}for(var p=0;p<64;p++){var _=(((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+(u&h^~u&f)|0)+(g+(a[p]+e[p]|0)|0)|0,y=((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+(s&c^s&l^c&l)|0;g=f,f=h,h=u,u=d+_|0,d=l,l=c,c=s,s=_+y|0}t[0]+=s,t[1]+=c,t[2]+=l,t[3]+=d,t[4]+=u,t[5]+=h,t[6]+=f,t[7]+=g,r+=64,i-=64}return r}t.hash=function(e){var t=new i;t.update(e);var n=t.digest();return t.clean(),n}},26751:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OKXCONNECTOR_JWT_TTL=t.OKXCONNECTOR_JWT_WALLET_SIDE=t.OKXCONNECTOR_JWT_SIDE=void 0,t.OKXCONNECTOR_JWT_SIDE="wallet",t.OKXCONNECTOR_JWT_WALLET_SIDE="dapp",t.OKXCONNECTOR_JWT_TTL=864e5},29477:(e,t,n)=>{"use strict";var o,r,i,a;Object.defineProperty(t,"__esModule",{value:!0}),t.removeUrlLastSlash=f,t.addPathToUrl=function(e,t){return f(e)+"/"+t},t.getUniversalLink=g,t.openOKXDeeplink=function(e,t,n){p(e,t,n,!1)},t.openOKXDeeplinkWithFallback=p,t.getWindow=v,t.isTelegramUrl=function(e){if(!e)return!1;let t=new URL(e);return"tg:"===t.protocol||"t.me"===t.hostname},t.encodeTelegramUrlParameters=function(e){let t=e;return(t=(t=(t=(t=(t=t.replace(/\./g,"%2E")).replace(/-/g,"%2D")).replace(/_/g,"%5F")).replace(/&/g,"-")).replace(/=/g,"__")).replace(/%/g,"--")},t.encodeConnectParams=b,t.encodeTWAConnectURLParams=_,t.getAppWalletDeepLink=function(e){return`${s.standardDeeplink}?param=${e}`},t.getAppWalletShortDeepLink=y,t.getTelegramWalletTWAUrl=m,t.openOKXTMAWalletlinkWithFallback=function(e){var t,n,o,r,i;(0,c.logDebug)("[TWA] open link:",e,"isInTMA ==> ",w()),w()?(null===(n=null===(t=v())||void 0===t?void 0:t.Telegram)||void 0===n?void 0:n.WebApp)?null===(i=null===(r=null===(o=v())||void 0===o?void 0:o.Telegram)||void 0===r?void 0:r.WebApp)||void 0===i||i.openTelegramLink(e):(0,u.sendOpenTelegramLink)(e):(0,l.getTestTwaUrl)()?window.open(e,"_blank"):window.open(e,"_self")},t.isInTMA=w,t.isInTelegramBrowser=function(){var e;let t=!!(null===(e=v())||void 0===e?void 0:e.TelegramWebview);return(w()||t)&&"unknown"===E},t.getOKXLink=function(e,t=!1,n){if((0,c.logDebug)(`url  getOKXLink() called connectRequest==> ${JSON.stringify(e)}  useMini=> ${t}  tmaReturnUrl==> ${n}`),t)return e?{universalLink:m(_(e),null!=n?n:"back")}:{universalLink:m(void 0,null!=n?n:"back")};{let t=e?`${s.standardDeeplink}?param=${b(e)}`:s.standardDeeplink;return(0,d.useShortLink)()?{universalLink:e?y(e.topic,e.clientId):l.shortUniversalLink,deepLink:t}:{universalLink:g(t),deepLink:t}}};let s=n(1461),c=n(33394),l=n(2856),d=n(11769),u=n(19903),h=n(74538);function f(e){return"/"===e.slice(-1)?e.slice(0,-1):e}function g(e,t=!1){console.log("getUniversalLink deeplinkUrl:",e,", useStandardUniversalLink:",t);let n=encodeURIComponent(e);return console.log("getUniversalLink standardUniversalLink:",s.standardUniversalLink),console.log("getUniversalLink standardUniversalLink:",`${s.standardUniversalLink}?deeplink=${n}`),`${s.standardUniversalLink}?deeplink=${n}`}function p(e,t,n,o=!0){var r;let i=!!(null===(r=v())||void 0===r?void 0:r.TelegramWebviewProxy);console.log("openOKXDeeplinkWithFallback fullUrl:",t);let a=!1;s.standardUniversalLink,console.log("openOKXDeeplinkWithFallback standardUniversalLink:",s.standardUniversalLink);let c=null,l=()=>{console.log("fallbackToDownloadPage :empty")},u=!1;if(u=n===s.OpenAppLinkType.UniversalLink?(0,d.isInIOSChrome)()||(0,d.isInIOSLine)()||(0,d.isInIOSLark)()||(0,d.isInIOSWeChat)():!1===i&&(0,d.isIos)(),o&&((0,d.isIos)()?u&&(l=()=>{console.log("windowOpen --\x3e fallbackToDownloadPage --",a),a||(console.log("windowOpen --\x3e fallbackToDownloadPage universal link"),window.open(t,"_self"))}):l=()=>{a||(c?c.open(t,"_self"):window.open(t,"_blank"))}),!(0,d.isIos)()||u){if(i?c=window.open(e,"_blank"):(console.log("windowOpen --\x3e deeplinkUrl"),window.location.href=e),o){setTimeout(l,3e3);let e=0,t=setInterval(()=>{console.log("windowOpen --\x3e interval:",++e,document.hidden,document.visibilityState),document.hidden&&(a=!0),(e>10||document.hidden)&&(clearInterval(t),console.log("windowOpen :cleat: ${count}"))},200);window.addEventListener("blur",()=>{console.log("windowOpen :blur"),a=!0},{once:!0}),document.addEventListener("visibilitychange",()=>{console.log("windowOpen :visibilitychange:",document.visibilityState),"hidden"===document.visibilityState&&(a=!0)})}}else i?window.open(t,"_blank"):(console.log("windowOpen[before]: ",Date.now()),(null==window?void 0:window.okxLogDebug)?window.open(t,"_blank"):window.open(t,"_self"),console.log("windowOpen[after]: ",Date.now()))}function v(){if("undefined"!=typeof window)return window}function b(e){let t=JSON.stringify(Object.assign(Object.assign({},e),{protocolVersion:h.CONNECT_PROTOCOL_VER}));(0,c.logDebug)("url encodeConnectParams connectRequestStr ",t);let n=btoa(String.fromCharCode(...new TextEncoder().encode(t)));return(0,c.logDebug)("url encodeConnectParams base64Encoded ",n),n}function _(e){let t=JSON.stringify({topic:e.topic,clientId:e.clientId});return(0,c.logDebug)("url encodeConnectParams connectRequestStr",t),btoa(String.fromCharCode(...new TextEncoder().encode(t)))}function y(e,t){return`${l.shortUniversalLink}?topic=${e}${(0,d.getLastSixMd5Hash)(t)}`}function m(e,t){let n={okxconnect:"",redirect:"",extraparams:"",fromtg:!1};e&&(n.okxconnect=e),t&&(n.redirect=t),w()?n.fromtg=!0:n.fromtg=!1,(0,c.logDebug)("getTelegramWalletTWAUrl redirect:",n.redirect);let o=JSON.stringify(n),r=btoa(String.fromCharCode(...new TextEncoder().encode(o))),i=(0,d.toSafeBase64FromBase64)(r);if((0,c.logDebug)("[TWA] open link:",n,r),e||t){if(w())return(0,l.getTestTgTwaUrl)()?`${(0,l.getTestTgTwaUrl)()}?startapp=${i}`:`https://t.me/${l.tgwalletName}/start?startapp=${i}`;if((0,l.getTestTwaUrl)())return`${(0,l.getTestTwaUrl)()}?tgWebAppStartParam=${i}`;if(!(0,l.getTestTgTwaUrl)())return`tg://resolve?domain=${l.tgwalletName}&appname=${l.tgwalletAppName}&startapp=${i}`;{let e=(0,l.getBotNameAndAppName)((0,l.getTestTgTwaUrl)());if(e){let{botName:t,appName:n}=e;return`tg://resolve?domain=${t}&appname=${n}&startapp=${i}`}return`tg://resolve?domain=${l.tgwalletName}&appname=${l.tgwalletAppName}&startapp=${i}`}}if(w())return(0,l.getTestTgTwaUrl)()?`${(0,l.getTestTgTwaUrl)()}`:`https://t.me/${l.tgwalletName}/start`;if((0,l.getTestTwaUrl)())return`${(0,l.getTestTwaUrl)()}`;if(!(0,l.getTestTgTwaUrl)())return`tg://resolve?domain=${l.tgwalletName}&appname=${l.tgwalletAppName}`;{let e=(0,l.getBotNameAndAppName)((0,l.getTestTgTwaUrl)());if(e){let{botName:t,appName:n}=e;return`tg://resolve?domain=${t}&appname=${n}`}return`tg://resolve?domain=${l.tgwalletName}&appname=${l.tgwalletAppName}`}}function O(e){try{return e=e.replace(/\+/g,"%20"),decodeURIComponent(e)}catch(t){return e}}let C={};try{let e=location.hash.toString();C=function(e){e=e.replace(/^#/,"");let t={};if(!e.length)return t;if(0>e.indexOf("=")&&0>e.indexOf("?"))return t._path=O(e),t;let n=e.indexOf("?");n>=0&&(t._path=O(e.substr(0,n)),e=e.substr(n+1));let o=function(e){let t,n,o,r,i={};if(!e.length)return i;let a=e.split("&");for(t=0;t<a.length;t++)o=O((n=a[t].split("="))[0]),r=null==n[1]?null:O(n[1]),i[o]=r;return i}(e);for(let e in o)t[e]=o[e];return t}(e)}catch(e){}let E="unknown";if((null==C?void 0:C.tgWebAppPlatform)&&(E=null!==(o=C.tgWebAppPlatform)&&void 0!==o?o:"unknown"),"unknown"===E){let e=v();E=null!==(a=null===(i=null===(r=null==e?void 0:e.Telegram)||void 0===r?void 0:r.WebApp)||void 0===i?void 0:i.platform)&&void 0!==a?a:"unknown"}function w(){var e;return"unknown"!==E||!!(null===(e=v())||void 0===e?void 0:e.TelegramWebviewProxy)}},33394:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.logVersion=void 0,t.getDefaultReporter=function(){return i},t.logDebug=function(...e){if("undefined"!=typeof console)try{(null==window?void 0:window.okxLogDebug)&&console.log(`[OKX_CONNECT_SDK] ${a} `,...e)}catch(e){}},t.logError=function(...e){if("undefined"!=typeof console)try{(null==window?void 0:window.okxLogDebug)&&console.error(`[OKX_CONNECT_SDK] ${a} `,...e);{let t="";t+=[...e].reduce((e,t)=>{"string"==typeof t?e+=","+t:"object"==typeof t&&(e+=JSON.stringify(t))}),i.sendRecordContent(t,r.OKXReportType.LOG,"")}}catch(e){}},t.logWarning=function(...e){if("undefined"!=typeof console)try{(null==window?void 0:window.okxLogDebug)&&console.warn(`[OKX_CONNECT_SDK] ${a} `,...e)}catch(e){}},t.reportEvent=function(e,t,n){return o(this,arguments,void 0,function*(e,t,n,o,r,a,s,c,l){try{yield i.sendRecordContent(n,e,t,o,r,a,s,c,l)}catch(e){}})},t.reportLog=function(e){return o(this,arguments,void 0,function*(e,t="default"){})};let r=n(17322),i=new r.OKXReporter,a=n(86958).version;t.logVersion=a},34221:function(e,t,n){"use strict";var o,r=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(o=function(e){return(o=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t})(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=o(e),a=0;a<n.length;a++)"default"!==n[a]&&r(t,e,n[a]);return i(t,e),t}),s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.OKXWalletConnector=void 0;let c=n(74538),l=n(83151),d=n(51766),u=n(62332),h=n(11769),f=n(22585),g=a(n(33394)),p=n(1461),v=n(17322),b=(0,h.resolveWebSocketImplementation)();class _{constructor(e){if(this.events=new f.EventEmitter,this.state=c.ConnectorState.InitState,this.selectedUrlIndex=0,this.retryCount=0,this.timeOutLimit=8e3,!(0,h.checkWSUrl)(e))throw Error(`CONNECTOR: invalid url ${e}`);this.url=e,this.heartbeatTimer=null,this.connectionTimeoutTimer=null,this.connectURLStorage=new d.Storage(l.OKXCONNECTOR_CACHE_KEY+l.OKXCONNECTOR_CACHE_KEY)}get connecting(){return this.state==c.ConnectorState.Connecting}onPayload(e){if(void 0!==e.data){if(g.logDebug("get received data"),g.logDebug(e),"string"==typeof e.data&&"pong"===e.data){g.logDebug(`CONNECT: receive pong ${Date.now().toString()}`);return}this.events.emit("payload",e.data)}}onClose(e){var t;g.logDebug("socket get closed: ",null===(t=this.socket)||void 0===t?void 0:t.url,e.code),this.socket=void 0,this.events.emit("close",e)}onError(e,t){let n={id:e,msg:t.toString()};this.events.emit("payload",n)}onopen(e){e.onmessage=e=>this.onPayload(e),e.onclose=e=>this.onClose(e),this.socket=e,this.state=c.ConnectorState.Connected,this.events.emit("open")}emitError(e){this.events.emit("fail",e)}heartbeat(){return s(this,void 0,void 0,function*(){if(this.heartbeatTimer&&clearTimeout(this.heartbeatTimer),this.state!=c.ConnectorState.Connected&&this.state!=c.ConnectorState.OnError){g.logDebug("heart beat close");return}if(!this.socket){if(g.logDebug("socket not exist"),this.state==c.ConnectorState.Connected||this.state==c.ConnectorState.OnError){g.logDebug("socket reconnect by heartbeat");try{yield this.tryRegistOpen()}catch(e){g.logError("regist open failed"),this.heartbeatTimer=setTimeout(this.heartbeat.bind(this),5e3)}}return}if(this.socket.readyState!==WebSocket.OPEN){if(g.logDebug("socket not ready"),this.state==c.ConnectorState.Connected||this.state==c.ConnectorState.OnError){g.logDebug("socket reconnect by heartbeat with state",this.state,this.socket.readyState);try{yield this.tryRegistOpen()}catch(e){g.logError("regist open failed"),this.heartbeatTimer=setTimeout(this.heartbeat.bind(this),5e3)}}return}g.logDebug(`send ping heart beat: ${Date.now().toString()}, ${this.socket}`),this.socket.send("ping"),this.heartbeatTimer=setTimeout(this.heartbeat.bind(this),5e3)})}registOpen(e=this.url,t=!1){if(!(0,h.checkWSUrl)(e))throw Error(`CONNECTOR: invalid url ${e}`);return this.url=e,t||g.logDebug("Connection connect:",this.url,new Date().toUTCString()),this.state=c.ConnectorState.Connecting,new URLSearchParams(e).get("origin"),new Promise((t,n)=>{let o=new b(e,[]);g.logDebug("Connection connect Begin:",this.url,new Date().toUTCString()),this.startTimeOutTimer(o),(0,h.hasBuiltInWebSocket)()?(g.logDebug("Add socket error handler"),o.onerror=()=>{n(Error("socket error")),o.close()}):(g.logDebug("Add socket error handler"),o.on("error",()=>{n(Error("socket error")),o.close()})),o.onopen=()=>{g.logDebug("socket opened"),this.resetTimeOutTimer(c.OKXCONNECTOR_WS_URL_PENDING_CLOSE_CODE.FINISHED),this.onopen(o),this.heartbeat(),t(o)}})}checkMaxRetry(){return g.logDebug("current retry count:",this.retryCount,"of",c.OKXCONNECTOR_WS_URL_LIST.length),this.retryCount>3*c.OKXCONNECTOR_WS_URL_LIST.length}connectionTryNext(){return s(this,void 0,void 0,function*(){if(this.checkMaxRetry())g.logDebug("Max Connection retry ",this.retryCount,new Date().toUTCString());else{this.retryCount+=1;let e=this.getNextSelectUrl();return g.logDebug("Connection retry:",e,new Date().toUTCString()),this.registOpen(e,!0)}})}startTimeOutTimer(e){this.connectionTimeoutTimer&&this.resetTimeOutTimer(c.OKXCONNECTOR_WS_URL_PENDING_CLOSE_CODE.CANCELED),this.pendingSocket=e,this.connectionTimeoutTimer=setTimeout(()=>{this.pendingSocket&&this.resetTimeOutTimer(c.OKXCONNECTOR_WS_URL_PENDING_CLOSE_CODE.TIME_OUT)},this.timeOutLimit)}resetTimeOutTimer(e){var t;if(e==c.OKXCONNECTOR_WS_URL_PENDING_CLOSE_CODE.TIME_OUT)throw clearTimeout(this.connectionTimeoutTimer),null===(t=this.pendingSocket)||void 0===t||t.close(),this.pendingSocket=void 0,g.reportEvent(v.OKXReportType.LOG,"timeout",this.retryCount.toString()),Error("socket timeout");this.pendingSocket=void 0,clearTimeout(this.connectionTimeoutTimer)}cacheSuccessUrlSelect(){this.connectURLStorage.saveContent(this.selectedUrlIndex.toString(),l.OKXCONNECTOR_CACHE_KEY)}getNextSelectUrl(){return this.selectedUrlIndex+=1,this.selectedUrlIndex=this.selectedUrlIndex%c.OKXCONNECTOR_WS_URL_LIST.length,c.OKXCONNECTOR_WS_URL_LIST[this.selectedUrlIndex]}onVisibleChanged(){return s(this,void 0,void 0,function*(){if("visible"===document.visibilityState&&(g.logDebug(`get changed ${this.state}, ${this.socket}`),this.state==c.ConnectorState.Connected&&void 0===this.socket)){g.logDebug("CONNECTION need reopen");try{yield this.tryRegistOpen()}catch(e){g.logError("regist open failed")}return}})}tryRegistOpen(){return s(this,arguments,void 0,function*(e=this.url){if(this.connecting)return g.logDebug("tryRegistOpen => connecting state"),new Promise((e,t)=>{this.events.once("fail",e=>(g.logDebug("tryRegistOpen => connecting fail listener",e),t(e))),this.events.once("open",()=>void 0===this.socket?t(Error("Connect lost")):e(this.socket))});g.logDebug("tryRegistOpen => try registOpen until retry limit is hit");let t=!1;for(;!this.checkMaxRetry()&&!this.socket;)try{g.logDebug("tryRegistOpen => call registOpen, try count:",this.retryCount,t),yield this.registOpen(e,t)}catch(n){g.logDebug("tryRegistOpen => registOpen failed",n),this.retryCount+=1,e=this.getNextSelectUrl(),t=!0}if(g.logDebug("tryRegistOpen => exit while loop",this.retryCount,this.socket),!this.socket&&this.checkMaxRetry())throw g.logDebug("tryRegistOpen => failed to open a socket",this.retryCount,this.socket),this.retryCount=0,this.state=c.ConnectorState.OnError,this.emitError(Error("tryRegistOpen failed")),new p.OKXConnectError(p.OKX_CONNECT_ERROR_CODES.CONNECTION_ERROR,"Failed to connect")})}connect(){return s(this,void 0,void 0,function*(){try{yield this.tryRegistOpen(),document.removeEventListener("visibilitychange",this.onVisibleChanged.bind(this)),document.addEventListener("visibilitychange",this.onVisibleChanged.bind(this))}catch(e){throw g.logDebug("connect => failed to connect",e),e}})}disconnect(){return s(this,void 0,void 0,function*(){return this.state=c.ConnectorState.Disconnected,new Promise((e,t)=>{if(void 0===this.socket){e();return}this.socket.onclose=t=>{this.onClose(t),e()},this.socket.close(),this.heartbeatTimer&&clearTimeout(this.heartbeatTimer)})})}currentStatus(){return{state:this.state,url:this.url}}addListener(e,t,n,o,r){this.listenPayloadHandler&&this.events.removeListener("payload",this.listenPayloadHandler),this.listenPayloadHandler=i=>s(this,void 0,void 0,function*(){var a;g.logDebug(`<<< get payload ${i}`);let s=(0,u.safeJsonParse)(i);if(s.params&&s.params.data){let i=null===(a=s.params.data)||void 0===a?void 0:a.message,c=!1;if(i&&r){let e=yield r(s.params.data);c=e.isSplitPackage&&!e.finalMessage,e.isSplitPackage&&(e.finalMessage&&e.finalMessage.length>0?(g.logDebug("CONNECT: update raw msg content"),i=e.finalMessage):(g.logDebug("CONNECT: skip raw msg content"),c=!0))}if(!c)try{let r=t(i);void 0===r?(g.logDebug("CONNECT: decrypt undefined"),o(e,"Decrypt undefined")):n(e,r)}catch(t){g.logDebug(`CONNECT: decrypt failed: ${t}`),o(e,t.message)}}}),this.events.on("payload",this.listenPayloadHandler),this.failHandler&&this.events.removeListener("fail",this.failHandler),this.failHandler=t=>{t?(g.logDebug(`CONNECT failed: ${t}`),o(e,t.message)):o(e,"Unkonow error")},this.events.on("fail",this.failHandler)}addPackageParse(e){this.payloadHandler&&this.events.removeListener("payload",this.payloadHandler),this.payloadHandler=t=>s(this,void 0,void 0,function*(){g.logDebug(`CONNECTION @[${new Date().toUTCString()}] <<<< received e:${t}`);let n=(0,u.safeJsonParse)(t);yield e(n)}),this.events.on("payload",this.payloadHandler)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}send(e,t){return s(this,void 0,void 0,function*(){try{void 0===this.socket&&(g.logDebug(`>>> send payload undefined ${t}`),yield e()),g.logDebug(`CONNECTION @[${new Date().toUTCString()}]>>> send payload ${(0,u.safeJsonStringify)(t)}`),this.socket&&this.socket.send((0,u.safeJsonStringify)(t))}catch(e){this.onError(t.id,e)}})}getMsgPayloadFromHistory(e){return s(this,void 0,void 0,function*(){if(void 0===e)return;let t=(0,u.safeJsonStringify)(e);g.logDebug("get received data from history"),g.logDebug(t),t=(0,u.safeJsonStringify)({params:{data:e}}),this.events.emit("payload",t)})}onOpen(e){this.openHandler&&this.events.removeListener("open",this.openHandler),this.openHandler=()=>s(this,void 0,void 0,function*(){g.logDebug(`CONNECTION @[${new Date().toUTCString()}] >>> ws opened: `),yield e()}),this.events.on("open",this.openHandler),this.cacheSuccessUrlSelect()}}t.OKXWalletConnector=_},35329:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WalletConnectionManagerEvent=t.WalletConnectionManagerTopicInfoCacheKey=void 0,t.WalletConnectionManagerTopicInfoCacheKey="wcmtic",t.WalletConnectionManagerEvent={RECEIVE_REQUEST:"payload"}},36003:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Report_WalletType_Key=t.Report_OKXConnectSDK_RequestError_Log=t.Report_OKXConnectSDK_RequestSuccess_Log=t.Report_OKXConnectSDK_RequestStart_Log=t.Report_OKXConnectSDKExtension_ConnectDapp_Button_Click=t.Report_OKXConnectSDKExtension_Module_Retry_Click=t.Report_ConnectDapp_ConnectAndSign_Click=t.Report_Proceed_QRCode_Click=t.Report_ChooseType_Download_Click=t.Report_ChooseType_ConnectWallet_Click=t.Report_Proceed_Retry_Click=t.Report_OKXConnectSDKExtension_ConnectDapp_ConnectSuccess_View=t.Report_OKXConnectSDKExtension_ConnectDapp_Page_View=t.Report_ChooseType_ConnectWallet_View=t.Report_Loading_ConnectWallet_View=t.Report_Proceed_QRCode_View=t.Report_Proceed_Proceed_View=void 0,t.Report_Proceed_Proceed_View="OKXConnectSDK_Proceed_Proceed_View",t.Report_Proceed_QRCode_View="OKXConnectSDK_Proceed_QRCode_View",t.Report_Loading_ConnectWallet_View="OKXConnectSDK_Loading_ConnectWallet_View",t.Report_ChooseType_ConnectWallet_View="OKXConnectSDK_ChooseType_ConnectWallet_View",t.Report_OKXConnectSDKExtension_ConnectDapp_Page_View="OKXConnectSDKExtension_ConnectDapp_Page_View",t.Report_OKXConnectSDKExtension_ConnectDapp_ConnectSuccess_View="OKXConnectSDKExtension_ConnectDapp_ConnectSuccess_View",t.Report_Proceed_Retry_Click="OKXConnectSDK_Proceed_Retry_Click",t.Report_ChooseType_ConnectWallet_Click="OKXConnectSDK_ChooseType_ConnectWallet_Click",t.Report_ChooseType_Download_Click="OKXConnectSDK_ChooseType_Download_Click",t.Report_Proceed_QRCode_Click="OKXConnectSDK_Proceed_QRCode_Click",t.Report_ConnectDapp_ConnectAndSign_Click="OKXConnectSDK_ConnectDapp_ConnectAndSign_Click",t.Report_OKXConnectSDKExtension_Module_Retry_Click="OKXConnectSDKExtension_Module_Retry_Click",t.Report_OKXConnectSDKExtension_ConnectDapp_Button_Click="OKXConnectSDKExtension_ConnectDapp_Button_Click",t.Report_OKXConnectSDK_RequestStart_Log="Report_OKXConnectSDK_RequestStart_View",t.Report_OKXConnectSDK_RequestSuccess_Log="Report_OKXConnectSDK_RequestSuccess_View",t.Report_OKXConnectSDK_RequestError_Log="Report_OKXConnectSDK_RequestError_View",t.Report_WalletType_Key="wallet_type"},36294:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserRandomSource=void 0;class n{constructor(){this.isAvailable=!1,this.isInstantiated=!1;let e="undefined"!=typeof self?self.crypto||self.msCrypto:null;e&&void 0!==e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw Error("Browser random byte generator is not available.");let t=new Uint8Array(e);for(let e=0;e<t.length;e+=65536)this._crypto.getRandomValues(t.subarray(e,e+Math.min(t.length-e,65536)));return t}}t.BrowserRandomSource=n},36893:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_ERROR=t.STANDARD_ERROR_MAP=t.SERVER_ERROR_CODE_RANGE=t.RESERVED_ERROR_CODES=t.SERVER_ERROR=t.INTERNAL_ERROR=t.INVALID_PARAMS=t.METHOD_NOT_FOUND=t.INVALID_REQUEST=t.PARSE_ERROR=t.OKX_CONNECT_ERROR_CODES=t.OKXConnectError=void 0;class o extends Error{constructor(e,t){void 0==t&&(t=function(e){if(e==n.UNKNOWN_ERROR);else if(e==n.BAD_REQUEST_ERROR)return"bad request error";else if(e==n.ALREADY_CONNECTED_ERROR)return"already connected error";else if(e==n.NOT_CONNECTED_ERROR)return"not connected error";else if(e==n.UNKNOWN_APP_ERROR)return"unknown app error";else if(e==n.USER_REJECTS_ERROR)return"user rejects error";else if(e==n.USER_REJECTS_ERROR_CAUSE_REGISTER)return"wallet address are registering";else if(e==n.METHOD_NOT_SUPPORTED)return"method not supported";else if(e==n.CONNECTION_ERROR)return"connect error";else if(e==n.CHAIN_NOT_SUPPORTED)return"chain not supported";return"unknown error"}(e)),super(t),this.code=e,this.message=`${o.prefix} ${t?"\n"+t:""}`,Object.setPrototypeOf(this,o.prototype)}toJSON(){return{message:this.message,code:this.code}}}t.OKXConnectError=o,o.prefix="[OKX_CONNECT_SDK_ERROR]",!function(e){e[e.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",e[e.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",e[e.ALREADY_CONNECTED_ERROR=11]="ALREADY_CONNECTED_ERROR",e[e.NOT_CONNECTED_ERROR=12]="NOT_CONNECTED_ERROR",e[e.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",e[e.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",e[e.USER_REJECTS_ERROR_CAUSE_REGISTER=301]="USER_REJECTS_ERROR_CAUSE_REGISTER",e[e.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED",e[e.CHAIN_NOT_SUPPORTED=500]="CHAIN_NOT_SUPPORTED",e[e.WALLET_NOT_SUPPORTED=600]="WALLET_NOT_SUPPORTED",e[e.CONNECTION_ERROR=700]="CONNECTION_ERROR"}(n||(t.OKX_CONNECT_ERROR_CODES=n={})),t.PARSE_ERROR="PARSE_ERROR",t.INVALID_REQUEST="INVALID_REQUEST",t.METHOD_NOT_FOUND="METHOD_NOT_FOUND",t.INVALID_PARAMS="INVALID_PARAMS",t.INTERNAL_ERROR="INTERNAL_ERROR",t.SERVER_ERROR="SERVER_ERROR",t.RESERVED_ERROR_CODES=[-32700,-32600,-32601,-32602,-32603],t.SERVER_ERROR_CODE_RANGE=[-32e3,-32099],t.STANDARD_ERROR_MAP={[t.PARSE_ERROR]:{code:-32700,message:"Parse error"},[t.INVALID_REQUEST]:{code:-32600,message:"Invalid Request"},[t.METHOD_NOT_FOUND]:{code:-32601,message:"Method not found"},[t.INVALID_PARAMS]:{code:-32602,message:"Invalid params"},[t.INTERNAL_ERROR]:{code:-32603,message:"Internal error"},[t.SERVER_ERROR]:{code:-32e3,message:"Server error"}},t.DEFAULT_ERROR=t.SERVER_ERROR},39628:function(e,t,n){"use strict";var o,r=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(o=function(e){return(o=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t})(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=o(e),a=0;a<n.length;a++)"default"!==n[a]&&r(t,e,n[a]);return i(t,e),t}),s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionManager=void 0;let c=n(34221),l=n(24139),d=n(83151),u=n(26751),h=n(74538),f=n(22585),g=n(51766),p=n(11769),v=n(11589),b=n(13958),_=n(82091),y=a(n(33394)),m=n(33394),O=n(17322),C=n(29477),E=n(138);class w{constructor(e){this.events=new f.EventEmitter,this.splitManager=new E.ConnectionSplitPackages("dapp"),this.connectorEnable=!1,this.connectStorage=new g.Storage(d.OKXCONNECTOR_CACHE_KEY_DAPP+e,d.OKXCONNECTOR_CACHE_KEY_DAPP),this.tonsdkConnectStorage=new g.Storage(d.OKXCONNECTOR_TON_KEY+e,d.OKXCONNECTOR_TON_KEY),this.crypto=new v.SessionCrypto;let t=(0,C.isInTMA)();if((0,m.logDebug)("do init:",t),y.reportLog("connection manager do init"),t)try{let e=this.getCachedCryptoKeyPair();(0,m.logDebug)("use same pk:",e),this.crypto=new v.SessionCrypto(e)}catch(e){this.connectStorage.clearCache(),y.reportEvent(O.OKXReportType.LOG,"cache_fail","cache failed")}this.jwtKeyPair=this.getCachedJWTKeyPair(),this.saveJWTKeyPair(this.jwtKeyPair),this.connector=new c.OKXWalletConnector(h.OKXCONNECTOR_WS_URL_1),this.packageId=Date.now(),this.connectedWalletPK="",this.currentTopic="",y.logDebug(`this.connectedWalletPK  constructor   ${this.connectedWalletPK}`)}refreshPackageId(){let e=Date.now();e==this.packageId&&(this.packageId=e+1),this.packageId=e}saveCryptoKeyPair(e){let t=(0,_.safeJsonStringify)(e);this.connectStorage.encryptStoreMsg(t,d.OKXCONNECTOR_CRYPTO_KEY)}getCachedCryptoKeyPair(){let e=this.connectStorage.getAndDecrypt(d.OKXCONNECTOR_CRYPTO_KEY);return"string"==typeof e?(y.logDebug("get cached crypto key:"),y.logDebug(e),(0,_.safeJsonParse)(e)):(this.connectStorage.clearCache(),null)}saveJWTKeyPair(e){var t={publicKey:(0,p.toHexString)(e.publicKey),secretKey:(0,p.toHexString)(e.secretKey)};y.logDebug("save jwt kp");let n=(0,_.safeJsonStringify)(t);y.logDebug(n),this.connectStorage.encryptStoreMsg(n,d.OKXCONNECTOR_JWT_KEY)}getCachedJWTKeyPair(){try{let e=this.connectStorage.getAndDecrypt(d.OKXCONNECTOR_JWT_KEY);if("string"!=typeof e)return(0,b.generateKeyPair)();{y.logDebug("get cached jwt kp:"),y.logDebug(e);let t=(0,_.safeJsonParse)(e);return y.logDebug("save jwt kp"),y.logDebug(t),{publicKey:(0,p.hexToByteArray)(t.publicKey),secretKey:(0,p.hexToByteArray)(t.secretKey)}}}catch(e){return y.reportEvent(O.OKXReportType.LOG,"cache_fail","cache failed"),(0,b.generateKeyPair)()}}isWalletPKReady(){return y.logDebug(`isWalletPKReady  ===> ${this.connectedWalletPK}`),this.connectedWalletPK.length>0}makeJWT(e){return s(this,void 0,void 0,function*(){return yield(0,b.signJWT)(e,u.OKXCONNECTOR_JWT_SIDE,u.OKXCONNECTOR_JWT_TTL,this.jwtKeyPair)})}parsePackage(e){return s(this,arguments,void 0,function*(e,t=!1){var n,o,r,i,a,c,u,h,f,g,p,v,b;if(this.events.emit(e.id,e),!t){yield this.sendACK(e.id,!0);let t=null===(n=this.connectStorage.getItem(d.OKXCONNECTOR_TOKEN_CACHE))||void 0===n?void 0:n.content;if(t&&(null===(r=null===(o=e.params)||void 0===o?void 0:o.data)||void 0===r?void 0:r.messageId)){e.method&&e.method===l.CONNECT_METHOD_PUSH&&((0,m.logDebug)("checkExpire: update expire when get push"),this.updateExpireLimit(t));let n=this.splitManager.tryParseMessageSplitPayload(null===(a=null===(i=e.params)||void 0===i?void 0:i.data)||void 0===a?void 0:a.message);if(n){let o={topicId:null===(u=null===(c=e.params)||void 0===c?void 0:c.data)||void 0===u?void 0:u.topic,messageId:null===(f=null===(h=e.params)||void 0===h?void 0:h.data)||void 0===f?void 0:f.messageId,messageObject:n,publishedAt:null===(p=null===(g=e.params)||void 0===g?void 0:g.data)||void 0===p?void 0:p.publishedAt},r=yield this.splitManager.onReceivedPackageCheck(o);r.completeMessageIdList&&r.completeMessageIdList.forEach(e=>s(this,void 0,void 0,function*(){this.refreshPackageId(),yield this.sendReceive(this.packageId.toString(),e,t)}))}else this.refreshPackageId(),yield this.sendReceive(this.packageId.toString(),null===(b=null===(v=e.params)||void 0===v?void 0:v.data)||void 0===b?void 0:b.messageId,t)}}})}restoreConnect(e){return s(this,void 0,void 0,function*(){if(y.reportLog("connection manager restore connection"),y.logDebug(`connectionManager  restoreConenct   ${e}`),"string"!=typeof e||0===e.length)throw Error("CONNECTION: invalid topic");y.logDebug("connectionManager  restoreConenct   disconnect"),yield this.disconnect(!0),this.connectStorage.saveContent(e,d.OKXCONNECTOR_TOKEN_CACHE),y.logDebug("connectionManager  restoreConenct   conect"),yield this.connect(!0)})}getConnectInfo(){var e=(0,p.generateTopic)();return y.logDebug(`generate topic token: ${e}`),y.reportLog("connection manager generate connection info"),this.currentTopic=e,{channelId:e,clientId:this.crypto.stringifyKeypair().publicKey}}connect(){return s(this,arguments,void 0,function*(e=!1){this.timeLog=new Date().getTime(),(0,m.logDebug)("ConnectTime---enter->",this.timeLog),y.reportLog("connection manager begin connect");let t=this.connectStorage.getItem(d.OKXCONNECTOR_TOKEN_CACHE);var n=this.currentTopic;if(y.logDebug(`generate topic token: ${n}`),e){null!=t&&(y.logDebug(`read last connect id: ${t}`),n=t.content);var o=this.connectStorage.getItem(d.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE);o&&(this.connectedWalletPK=o.content,(0,m.logDebug)(`connectionManager connect() this.connectedWalletPK : ${this.connectedWalletPK}`)),y.reportLog("connection manager do restore connection")}if(e)try{let e=this.getCachedCryptoKeyPair();e&&(this.crypto=new v.SessionCrypto(e))}catch(e){throw y.logError("get crypto key pair from cache failed"),y.reportEvent(O.OKXReportType.LOG,"cache_fail","cache failed"),this.connectStorage.clearCache(),Error("crypto cache failed")}y.logDebug(`use crypto client id: ${this.crypto.stringifyKeypair().publicKey}`),this.connectStorage.saveContent(n,d.OKXCONNECTOR_TOKEN_CACHE);var r=yield this.makeJWT(n);return y.logDebug(`generate jwt token: ${r}`),this.connectStorage.saveContent(r,"jwt"),new Promise((t,o)=>{this.connector.onOpen(()=>s(this,void 0,void 0,function*(){y.logDebug("1. connector on open"),y.reportLog("1. connect ws open");let i=new Date().getTime();(0,m.logDebug)("ConnectTime---open->",i-this.timeLog),this.events.once(this.packageId.toString(),r=>s(this,void 0,void 0,function*(){if(r&&r.error){y.logError("failed when login"),y.reportLog("2. connect login failed"),yield this.connector.disconnect();var i=Error();i.message=r.error.message,i.name=r.error.code.toString(),o(i)}this.refreshPackageId(),this.events.once(this.packageId.toString(),r=>s(this,void 0,void 0,function*(){if(r&&r.error){y.logError("failed when subscribe"),y.reportLog("3. connect subscribe failed"),yield this.connector.disconnect();var i=Error();i.message=r.error.message,i.name=r.error.code.toString(),o(i)}this.refreshPackageId(),y.logDebug(`4. subscribe callback then send fetch: ${this.packageId}`),y.reportLog("4. subscribe callback then send fetch");let a=new Date().getTime();(0,m.logDebug)("ConnectTime--subscribe callback->",a-this.timeLog),yield this.sendFetchAndConsumeMessages(this.packageId.toString(),n),y.logDebug(`5. splitmanager init: ${this.packageId}`),y.reportLog("5. splitmanager init"),yield this.splitManager.init(this.sendRaw.bind(this)),e&&(this.checkExpire(n)?((0,m.logDebug)("disconnect From topic expire"),setTimeout(()=>{this.activateDisconnect()},1e3)):((0,m.logDebug)("extends expire check"),this.updateExpireLimit(n))),t()})),y.logDebug(`3. login callback then send subscribe: ${this.packageId}`),y.reportLog("3. connect subscribe failed");let a=new Date().getTime();(0,m.logDebug)("ConnectTime---login callback->",a-this.timeLog),yield this.connector.send(()=>s(this,void 0,void 0,function*(){y.logDebug("CONNECT: reconnect before send"),yield this.connector.connect().catch(e=>{(0,m.logDebug)("ConnectionManager connect error",e),o(e)})}),{id:this.packageId.toString(),jsonrpc:h.CONNECT_JSONRPC_VER,method:l.CONNECT_METHOD_SUB,params:{topic:n}})})),y.logDebug("2. login called"),y.reportLog("2. connection manager connect call login"),yield this.connector.send(()=>s(this,void 0,void 0,function*(){y.logDebug("CONNECT: reconnect before send"),yield this.connector.connect().catch(e=>{(0,m.logDebug)("ConnectionManager connect error",e),o(e)})}),{id:this.packageId.toString(),jsonrpc:h.CONNECT_JSONRPC_VER,method:l.CONNECT_METHOD_LOGIN,params:{token:r}}),this.connector.addPackageParse(e=>{var t;if(y.logDebug("connect: parse package"),y.logDebug(e),!("params"in e)||!("data"in e.params)){this.parsePackage(e,!0);return}let n=null===(t=e.params.data)||void 0===t?void 0:t.message;if(void 0!==n&&n.length>0){n=n.replace(/'/g,'"');let e=(0,_.safeJsonParse)(n);"string"!=typeof e&&"clientId"in e&&e.clientId&&e.clientId.length>0&&(this.connectedWalletPK=e.clientId,y.logDebug(`this.connectedWalletPK  addPackageParse   ${this.connectedWalletPK}`),this.connectStorage.saveContent(this.connectedWalletPK,d.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE),this.saveCryptoKeyPair(this.crypto.stringifyKeypair()))}this.parsePackage(e,e.method===l.CONNECT_METHOD_RECEIVE)})})),this.connector.connect().catch(e=>{(0,m.logDebug)("ConnectionManager connect error",e),o(e)}),this.connectorEnable=!0})})}sendDisconnect(e){return s(this,void 0,void 0,function*(){return new Promise((t,n)=>s(this,void 0,void 0,function*(){if(this.refreshPackageId(),!this.connectorEnable){y.logDebug("skip disconnect before connected relay"),t();return}this.events.once(this.packageId.toString(),e=>s(this,void 0,void 0,function*(){y.logDebug("CONNECT: disconnect command send"),this.connectorEnable=!1,t()}));let n={id:this.packageId.toString(),jsonrpc:h.CONNECT_JSONRPC_VER,method:l.CONNECT_METHOD_DISCONNECT,params:{message:{topic:e,ttl:h.OKXCONNECTOR_MESSAGE_DISCONNECT_TTL}}};yield this.connector.send(()=>s(this,void 0,void 0,function*(){y.logDebug("CONNECT: skip reconnect send")}),n)}))})}sendRecvDisconnect(e){return s(this,void 0,void 0,function*(){this.refreshPackageId();let t={id:this.packageId.toString(),jsonrpc:h.CONNECT_JSONRPC_VER,method:l.CONNECT_METHOD_RECV_DISCONNECT,params:{topic:e}};yield this.connector.send(()=>s(this,void 0,void 0,function*(){return y.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),t)})}disconnect(){return s(this,arguments,void 0,function*(e=!1){try{yield this.sendDisconnect(this.currentTopic)}catch(e){y.logError("send disconnect command failed",e)}yield this.connector.disconnect(),y.reportLog("connect disconnect"),this.connectStorage.clearCache(d.OKXCONNECTOR_TOKEN_CACHE),e||(this.connectStorage.clearCache(d.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE),this.connectedWalletPK="",(0,m.logDebug)(`connectionManager disconnect() this.connectedWalletPK : ${this.connectedWalletPK}`))})}updateProtocolVersion(e,t){this.splitManager.updateTopicSenderVersion(e,t)}addListener(e,t,n){this.connector.addListener((0,_.safeJsonStringify)(e),e=>{if(e=e.replace(/'/g,'"'),y.logDebug(`addListener ===> ${e}`),void 0!==e&&e.length>0){let o;var t=(0,_.safeJsonParse)(e),n=t.message;return n.trimStart().startsWith("{")?o=n:(t.clientId&&t.clientId.length>0&&(this.connectedWalletPK=t.clientId,this.connectStorage.saveContent(this.connectedWalletPK,d.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE),y.logDebug(`this.connectedWalletPK  addListener   ${this.connectedWalletPK}`),y.logDebug(`this.cryptoKey  addListener   ${(0,p.toHexString)(this.crypto.keyPair.publicKey)}`),this.saveCryptoKeyPair(this.crypto.stringifyKeypair())),o=this.crypto.decrypt(n,this.connectedWalletPK)),y.logDebug(`addListener ===> ${o}`),o}},t,n,e=>new Promise((t,n)=>s(this,void 0,void 0,function*(){let n=this.splitManager.tryParseMessageSplitPayload(e.message);if(n){let o={topicId:e.topic,messageId:null==e?void 0:e.messageId,messageObject:n,publishedAt:null==e?void 0:e.publishedAt};t((yield this.splitManager.onReceivedPackageCheck(o)))}else t({isSplitPackage:!1})})))}sendRaw(e){return s(this,void 0,void 0,function*(){y.logDebug(`message send =====> ${e}`),y.reportLog("connect send raw msg"),y.logDebug(`message send =====encrypt message.length>>>> ${e.length}`);let t=this.connectStorage.getItem(d.OKXCONNECTOR_TOKEN_CACHE);y.logDebug(`message send =====topic>>>> ${null==t?void 0:t.content}`),this.refreshPackageId();let n={id:this.packageId.toString(),method:l.CONNECT_METHOD_PUBLISH,jsonrpc:h.CONNECT_JSONRPC_VER,params:{message:{topic:null==t?void 0:t.content,message:e,ttl:h.OKXCONNECTOR_MESSAGE_TTL}}};return this.events.once(this.packageId.toString(),e=>s(this,void 0,void 0,function*(){e&&e.error?y.logError(`@${new Date().toUTCString()} >>> failed when send msg`):e&&!e.error&&y.logDebug(`CONNECTION @[${new Date().toUTCString()}] >>> send msg with id ${this.packageId} successed`)})),yield this.connector.send(()=>s(this,void 0,void 0,function*(){return y.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),n),this.packageId})}sendEncryptedMsg(e,t){return s(this,arguments,void 0,function*(e,t,n=h.OKXCONNECTOR_MESSAGE_TTL){this.refreshPackageId();let o={id:this.packageId.toString(),method:l.CONNECT_METHOD_PUBLISH,jsonrpc:h.CONNECT_JSONRPC_VER,params:{message:{topic:e,message:t,ttl:n}}};this.events.once(this.packageId.toString(),e=>s(this,void 0,void 0,function*(){e&&e.error?y.logError(`@${new Date().toUTCString()} >>> failed when send msg`):e&&!e.error&&y.logDebug(`CONNECTION @[${new Date().toUTCString()}] >>> send msg with id ${this.packageId} successed`)})),yield this.connector.send(()=>s(this,void 0,void 0,function*(){return y.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),o)})}send(e){return s(this,arguments,void 0,function*(e,t=h.OKXCONNECTOR_MESSAGE_TTL){if(y.logDebug(`message send =====> ${e}`),y.reportLog("connect send msg"),!this.isWalletPKReady())throw Error("connection not finish");let n=this.crypto.encrypt(e,this.connectedWalletPK);y.logDebug(`message send =====encrypt message.length>>>> ${n.length}`),y.reportEvent(O.OKXReportType.LOG,"msg_size",n.length.toString());let o=this.connectStorage.getItem(d.OKXCONNECTOR_TOKEN_CACHE);return y.logDebug(`message send =====topic>>>> ${null==o?void 0:o.content}`),yield this.splitManager.sendSplitPackages(null==o?void 0:o.content,n,this.sendEncryptedMsg.bind(this),this.sendRaw.bind(this)),this.packageId})}sendACK(e,t){return s(this,arguments,void 0,function*(e,t,n){if(!0===t){let t={id:e,jsonrpc:h.CONNECT_JSONRPC_VER,result:!0};yield this.connector.send(()=>s(this,void 0,void 0,function*(){return y.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),t)}else if(n){let t={id:e,jsonrpc:h.CONNECT_JSONRPC_VER,error:{code:n.code,message:n.message}};yield this.connector.send(()=>s(this,void 0,void 0,function*(){return y.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),t)}})}sendReceive(e,t,n){return s(this,void 0,void 0,function*(){let o={id:e,jsonrpc:h.CONNECT_JSONRPC_VER,method:l.CONNECT_METHOD_RECEIVE,params:{data:{messageId:t,topic:n}}};yield this.connector.send(()=>s(this,void 0,void 0,function*(){return y.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),o)})}sendFetchAndConsumeMessages(e,t){return s(this,void 0,void 0,function*(){this.events.once(e,e=>s(this,void 0,void 0,function*(){var n,o;if(e.result){var r=e.result.hasMore,i=e.result.data;let n=e.result.disconnectedTopics;if(n)try{for(let e=0;e<n.length;e++){let t=n[e];if(t.topic){(0,m.logDebug)("send receive disconnect:",t.topic),yield this.sendRecvDisconnect(t.topic);let e=(0,_.safeJsonStringify)({requestId:t.publishedAt.toString(),method:"disconnect"}),n={messageId:t.publishedAt.toString(),message:(0,_.safeJsonStringify)({message:e}),topic:t.topic,publishedAt:t.publishedAt};yield this.connector.getMsgPayloadFromHistory(n)}}}catch(e){y.logError("disconnect topic fails",e)}if(i)for(let e=0;e<i.length;e++){let n=i[e];if(n&&n.topic==t){let e=n.messageId;y.reportLog("5. get fetch result"),this.splitManager.tryParseMessageSplitPayload(n.message)?(yield this.connector.getMsgPayloadFromHistory(n),y.logDebug("skip receive")):(yield this.connector.getMsgPayloadFromHistory(n),this.refreshPackageId(),yield this.sendReceive(this.packageId.toString(),e,t))}}r&&(this.refreshPackageId(),yield this.sendFetchAndConsumeMessages(this.packageId.toString(),t))}else y.logDebug(`CONNECT: get error rsp ${null===(n=e.error)||void 0===n?void 0:n.code} : ${null===(o=e.error)||void 0===o?void 0:o.message}`)})),y.logDebug("5. send fetch more"),y.reportLog("5. send fetch more");let n=new Date().getTime();(0,m.logDebug)("ConnectTime---5->",n-this.timeLog);let o={id:e,jsonrpc:h.CONNECT_JSONRPC_VER,method:l.CONNECT_METHOD_FETCHMSG,params:{data:{topic:t}}};yield this.connector.send(()=>s(this,void 0,void 0,function*(){return y.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),o)})}cleanCache(){y.reportLog("connection cache clean called"),this.connectStorage.clearCache()}saveSessionContent(e,t){t||this.connectStorage.clearCache(d.OKXCONNECTOR_SESSION_PREFIX_KEY+e);let n=(0,_.safeJsonStringify)(t);this.connectStorage.encryptStoreMsg(n,d.OKXCONNECTOR_SESSION_PREFIX_KEY+e)}getSessionContent(e){try{let t=this.connectStorage.getAndDecrypt(d.OKXCONNECTOR_SESSION_PREFIX_KEY+e);if(t)return(0,_.safeJsonParse)(t)}catch(t){this.connectStorage.clearCache(d.OKXCONNECTOR_SESSION_PREFIX_KEY+e)}}getCurrentConnectionReady(){let e=!1;try{this.getCachedCryptoKeyPair()&&(e=!0)}catch(e){y.logError("check connection ready failed")}return this.isWalletPKReady()&&e}getCryptoKeyEnable(){let e=!1;try{this.getCachedCryptoKeyPair()&&(e=!0)}catch(e){y.logError("check connection ready failed")}return e}checkExpire(e){let t=!1;if(0==e.length)return(0,m.logDebug)("checkExpire: invalid topic"),t;let n=this.getSessionContent(d.OKXCONNECTOR_STORAGE_TOPIC_EXPIRE_CACHE);return n&&n.topic?n.topic==e?Date.now()>n.timestamp&&((0,m.logDebug)("checkExpire: connection is Expired"),t=!0):((0,m.logDebug)("checkExpire: not same connection"),t=!1):((0,m.logDebug)("checkExpire: not topic records"),this.updateExpireLimit(e),t=!1),t}updateExpireLimit(e){(0,m.logDebug)(`update expire limit for topic: ${e}`);let t={topic:e,timestamp:Date.now()+h.OKXCONNECTOR_SESSION_LIVE_TTL};this.saveSessionContent(d.OKXCONNECTOR_STORAGE_TOPIC_EXPIRE_CACHE,t)}activateDisconnect(){return s(this,void 0,void 0,function*(){let e=(0,_.safeJsonStringify)({requestId:"",method:"disconnect"}),t={messageId:"",message:(0,_.safeJsonStringify)({message:e}),topic:this.currentTopic,publishedAt:0};yield this.connector.getMsgPayloadFromHistory(t)})}}t.ConnectionManager=w},39819:function(e,t,n){"use strict";var o,r=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(o=function(e){return(o=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t})(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=o(e),a=0;a<n.length;a++)"default"!==n[a]&&r(t,e,n[a]);return i(t,e),t}),s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.WalletConnectionManager=void 0;let c=n(34221),l=n(24139),d=n(83151),u=n(26751),h=n(74538),f=n(35329),g=n(138),p=n(22585),v=n(51766),b=n(11769),_=n(11589),y=n(13958),m=n(82091),O=a(n(33394)),C=n(33394),E=n(62332);class w{constructor(){this.events=new p.EventEmitter,this.communicateEvents=new p.EventEmitter,this.splitManager=new g.ConnectionSplitPackages("wallet"),O.logDebug("connect manager construct"),this.connectStorage=new v.Storage(d.OKXCONNECTOR_CACHE_KEY),this.jwtKeyPair=this.getCachedJWTKeyPair(),this.saveJWTKeyPair(this.jwtKeyPair),this.connector=new c.OKXWalletConnector(h.OKXCONNECTOR_WS_URL_1),this.packageId=Date.now(),this.sessionCryptoInfoMap=new Map,this.inLogin=!1,this.isLogined=!1}refreshPackageId(e=0){let t=Date.now()+e;t==this.packageId&&(this.packageId=t+1),this.packageId=t}saveCryptoKeyPair(e,t){let n=(0,m.safeJsonStringify)(t);this.connectStorage.encryptStoreMsg(n,d.OKXCONNECTOR_CRYPTO_KEY+e)}getCachedCryptoKeyPair(e){let t=this.connectStorage.getAndDecrypt(d.OKXCONNECTOR_CRYPTO_KEY+e);return"string"==typeof t?(O.logDebug("get cached crypto key:"),O.logDebug(t),(0,m.safeJsonParse)(t)):(this.connectStorage.clearCache(),null)}saveJWTKeyPair(e){var t={publicKey:(0,b.toHexString)(e.publicKey),secretKey:(0,b.toHexString)(e.secretKey)};O.logDebug("save jwt kp");let n=(0,m.safeJsonStringify)(t);O.logDebug(n),this.connectStorage.encryptStoreMsg(n,d.OKXCONNECTOR_JWT_KEY),O.logDebug("after save jwt kp")}getCachedJWTKeyPair(){let e=this.connectStorage.getAndDecrypt(d.OKXCONNECTOR_JWT_KEY);if("string"!=typeof e)return(0,y.generateKeyPair)();{O.logDebug("get cached jwt kp:"),O.logDebug(e);let t=(0,m.safeJsonParse)(e);return O.logDebug("save jwt kp"),O.logDebug(t),{publicKey:(0,b.hexToByteArray)(t.publicKey),secretKey:(0,b.hexToByteArray)(t.secretKey)}}}isTopicPublicKeyExist(e){return O.logDebug(`isTopicPublicKeyExist  ===> ${e}`),this.sessionCryptoInfoMap.get(e)}makeJWT(e){return s(this,void 0,void 0,function*(){return yield(0,y.signJWT)(e,u.OKXCONNECTOR_JWT_WALLET_SIDE,u.OKXCONNECTOR_JWT_TTL,this.jwtKeyPair)})}parseInternalMsg(e){try{let t=(0,m.safeJsonParse)(e)["ivur-igbfft-ptjip"];if(t&&t.length>0)return(0,E.base64decode)(t,!0).toString()}catch(e){O.logError("parse internal msg",e)}}updateClientId(e,t){let n=this.sessionCryptoInfoMap.get(e);if((0,C.logDebug)("updateClientId",n,e,t),n&&t&&t.length>0){if(n.cid){let o=(0,b.getLastSixMd5Hash)(t);n.cid==o?n.dappPublicKey=t:O.logError("cid check failed",n,e,t)}else n.dappPublicKey=t;this.syncCacheSessionInfo()}return!1}parsePackage(e,t){return s(this,arguments,void 0,function*(e,t,n=!1){var o,r,i,a,c,d,u,h,f,g,p,v,b,_,y,w,N;this.events.emit(t.id,t);let S=this.sessionCryptoInfoMap.get(e);O.logDebug("get sessionInfo for decrypt topic:",e),O.logDebug("get sessionInfo for decrypt:",t.id,e,S,this.sessionCryptoInfoMap);let T=!1;if(S&&t.params.data&&(null===(o=t.params.data)||void 0===o?void 0:o.message)){if(null===(r=t.params.data)||void 0===r?void 0:r.isInternalData){let e=null===(i=t.params.data)||void 0===i?void 0:i.message,n=null===(a=t.params.data)||void 0===a?void 0:a.topic,o=this.parseInternalMsg(e);(0,C.logDebug)("parse internal origin: ",o),o&&o.length>0&&this.communicateEvents.emit("origin",o,n)}else try{let n=null===(c=t.params.data)||void 0===c?void 0:c.message;if(t.method&&t.method===l.CONNECT_METHOD_PUSH&&((0,C.logDebug)("checkExpire: update expire when get push"),this.updateExpireLimit(e)),n.trimStart().startsWith("{")){let o=this.splitManager.tryParseMessageSplitPayload(n);if(o){(0,C.logDebug)("parse split msg object: ",o),T=!0;let n={topicId:null===(u=null===(d=t.params)||void 0===d?void 0:d.data)||void 0===u?void 0:u.topic,messageId:null===(f=null===(h=t.params)||void 0===h?void 0:h.data)||void 0===f?void 0:f.messageId,messageObject:o,publishedAt:null===(p=null===(g=t.params)||void 0===g?void 0:g.data)||void 0===p?void 0:p.publishedAt},r=yield this.splitManager.onReceivedPackageCheck(n);if(r.completeMessageIdList&&r.completeMessageIdList.forEach(t=>s(this,void 0,void 0,function*(){this.refreshPackageId(),yield this.sendReceive(this.packageId.toString(),t,e)})),r.finalMessage){let t=S.crypto.decryptWallet(r.finalMessage,S.dappPublicKey);(0,C.logDebug)("<<< receive msg from split:",e,t),this.communicateEvents.emit(e,t)}}else{let t=(0,m.safeJsonParse)(n);if(t.method){if("session_info"==t.method){let n=t.params.sessionInfo,o=(0,E.base64decode)(n,!1);(0,C.logDebug)("wallet connection manager requset base64Content:",o),(0,C.logDebug)("base64Content:"+o);let r=o.toObject();this.updateClientId(e,r.clientId)}(0,C.logDebug)("<<< parse raw msg:",e,t),this.communicateEvents.emit(e,n)}}}else{let n=S.crypto.decryptWallet(null===(v=t.params.data)||void 0===v?void 0:v.message,S.dappPublicKey);(0,C.logDebug)("<<< receive msg:",e,n),this.communicateEvents.emit(e,n)}}catch(o){let n=S.crypto.decryptWallet(null===(b=t.params.data)||void 0===b?void 0:b.message,S.dappPublicKey);(0,C.logDebug)("<<< receive msg:",e,n),this.communicateEvents.emit(e,n)}}!n&&(yield this.sendACK(t.id,!0),e&&!T&&(null===(y=null===(_=t.params)||void 0===_?void 0:_.data)||void 0===y?void 0:y.messageId)&&(this.refreshPackageId(),yield this.sendReceive(this.packageId.toString(),null===(N=null===(w=t.params)||void 0===w?void 0:w.data)||void 0===N?void 0:N.messageId,e)))})}recovrySessionInfoFromCache(){let e=this.connectStorage.getAndDecrypt(f.WalletConnectionManagerTopicInfoCacheKey);if(O.logDebug("get cached sessionInfos:",e),e){let t=(0,m.safeJsonParse)(e);for(let e in t){let n=t[e];O.logDebug("make topicItem:",n);let o={topic:e,crypto:new _.SessionCrypto({publicKey:n.cryptoKeyPair.publicKey,secretKey:n.cryptoKeyPair.secretKey}),dappPublicKey:n.dappPublicKey,cid:n.cid};this.sessionCryptoInfoMap.set(e,o)}}O.logDebug("get cached sessionInfos map:",this.sessionCryptoInfoMap)}syncCacheSessionInfo(){let e={};for(let[t,n]of this.sessionCryptoInfoMap)O.logDebug("for each Keys",t),n&&(e[t]={cryptoKeyPair:n.crypto.stringifyKeypair(),dappPublicKey:n.dappPublicKey,cid:n.cid});let t=(0,m.safeJsonStringify)(e);O.logDebug("sync cache sessionInfos:",t),this.connectStorage.encryptStoreMsg(t,f.WalletConnectionManagerTopicInfoCacheKey)}cacheSessionInfo(e,t,n=!0){let o=t.dappPublicKey,r=[];for(let[e,t]of this.sessionCryptoInfoMap)O.logDebug("for each Keys",e),t.dappPublicKey==o&&(O.logDebug("duplicated dapp public key:",e,o),r.push(e));for(let[e,t]of this.sessionCryptoInfoMap)r.includes(e)&&this.sessionCryptoInfoMap.delete(e);return O.logDebug("cleaned connect session cache:",this.sessionCryptoInfoMap),this.sessionCryptoInfoMap.set(e,t),O.logDebug("cache sessionInfo:",e,t,this.sessionCryptoInfoMap),n&&this.syncCacheSessionInfo(),r}updateProtocolVersion(e,t){this.splitManager.updateTopicSenderVersion(e,t)}appendTopic(e,t,n){return s(this,void 0,void 0,function*(){return(0,C.logDebug)("4.1. get append Topic:",e),new Promise((o,r)=>s(this,void 0,void 0,function*(){if(!this.isLogined){var i=Error();i.message="connection is not logined",i.name="append error",r(i);return}let a={topic:e,crypto:new _.SessionCrypto,dappPublicKey:t||"",cid:n},s=this.cacheSessionInfo(e,a,!1);yield this.subscribeTopics(Array.from([e])),this.refreshPackageId(),O.logDebug(`5. subscribe callback then fetch append message: ${this.packageId}, ${e}`),O.reportLog("5. subscribe callback then fetch append message");let c=new Date().getTime();(0,C.logDebug)("Append --subscribe callback->",c-this.timeLog),o(s)}))})}confirmAppendingTopics(){this.syncCacheSessionInfo()}connect(){return s(this,void 0,void 0,function*(){this.timeLog=new Date().getTime(),(0,C.logDebug)("[Wallet] ConnectTime---enter->",this.timeLog),O.reportLog("wallet connect connect called");let e=Date.now().toString();var t=yield this.makeJWT(e);return O.logDebug(`generate jwt token: ${t}`),this.connectStorage.saveContent(t,"jwt"),this.recovrySessionInfoFromCache(),new Promise((e,n)=>{this.inLogin=!0,this.connector.onOpen(()=>s(this,void 0,void 0,function*(){O.logDebug("1. connector on open"),O.reportLog("1. wallet connect connect on open");let o=new Date().getTime();(0,C.logDebug)("ConnectTime---open->",o-this.timeLog),this.events.once(this.packageId.toString(),t=>s(this,void 0,void 0,function*(){if(t&&t.error){O.logError("failed when login"),yield this.connector.disconnect();var o=Error();o.message=t.error.message,o.name=t.error.code.toString(),n(o)}else this.isLogined=!0,e(),O.logDebug("3. subscribe cached topics",this.sessionCryptoInfoMap),O.reportLog("3. wallet connect connect subscribe cached topics"),this.sessionCryptoInfoMap.size>0&&(yield this.subscribeTopics(Array.from(this.sessionCryptoInfoMap.keys())))})),O.logDebug("2. login called"),O.reportLog("2. wallet connect login called"),yield this.connector.send(()=>s(this,void 0,void 0,function*(){return O.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),{id:this.packageId.toString(),jsonrpc:h.CONNECT_JSONRPC_VER,method:l.CONNECT_METHOD_LOGIN,params:{token:t}})})),this.connector.connect().catch(e=>{(0,C.logDebug)("WalletConnectionManager connect error",e),n(e)}),this.connector.addPackageParse(e=>{var t,n;if(O.logDebug("connect: parse package"),O.logDebug(e),!("params"in e)||!("data"in e.params)){this.parsePackage("",e,!0);return}(null===(t=e.params.data)||void 0===t?void 0:t.topic)&&this.parsePackage(null===(n=e.params.data)||void 0===n?void 0:n.topic,e,e.method===l.CONNECT_METHOD_RECEIVE)})})})}getSessionPublicKey(e){if(this.isTopicPublicKeyExist(e)){let t=this.sessionCryptoInfoMap.get(e);if(t)return(0,b.toHexString)(t.crypto.keyPair.publicKey)}}getCurrentCachedTopicIdList(){return Array.from(this.sessionCryptoInfoMap.keys())}sendDisconnect(e){return s(this,void 0,void 0,function*(){this.refreshPackageId();let t={id:this.packageId.toString(),jsonrpc:h.CONNECT_JSONRPC_VER,method:l.CONNECT_METHOD_DISCONNECT,params:{message:{topic:e,ttl:h.OKXCONNECTOR_MESSAGE_DISCONNECT_TTL}}};yield this.connector.send(()=>s(this,void 0,void 0,function*(){return O.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),t)})}sendRecvDisconnect(e){return s(this,void 0,void 0,function*(){this.refreshPackageId();let t={id:this.packageId.toString(),jsonrpc:h.CONNECT_JSONRPC_VER,method:l.CONNECT_METHOD_RECV_DISCONNECT,params:{topic:e}};yield this.connector.send(()=>s(this,void 0,void 0,function*(){return O.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),t)})}disconnect(){return s(this,arguments,void 0,function*(e=!1){yield this.connector.disconnect(),this.connectStorage.clearCache(d.OKXCONNECTOR_TOKEN_CACHE),e||this.connectStorage.clearCache(d.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE)})}sendRaw(e,t){return s(this,void 0,void 0,function*(){t&&(yield this.sendMsg(t,e,h.OKXCONNECTOR_MESSAGE_TTL))})}sendMsg(e,t,n){return s(this,void 0,void 0,function*(){if(t){this.refreshPackageId();let o={id:this.packageId.toString(),method:l.CONNECT_METHOD_PUBLISH,jsonrpc:h.CONNECT_JSONRPC_VER,params:{message:{topic:e,message:t,ttl:n}}};this.events.once(this.packageId.toString(),e=>s(this,void 0,void 0,function*(){e&&e.error?O.logError(`@${new Date().toUTCString()} >>> failed when send msg`):e&&!e.error&&O.logDebug(`CONNECTION @[${new Date().toUTCString()}] >>> send msg with id ${this.packageId} successed`)})),yield this.connector.send(()=>s(this,void 0,void 0,function*(){return O.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),o)}})}send(e,t){return s(this,arguments,void 0,function*(e,t,n=!1,o=h.OKXCONNECTOR_MESSAGE_TTL,r=!1){var i,a;let s;if(O.logDebug(`message send =====> ${t}`),!this.isTopicPublicKeyExist(e))throw Error("connection not finish");let c=null===(i=this.sessionCryptoInfoMap.get(e))||void 0===i?void 0:i.dappPublicKey,l=null===(a=this.sessionCryptoInfoMap.get(e))||void 0===a?void 0:a.crypto;r&&(s={message:t});let d=!1;if(l&&c&&!r&&(d=!0,s={message:l.encryptWallet(t,c)}),s){n&&l&&(s.clientId=(0,b.toHexString)(l.keyPair.publicKey));let t=(0,m.safeJsonStringify)(s);!r&&d?yield this.splitManager.sendSplitPackages(e,t,this.sendMsg.bind(this),this.sendRaw.bind(this)):yield this.sendMsg(e,t,o)}})}sendACK(e,t){return s(this,arguments,void 0,function*(e,t,n){if(!0===t){let t={id:e,jsonrpc:h.CONNECT_JSONRPC_VER,result:!0};yield this.connector.send(()=>s(this,void 0,void 0,function*(){return O.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),t)}else if(n){let t={id:e,jsonrpc:h.CONNECT_JSONRPC_VER,error:{code:n.code,message:n.message}};yield this.connector.send(()=>s(this,void 0,void 0,function*(){return O.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),t)}})}sendReceive(e,t,n){return s(this,void 0,void 0,function*(){let o={id:e,jsonrpc:h.CONNECT_JSONRPC_VER,method:l.CONNECT_METHOD_RECEIVE,params:{data:{messageId:t,topic:n}}};yield this.connector.send(()=>s(this,void 0,void 0,function*(){return O.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),o)})}sendUnsubscribe(e){return s(this,void 0,void 0,function*(){yield this.connector.send(()=>s(this,void 0,void 0,function*(){return O.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),{id:this.packageId.toString(),jsonrpc:h.CONNECT_JSONRPC_VER,method:l.CONNECT_METHOD_UNSUB,params:{topic:e}});try{yield this.sendDisconnect(e)}catch(e){O.logError("send disconnect command failed",e)}this.sessionCryptoInfoMap.delete(e),this.syncCacheSessionInfo()})}sendFetchAndConsumeMessages(e,t){return s(this,void 0,void 0,function*(){this.events.once(e,e=>s(this,void 0,void 0,function*(){var n,o;if(e.result){var r=e.result.hasMore,i=e.result.data;if(i)for(let e=0;e<i.length;e++){let n=i[e];if(n&&n.topic==t){let e=n.messageId;yield this.connector.getMsgPayloadFromHistory(n),this.refreshPackageId(),yield this.sendReceive(this.packageId.toString(),e,t)}}r&&(this.refreshPackageId(),yield this.sendFetchAndConsumeMessages(this.packageId.toString(),t))}else O.logDebug(`CONNECT: get error rsp ${null===(n=e.error)||void 0===n?void 0:n.code} : ${null===(o=e.error)||void 0===o?void 0:o.message}`)})),O.logDebug("5. send fetch more");let n=new Date().getTime();(0,C.logDebug)("ConnectTime---5->",n-this.timeLog);let o={id:e,jsonrpc:h.CONNECT_JSONRPC_VER,method:l.CONNECT_METHOD_FETCHMSG,params:{data:{topic:t}}};yield this.connector.send(()=>s(this,void 0,void 0,function*(){return O.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),o)})}sendBatchFetchAndConsumeMessages(e,t){return s(this,void 0,void 0,function*(){this.events.once(e,e=>s(this,void 0,void 0,function*(){var n,o;if(e.result){var r=e.result.hasMore,i=e.result.data;let n=e.result.disconnectedTopics;if(n)try{for(let e=0;e<n.length;e++){let t=n[e];if(t.topic){(0,C.logDebug)("send receive disconnect:",t.topic),yield this.sendRecvDisconnect(t.topic);let e=(0,m.safeJsonStringify)({requestId:t.publishedAt.toString(),method:l.CONNECT_METHOD_DISCONNECT}),n={messageId:t.publishedAt.toString(),message:(0,m.safeJsonStringify)({message:e}),topic:t.topic,publishedAt:t.publishedAt};yield this.connector.getMsgPayloadFromHistory(n)}}}catch(e){O.logError("disconnect topic fails",e)}if(i)for(let e=0;e<i.length;e++){let t=i[e];if(t&&t.topic){if(this.splitManager.tryParseMessageSplitPayload(t.message))yield this.connector.getMsgPayloadFromHistory(t);else{let n=t.messageId;yield this.connector.getMsgPayloadFromHistory(t),this.refreshPackageId(e),yield this.sendReceive(this.packageId.toString(),n,t.topic)}}}r&&(this.refreshPackageId(),yield this.sendBatchFetchAndConsumeMessages(this.packageId.toString(),t))}else O.logDebug(`CONNECT: get error rsp ${null===(n=e.error)||void 0===n?void 0:n.code} : ${null===(o=e.error)||void 0===o?void 0:o.message}`)})),O.logDebug("5. send fetch more"),O.reportLog("5. send fetch more");let n=new Date().getTime();(0,C.logDebug)("ConnectTime---5->",n-this.timeLog);let o={id:e,jsonrpc:h.CONNECT_JSONRPC_VER,method:l.CONNECT_METHOD_BATCH_FETCHMSG,params:{topics:t,withInternalData:!0}};yield this.connector.send(()=>s(this,void 0,void 0,function*(){O.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),o)})}cleanCache(){return s(this,void 0,void 0,function*(){this.connectStorage.clearCache()})}saveSessionContent(e,t){t||this.connectStorage.clearCache(d.OKXCONNECTOR_SESSION_PREFIX_KEY+e);let n=(0,m.safeJsonStringify)(t);this.connectStorage.encryptStoreMsg(n,d.OKXCONNECTOR_SESSION_PREFIX_KEY+e)}getSessionContent(e){let t=this.connectStorage.getAndDecrypt(d.OKXCONNECTOR_SESSION_PREFIX_KEY+e);if(t)return(0,m.safeJsonParse)(t)}subscribeTopics(e){return s(this,void 0,void 0,function*(){(0,C.logDebug)("4. topicid list",e),O.reportLog("4. topicid list"),this.refreshPackageId();let t=new Date().getTime();return(0,C.logDebug)("ConnectTime--subscribe callback->",t-this.timeLog),new Promise((t,n)=>s(this,void 0,void 0,function*(){let n=0;for(let o=0;o<e.length;++o){let r=e[o];this.refreshPackageId(o),this.events.once(this.packageId.toString(),i=>s(this,void 0,void 0,function*(){if(i&&i.error){O.logError("failed when subscribe"),yield this.connector.disconnect();var a=Error();a.message=i.error.message,a.name=i.error.code.toString(),(n+=1)==e.length&&t()}this.refreshPackageId(o);let s=new Date().getTime();(0,C.logDebug)("ConnectTime--subscribe callback->",s-this.timeLog),(n+=1)==e.length&&(O.logDebug(`5. send fetch msg: ${this.packageId}, ${r}`),yield this.sendBatchFetchAndConsumeMessages(this.packageId.toString(),e),yield this.splitManager.init(this.sendRaw.bind(this)),this.checkExpire(r)?((0,C.logDebug)("disconnect From topic expire"),yield this.activateDisconnect(r)):((0,C.logDebug)("extends expire check"),this.updateExpireLimit(r)),t())})),O.logDebug(`3. login callback then send subscribe: ${this.packageId}, ${r}`),O.reportLog("3. login callback then send subscribe");let i=new Date().getTime();(0,C.logDebug)("ConnectTime---login callback->",i-this.timeLog),yield this.connector.send(()=>s(this,void 0,void 0,function*(){return O.logDebug("CONNECT: reconnect before send"),yield this.connector.connect()}),{id:this.packageId.toString(),jsonrpc:h.CONNECT_JSONRPC_VER,method:l.CONNECT_METHOD_SUB,params:{topic:r}})}}))})}checkExpire(e){let t=!1;if(0==e.length)return(0,C.logDebug)("checkExpire: invalid topic"),t;let n=this.getSessionContent(d.OKXCONNECTOR_STORAGE_TOPIC_WALLET_EXPIRE_CACHE);if(n&&n.get(e)){let o=n.get(e);o?Date.now()>o&&((0,C.logDebug)("checkExpire: connection is Expired"),t=!0):((0,C.logDebug)("checkExpire: not same connection"),t=!1)}else(0,C.logDebug)("checkExpire: not topic records"),this.updateExpireLimit(e),t=!1;return t}updateExpireLimit(e){(0,C.logDebug)(`update expire limit for topic: ${e}`);let t=this.getSessionContent(d.OKXCONNECTOR_STORAGE_TOPIC_WALLET_EXPIRE_CACHE);t||(t=new Map);let n=Date.now()+h.OKXCONNECTOR_SESSION_LIVE_TTL;t.set(e,n),this.saveSessionContent(d.OKXCONNECTOR_STORAGE_TOPIC_WALLET_EXPIRE_CACHE,t)}activateDisconnect(e){return s(this,void 0,void 0,function*(){let t=(0,m.safeJsonStringify)({requestId:"",method:l.CONNECT_METHOD_DISCONNECT}),n={messageId:"",message:(0,m.safeJsonStringify)({message:t}),topic:e,publishedAt:0};yield this.connector.getMsgPayloadFromHistory(n)})}}t.WalletConnectionManager=w},40110:(e,t,n)=>{"use strict";n.d(t,{useInfiniteQuery:()=>i});var o=n(53317),r=n(64189);function i(e,t){return(0,r.t)(e,o.z,t)}},40853:(e,t,n)=>{"use strict";n.d(t,{PL:()=>r,RQ:()=>c,rB:()=>s});var o=n(40938);function r(e){return{onFetch:(t,n)=>{let r=t.options,s=t.fetchOptions?.meta?.fetchMore?.direction,c=t.state.data?.pages||[],l=t.state.data?.pageParams||[],d={pages:[],pageParams:[]},u=0,h=async()=>{let n=!1,h=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(t.signal.aborted?n=!0:t.signal.addEventListener("abort",()=>{n=!0}),t.signal)})},f=(0,o.ZM)(t.options,t.fetchOptions),g=async(e,r,i)=>{if(n)return Promise.reject();if(null==r&&e.pages.length)return Promise.resolve(e);let a={client:t.client,queryKey:t.queryKey,pageParam:r,direction:i?"backward":"forward",meta:t.options.meta};h(a);let s=await f(a),{maxPages:c}=t.options,l=i?o.ZZ:o.y9;return{pages:l(e.pages,s,c),pageParams:l(e.pageParams,r,c)}};if(s&&c.length){let e="backward"===s,t={pages:c,pageParams:l},n=(e?a:i)(r,t);d=await g(t,n,e)}else{let t=e??c.length;do{let e=0===u?l[0]??r.initialPageParam:i(r,d);if(u>0&&null==e)break;d=await g(d,e),u++}while(u<t)}return d};t.options.persister?t.fetchFn=()=>t.options.persister?.(h,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n):t.fetchFn=h}}}function i(e,{pages:t,pageParams:n}){let o=t.length-1;return t.length>0?e.getNextPageParam(t[o],t,n[o],n):void 0}function a(e,{pages:t,pageParams:n}){return t.length>0?e.getPreviousPageParam?.(t[0],t,n[0],n):void 0}function s(e,t){return!!t&&null!=i(e,t)}function c(e,t){return!!t&&!!e.getPreviousPageParam&&null!=a(e,t)}},41635:(e,t,n)=>{"use strict";n.d(t,{default:()=>r.a});var o=n(66600),r=n.n(o)},42736:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(97950),t),r(n(62418),t)},46366:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mul=Math.imul||function(e,t){var n=65535&e,o=65535&t;return n*o+((e>>>16&65535)*o+n*(t>>>16&65535)<<16>>>0)|0},t.add=function(e,t){return e+t|0},t.sub=function(e,t){return e-t|0},t.rotl=function(e,t){return e<<t|e>>>32-t},t.rotr=function(e,t){return e<<32-t|e>>>t},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.MAX_SAFE_INTEGER=0x1fffffffffffff,t.isSafeInteger=function(e){return t.isInteger(e)&&e>=-t.MAX_SAFE_INTEGER&&e<=t.MAX_SAFE_INTEGER}},46579:function(e,t,n){var o,r=n(38482).Buffer;o=function(){"use strict";var e={};function t(e){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e))throw TypeError("invalid encoding")}return e.decodeUTF8=function(e){if("string"!=typeof e)throw TypeError("expected string");var t,n=unescape(encodeURIComponent(e)),o=new Uint8Array(n.length);for(t=0;t<n.length;t++)o[t]=n.charCodeAt(t);return o},e.encodeUTF8=function(e){var t,n=[];for(t=0;t<e.length;t++)n.push(String.fromCharCode(e[t]));return decodeURIComponent(escape(n.join("")))},"undefined"==typeof atob?void 0!==r.from?(e.encodeBase64=function(e){return r.from(e).toString("base64")},e.decodeBase64=function(e){return t(e),new Uint8Array(Array.prototype.slice.call(r.from(e,"base64"),0))}):(e.encodeBase64=function(e){return new r(e).toString("base64")},e.decodeBase64=function(e){return t(e),new Uint8Array(Array.prototype.slice.call(new r(e,"base64"),0))}):(e.encodeBase64=function(e){var t,n=[],o=e.length;for(t=0;t<o;t++)n.push(String.fromCharCode(e[t]));return btoa(n.join(""))},e.decodeBase64=function(e){t(e);var n,o=atob(e),r=new Uint8Array(o.length);for(n=0;n<o.length;n++)r[n]=o.charCodeAt(n);return r}),e},e.exports?e.exports=o():(this.nacl||(this.nacl={}),this.nacl.util=o())},46674:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(89675),t),r(n(1461),t),r(n(62332),t),r(n(42736),t),r(n(68950),t)},47381:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.IEngine=t.ISignClient=t.ISignClientEvents=t.IEngineEvents=void 0;let r=o(n(22585));class i extends r.default{constructor(){super()}}t.IEngineEvents=i;class a extends r.default{constructor(){super()}}t.ISignClientEvents=a;class s{constructor(e){this.data=e}}t.ISignClient=s;class c{constructor(e){this.client=e}}t.IEngine=c},47813:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.TONProvider=void 0;let r=n(1461),i=n(62332),a=n(66352),s=n(97950);class c{constructor(){this.signalChainConnectResult=void 0,this.accountChangedTONHandler=null}send(e){return o(this,void 0,void 0,function*(){try{(0,i.logDebug)("TONProvider send request:",(0,i.safeJsonStringify)(e));let t=null;if("ton_sendTransaction"===e.method)e.params&&(t={method:"sendTransaction",params:[JSON.stringify(e.params)],id:Date.now().toString()},(0,i.logDebug)("TONProvider tonParams first:",JSON.stringify(t)));else throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED);if(t){let n=yield window.okxTonWallet.tonconnect.send(t);if((0,i.logDebug)("TONProvider send request result:",(0,i.safeJsonStringify)(n)),n.error)throw new r.OKXConnectError(n.error.code,n.error.message);return{result:n.result,method:e.method}}throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED)}catch(e){throw(0,i.logDebug)("TONProvider encountered an error:",e),e}})}connectReady(){return!0}restoreConnect(){return Promise.resolve()}parseConnectResponse(e,t,n,c,l,d){return o(this,void 0,void 0,function*(){try{let o=[];c.forEach(e=>{e.namespace===r.NameSpaceKeyTON&&o.push(...e.chains)});let u=[],h={};if(o.forEach(e=>{(0,i.getChainId)(e);let t=l.address.find(t=>"607"===t.chainId&&607===t.coinType||t.namespaceChainId===e);t&&(u.push(e+":"+t.address),h[e]={publicKey:t.publicKey})}),(0,i.logDebug)("tonprovider parseConnectResponse needPop and addresses: ",e,JSON.stringify(u)),u&&u.length>0){let o,l=c.find(e=>e.namespace===r.NameSpaceKeyTON);if((0,i.logDebug)("tonprovider parseConnectResponse ton: ",JSON.stringify(l)),l&&l.params&&d&&d.manifestUrl){this.dappInfo=d;let n=[l.params.ton_addr],r={manifestUrl:d.manifestUrl,items:n};(e||t)&&l.params.ton_proof&&n.push(l.params.ton_proof),(0,i.logDebug)("parseConnectResponse ton connect params: ",JSON.stringify(r)),o=(0,a.isDevice)("mobile")?yield window.okxTonWallet.tonconnect.connect(2,r):e||t?yield window.okxTonWallet.tonconnect.connect(2,r):yield window.okxTonWallet.tonconnect.restoreConnection()}else throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"manifestUrl is nil");if(n&&this.signalChainConnectResult&&(o=this.signalChainConnectResult,this.signalChainConnectResult=void 0),(0,i.logDebug)("parseConnectResponse ton connect result: ",JSON.stringify(o)),o&&l){if("connect_error"===o.event)throw new r.OKXConnectError(o.payload.code,o.payload.message);{let e=o.payload.items.find(e=>"ton_addr"===e.name),t=o.payload.items.find(e=>"ton_proof"===e.name);return(0,i.logDebug)("tonprovider connect isSignalChain: ",n),{namespace:r.NameSpaceKeyTON,addresses:u,methods:[...s.TONMethods],extra:h,data:{ton_addr:e,ton_proof:t,manifestUrl:d.manifestUrl}}}}}return}catch(e){throw(0,i.logDebug)("tonprovider parseConnectResponse error: ",JSON.stringify(e)),e}})}connect(e,t){return o(this,void 0,void 0,function*(){if(e&&t&&t.manifestUrl&&e.params){this.dappInfo=t;let n=[e.params.ton_addr],o={manifestUrl:t.manifestUrl,items:n};e.params.ton_proof&&n.push(e.params.ton_proof),(0,i.logDebug)("tonprovider connect params: ",JSON.stringify(o));try{let e=yield window.okxTonWallet.tonconnect.connect(2,o);return(0,i.logDebug)("tonprovider connect tonResult: ",JSON.stringify(e)),this.signalChainConnectResult=e,e}catch(e){throw(0,i.logDebug)("tonprovider connect error: ",JSON.stringify(e)),new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"tonconnect error")}}else throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"manifestUrl or params is nil")})}singleConnect(e,t){return this.connect(e,t)}addListener(e){console.log("window.okxwallet configEventWithKey:","ton"),this.accountChangedTONHandler=()=>{console.log("window.okxwallet configEventWithKey_TON:",Date.now(),"ton"),e()},window.okxTonWallet.tonconnect.on("accountChanged",this.accountChangedTONHandler)}removeListener(){this.accountChangedTONHandler&&window.okxTonWallet.tonconnect.off("accountChanged",this.accountChangedTONHandler)}}t.TONProvider=c},49865:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NAMES_CHAINS=t.TON_CHAINS=t.COSMOS_CHAINS=t.APTOS_CHAINS=t.SUI_CHAINS=t.SOLANA_CHAINS=t.BTC_CHAINS=void 0;let o=n(67679);t.BTC_CHAINS={MAINNET:"btc:mainnet",FRACTAL:"fractal:mainnet"},t.SOLANA_CHAINS={MAINNET:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",TESTNET:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",SONIC_TESTNET:"sonic:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"},t.SUI_CHAINS={MAINNET:"sui:mainnet"},t.APTOS_CHAINS={MAINNET:"aptos:mainnet",MOVEMENT_MAINNET:"movement:mainnet",MOVEMENT_TESTNET:"movement:testnet"},t.COSMOS_CHAINS={COSMOS_MAINNET:"cosmos:cosmoshub-4"},t.TON_CHAINS={MAINNET:"ton:-239"},t.NAMES_CHAINS={[o.NameSpaceKeyBtc]:Object.values(t.BTC_CHAINS),[o.NameSpaceKeySOL]:Object.values(t.SOLANA_CHAINS),[o.NameSpaceKeyTON]:Object.values(t.TON_CHAINS),[o.NameSpaceKeySui]:Object.values(t.SUI_CHAINS),[o.NameSpaceKeyAptos]:Object.values(t.APTOS_CHAINS),[o.NameSpaceKeyCosmos]:Object.values(t.COSMOS_CHAINS)}},51754:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CONNECT_ITEM_ERROR_CODES=t.TONCHAIN=void 0;var o=n(81478);Object.defineProperty(t,"TONCHAIN",{enumerable:!0,get:function(){return o.TONCHAIN}});var r=n(86761);Object.defineProperty(t,"CONNECT_ITEM_ERROR_CODES",{enumerable:!0,get:function(){return r.CONNECT_ITEM_ERROR_CODES}})},51766:function(e,t,n){"use strict";var o,r=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(o=function(e){return(o=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t})(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=o(e),a=0;a<n.length;a++)"default"!==n[a]&&r(t,e,n[a]);return i(t,e),t}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Storage=void 0;let c=n(83151),l=s(n(87124)),d=n(11769),u=n(62332),h=a(n(33394)),f=n(62332),g=n(15563);class p{constructor(e,t){let n=(0,d.resolveLocalStorage)();this.storeKey="",this.cipherIV="",this.subKey=e,h.logDebug("--------get current local storage --------"),h.logDebug(n),this.synchronizedCache()}checkAndUpgradeCache(e,t){if(e&&e.length>0&&t&&t.length>0){h.logDebug("--------get current local storage --------"),h.logDebug(localStorage);let n=localStorage.getItem(p.cacheKey+e);if(null==n){h.logDebug("no pre cache content");return}h.logDebug(n),(null==n?void 0:n.length)>0&&(h.logDebug("write in cache content: ",e,"->",t),localStorage.setItem(p.cacheKey+t,n),h.logDebug("clean in cache content: ",e),localStorage.removeItem(p.cacheKey+e))}else h.logDebug("no pre cache key:",e)}saveContent(e,t,n="-"){let o={id:n,timestamp:Date.now().toString(),content:e};this.saveItem(o,t)}saveItem(e,t){let n=p.cacheKey+this.subKey,o=(0,d.resolveLocalStorage)();h.logDebug(this.cache),h.logDebug(`get cache obj: ${this.cache}, ${t}, ${e}`),this.cache[t]=e;let r=(0,u.safeJsonStringify)(this.cache);h.logDebug(`STORAGE: ${t} @ ${this.cache}`),o.setItem(n,r)}getItem(e){return h.logDebug(`STORAGE >> getItem: ${e} @ ${this.cache}`),this.cache[e]}synchronizedCache(){let e=localStorage.getItem(p.cacheKey+this.subKey);if(null==e){h.logDebug("with no cache"),this.cache={};return}if(h.logDebug(e),(null==e?void 0:e.length)>0){var t=(0,u.safeJsonParse)(e);this.cache=t}h.logDebug(`get cache obj: ${this.cache}`),(void 0===this.cache||null==this.cache)&&(this.cache={})}getCachedPBKDF2InfoKey(){var e,t,n,o;if(this.storeKey.length>0&&(null===(e=this.cipherIV)||void 0===e?void 0:e.length)>0)return{pw:this.storeKey,iv:this.cipherIV};let r=null===(t=this.getItem(c.OKXCONNECTOR_STORAGER_CRYPTO_SALT))||void 0===t?void 0:t.content;r||(r=(0,d.toHexString)(l.default.randomBytes(24)),this.saveContent(r,c.OKXCONNECTOR_STORAGER_CRYPTO_SALT));let i=null===(n=this.getItem(c.OKXCONNECTOR_STORAGE_CRYPTO_PASSWORD))||void 0===n?void 0:n.content;i||(i=(0,d.toHexString)(l.default.randomBytes(32)),this.saveContent(i,c.OKXCONNECTOR_STORAGE_CRYPTO_PASSWORD));let a=null===(o=this.getItem(c.OKXCONNECTOR_STORAGE_CRYPTO_CIPHERIV))||void 0===o?void 0:o.content;if(!a){let e=l.default.randomBytes(16);a=(0,d.toHexString)(e),this.saveContent(a,c.OKXCONNECTOR_STORAGE_CRYPTO_CIPHERIV)}return this.cipherIV=a,this.storeKey=(0,g.PBKDF2)(i,r,{iterations:10}).toString(),{pw:this.storeKey,iv:this.cipherIV}}encryptStoreMsg(e,t){(0,f.logDebug)(`encryptStoreMsg  encryptStoreMsg start ${Date.now()}`);let n=this.getCachedPBKDF2InfoKey();(0,f.logDebug)(`encryptStoreMsg  encryptStoreMsg mid ${Date.now()}`);var o=g.AES.encrypt(e,n.pw).toString();this.saveContent(o,t),(0,f.logDebug)(`encryptStoreMsg  encryptStoreMsg end ${Date.now()}`)}getAndDecrypt(e){(0,f.logDebug)(`encryptStoreMsg  getAndDecrypt start ${Date.now()}`);let t=this.getItem(e);if(t&&t.content){let e=this.getCachedPBKDF2InfoKey();(0,f.logDebug)(`encryptStoreMsg  getAndDecrypt mid ${Date.now()}`);let n=g.AES.decrypt(t.content,e.pw).toString(g.enc.Utf8);return(0,f.logDebug)(`encryptStoreMsg  getAndDecrypt end ${Date.now()}`),n}return null}clearCache(e){if(void 0===e){let e=(0,d.resolveLocalStorage)();this.cache={};let t=p.cacheKey+this.subKey;e.setItem(t,"")}else{let t=p.cacheKey+this.subKey,n=(0,d.resolveLocalStorage)();h.logDebug(this.cache),this.cache[e]=null;let o=(0,u.safeJsonStringify)(this.cache);h.logDebug(`STORAGE: clean key ${e} @ ${this.cache}`),n.setItem(t,o)}}}t.Storage=p,p.cacheKey="OKXStorageKey"},51945:function(e,t,n){var o;!function(r,i){"use strict";var a="function",s="undefined",c="object",l="string",d="major",u="model",h="name",f="type",g="vendor",p="version",v="architecture",b="console",_="mobile",y="tablet",m="smarttv",O="wearable",C="embedded",E="Amazon",w="Apple",N="ASUS",S="BlackBerry",T="Browser",R="Chrome",D="Firefox",I="Google",P="Huawei",k="Microsoft",K="Motorola",A="Opera",x="Samsung",L="Sharp",M="Sony",j="Xiaomi",U="Zebra",W="Facebook",X="Chromium OS",H="Mac OS",B=" Browser",J=function(e,t){var n={};for(var o in e)t[o]&&t[o].length%2==0?n[o]=t[o].concat(e[o]):n[o]=e[o];return n},q=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},$=function(e,t){return typeof e===l&&-1!==F(t).indexOf(F(e))},F=function(e){return e.toLowerCase()},V=function(e,t){if(typeof e===l)return e=e.replace(/^\s\s*/,""),typeof t===s?e:e.substring(0,500)},G=function(e,t){for(var n,o,r,s,l,d,u=0;u<t.length&&!l;){var h=t[u],f=t[u+1];for(n=o=0;n<h.length&&!l&&h[n];)if(l=h[n++].exec(e))for(r=0;r<f.length;r++)d=l[++o],typeof(s=f[r])===c&&s.length>0?2===s.length?typeof s[1]==a?this[s[0]]=s[1].call(this,d):this[s[0]]=s[1]:3===s.length?typeof s[1]!==a||s[1].exec&&s[1].test?this[s[0]]=d?d.replace(s[1],s[2]):void 0:this[s[0]]=d?s[1].call(this,d,s[2]):void 0:4===s.length&&(this[s[0]]=d?s[3].call(this,d.replace(s[1],s[2])):i):this[s]=d||i;u+=2}},z=function(e,t){for(var n in t)if(typeof t[n]===c&&t[n].length>0){for(var o=0;o<t[n].length;o++)if($(t[n][o],e))return"?"===n?i:n}else if($(t[n],e))return"?"===n?i:n;return t.hasOwnProperty("*")?t["*"]:e},Y={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Q={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[p,[h,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[p,[h,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[h,p],[/opios[\/ ]+([\w\.]+)/i],[p,[h,A+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[p,[h,A+" GX"]],[/\bopr\/([\w\.]+)/i],[p,[h,A]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[p,[h,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[p,[h,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[h,p],[/quark(?:pc)?\/([-\w\.]+)/i],[p,[h,"Quark"]],[/\bddg\/([\w\.]+)/i],[p,[h,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[p,[h,"UC"+T]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[p,[h,"WeChat"]],[/konqueror\/([\w\.]+)/i],[p,[h,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[p,[h,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[p,[h,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[p,[h,"Smart Lenovo "+T]],[/(avast|avg)\/([\w\.]+)/i],[[h,/(.+)/,"$1 Secure "+T],p],[/\bfocus\/([\w\.]+)/i],[p,[h,D+" Focus"]],[/\bopt\/([\w\.]+)/i],[p,[h,A+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[p,[h,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[p,[h,"Dolphin"]],[/coast\/([\w\.]+)/i],[p,[h,A+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[p,[h,"MIUI"+B]],[/fxios\/([\w\.-]+)/i],[p,[h,D]],[/\bqihoobrowser\/?([\w\.]*)/i],[p,[h,"360"]],[/\b(qq)\/([\w\.]+)/i],[[h,/(.+)/,"$1Browser"],p],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[h,/(.+)/,"$1"+B],p],[/samsungbrowser\/([\w\.]+)/i],[p,[h,x+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[p,[h,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[h,"Sogou Mobile"],p],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[h,p],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[h],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[p,h],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[h,W],p],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[h,p],[/\bgsa\/([\w\.]+) .*safari\//i],[p,[h,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[p,[h,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[p,[h,R+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[h,R+" WebView"],p],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[p,[h,"Android "+T]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[h,p],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[p,[h,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[p,h],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[h,[p,z,{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[h,p],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[h,"Netscape"],p],[/(wolvic|librewolf)\/([\w\.]+)/i],[h,p],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[p,[h,D+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[h,[p,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[h,[p,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[v,"amd64"]],[/(ia32(?=;))/i],[[v,F]],[/((?:i[346]|x)86)[;\)]/i],[[v,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[v,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[v,"armhf"]],[/windows (ce|mobile); ppc;/i],[[v,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[v,/ower/,"",F]],[/(sun4\w)[;\)]/i],[[v,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[v,F]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[u,[g,x],[f,y]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[u,[g,x],[f,_]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[u,[g,w],[f,_]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[u,[g,w],[f,y]],[/(macintosh);/i],[u,[g,w]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[u,[g,L],[f,_]],[/(?:honor)([-\w ]+)[;\)]/i],[u,[g,"Honor"],[f,_]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[u,[g,P],[f,y]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[u,[g,P],[f,_]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[u,/_/g," "],[g,j],[f,_]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[u,/_/g," "],[g,j],[f,y]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[u,[g,"OPPO"],[f,_]],[/\b(opd2\d{3}a?) bui/i],[u,[g,"OPPO"],[f,y]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[u,[g,"Vivo"],[f,_]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[u,[g,"Realme"],[f,_]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[u,[g,K],[f,_]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[u,[g,K],[f,y]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[u,[g,"LG"],[f,y]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[u,[g,"LG"],[f,_]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[u,[g,"Lenovo"],[f,y]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[u,/_/g," "],[g,"Nokia"],[f,_]],[/(pixel c)\b/i],[u,[g,I],[f,y]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[u,[g,I],[f,_]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[u,[g,M],[f,_]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[u,"Xperia Tablet"],[g,M],[f,y]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[u,[g,"OnePlus"],[f,_]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[u,[g,E],[f,y]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[u,/(.+)/g,"Fire Phone $1"],[g,E],[f,_]],[/(playbook);[-\w\),; ]+(rim)/i],[u,g,[f,y]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[u,[g,S],[f,_]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[u,[g,N],[f,y]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[u,[g,N],[f,_]],[/(nexus 9)/i],[u,[g,"HTC"],[f,y]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[g,[u,/_/g," "],[f,_]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[u,[g,"TCL"],[f,y]],[/(itel) ((\w+))/i],[[g,F],u,[f,z,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[u,[g,"Acer"],[f,y]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[u,[g,"Meizu"],[f,_]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[u,[g,"Ulefone"],[f,_]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[u,[g,"Energizer"],[f,_]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[u,[g,"Cat"],[f,_]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[u,[g,"Smartfren"],[f,_]],[/droid.+; (a(?:015|06[35]|142p?))/i],[u,[g,"Nothing"],[f,_]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (imo) ((?!tab)[\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[g,u,[f,_]],[/(imo) (tab \w+)/i,/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[g,u,[f,y]],[/(surface duo)/i],[u,[g,k],[f,y]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[u,[g,"Fairphone"],[f,_]],[/(u304aa)/i],[u,[g,"AT&T"],[f,_]],[/\bsie-(\w*)/i],[u,[g,"Siemens"],[f,_]],[/\b(rct\w+) b/i],[u,[g,"RCA"],[f,y]],[/\b(venue[\d ]{2,7}) b/i],[u,[g,"Dell"],[f,y]],[/\b(q(?:mv|ta)\w+) b/i],[u,[g,"Verizon"],[f,y]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[u,[g,"Barnes & Noble"],[f,y]],[/\b(tm\d{3}\w+) b/i],[u,[g,"NuVision"],[f,y]],[/\b(k88) b/i],[u,[g,"ZTE"],[f,y]],[/\b(nx\d{3}j) b/i],[u,[g,"ZTE"],[f,_]],[/\b(gen\d{3}) b.+49h/i],[u,[g,"Swiss"],[f,_]],[/\b(zur\d{3}) b/i],[u,[g,"Swiss"],[f,y]],[/\b((zeki)?tb.*\b) b/i],[u,[g,"Zeki"],[f,y]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[g,"Dragon Touch"],u,[f,y]],[/\b(ns-?\w{0,9}) b/i],[u,[g,"Insignia"],[f,y]],[/\b((nxa|next)-?\w{0,9}) b/i],[u,[g,"NextBook"],[f,y]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[g,"Voice"],u,[f,_]],[/\b(lvtel\-)?(v1[12]) b/i],[[g,"LvTel"],u,[f,_]],[/\b(ph-1) /i],[u,[g,"Essential"],[f,_]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[u,[g,"Envizen"],[f,y]],[/\b(trio[-\w\. ]+) b/i],[u,[g,"MachSpeed"],[f,y]],[/\btu_(1491) b/i],[u,[g,"Rotor"],[f,y]],[/(shield[\w ]+) b/i],[u,[g,"Nvidia"],[f,y]],[/(sprint) (\w+)/i],[g,u,[f,_]],[/(kin\.[onetw]{3})/i],[[u,/\./g," "],[g,k],[f,_]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[u,[g,U],[f,y]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[u,[g,U],[f,_]],[/smart-tv.+(samsung)/i],[g,[f,m]],[/hbbtv.+maple;(\d+)/i],[[u,/^/,"SmartTV"],[g,x],[f,m]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[g,"LG"],[f,m]],[/(apple) ?tv/i],[g,[u,w+" TV"],[f,m]],[/crkey/i],[[u,R+"cast"],[g,I],[f,m]],[/droid.+aft(\w+)( bui|\))/i],[u,[g,E],[f,m]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[u,[g,L],[f,m]],[/(bravia[\w ]+)( bui|\))/i],[u,[g,M],[f,m]],[/(mitv-\w{5}) bui/i],[u,[g,j],[f,m]],[/Hbbtv.*(technisat) (.*);/i],[g,u,[f,m]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[g,V],[u,V],[f,m]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[f,m]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[g,u,[f,b]],[/droid.+; (shield) bui/i],[u,[g,"Nvidia"],[f,b]],[/(playstation [345portablevi]+)/i],[u,[g,M],[f,b]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[u,[g,k],[f,b]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[u,[g,x],[f,O]],[/((pebble))app/i],[g,u,[f,O]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[u,[g,w],[f,O]],[/droid.+; (glass) \d/i],[u,[g,I],[f,O]],[/droid.+; (wt63?0{2,3})\)/i],[u,[g,U],[f,O]],[/droid.+; (glass) \d/i],[u,[g,I],[f,O]],[/(pico) (4|neo3(?: link|pro)?)/i],[g,u,[f,O]],[/; (quest( \d| pro)?)/i],[u,[g,W],[f,O]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[g,[f,C]],[/(aeobc)\b/i],[u,[g,E],[f,C]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[u,[f,_]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[u,[f,y]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[f,y]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[f,_]],[/(android[-\w\. ]{0,9});.+buil/i],[u,[g,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[p,[h,"EdgeHTML"]],[/(arkweb)\/([\w\.]+)/i],[h,p],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[p,[h,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[h,p],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[p,h]],os:[[/microsoft (windows) (vista|xp)/i],[h,p],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[h,[p,z,Y]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[p,z,Y],[h,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[p,/_/g,"."],[h,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[h,H],[p,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[p,h],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish|openharmony)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[h,p],[/\(bb(10);/i],[p,[h,S]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[p,[h,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[p,[h,D+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[p,[h,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[p,[h,"watchOS"]],[/crkey\/([\d\.]+)/i],[p,[h,R+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[h,X],p],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[h,p],[/(sunos) ?([\w\.\d]*)/i],[[h,"Solaris"],p],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[h,p]]},Z=function(e,t){if(typeof e===c&&(t=e,e=i),!(this instanceof Z))return new Z(e,t).getResult();var n=typeof r!==s&&r.navigator?r.navigator:i,o=e||(n&&n.userAgent?n.userAgent:""),b=n&&n.userAgentData?n.userAgentData:i,m=t?J(Q,t):Q,O=n&&n.userAgent==o;return this.getBrowser=function(){var e,t={};return t[h]=i,t[p]=i,G.call(t,o,m.browser),t[d]=typeof(e=t[p])===l?e.replace(/[^\d\.]/g,"").split(".")[0]:i,O&&n&&n.brave&&typeof n.brave.isBrave==a&&(t[h]="Brave"),t},this.getCPU=function(){var e={};return e[v]=i,G.call(e,o,m.cpu),e},this.getDevice=function(){var e={};return e[g]=i,e[u]=i,e[f]=i,G.call(e,o,m.device),O&&!e[f]&&b&&b.mobile&&(e[f]=_),O&&"Macintosh"==e[u]&&n&&typeof n.standalone!==s&&n.maxTouchPoints&&n.maxTouchPoints>2&&(e[u]="iPad",e[f]=y),e},this.getEngine=function(){var e={};return e[h]=i,e[p]=i,G.call(e,o,m.engine),e},this.getOS=function(){var e={};return e[h]=i,e[p]=i,G.call(e,o,m.os),O&&!e[h]&&b&&b.platform&&"Unknown"!=b.platform&&(e[h]=b.platform.replace(/chrome os/i,X).replace(/macos/i,H)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return o},this.setUA=function(e){return o=typeof e===l&&e.length>500?V(e,500):e,this},this.setUA(o),this};Z.VERSION="1.0.40",Z.BROWSER=q([h,p,d]),Z.CPU=q([v]),Z.DEVICE=q([u,g,f,b,_,m,y,O,C]),Z.ENGINE=Z.OS=q([h,p]),typeof t!==s?(e.exports&&(t=e.exports=Z),t.UAParser=Z):n.amdO?i!==(o=(function(){return Z}).call(t,n,t,e))&&(e.exports=o):typeof r!==s&&(r.UAParser=Z);var ee=typeof r!==s&&(r.jQuery||r.Zepto);if(ee&&!ee.ua){var et=new Z;ee.ua=et.getResult(),ee.ua.get=function(){return et.getUA()},ee.ua.set=function(e){et.setUA(e);var t=et.getResult();for(var n in t)ee.ua[n]=t[n]}}}("object"==typeof window?window:this)},52741:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.OkxwalletInjectTonsdkConnector=void 0;let r=n(88193),i=n(1461),a=n(62332),s=n(66352);class c extends r.InjectConnector{constructor(){super(),this.walletName="OKX Wallet extension",this.walletNameKey="walletModal.mobileConnectionModal.connectInjected"}checkWalletMatch(){return o(this,void 0,void 0,function*(){var e,t,n;let o;null===(e=this.connectionManager)||void 0===e||e.tonsdkConnectStorage.synchronizedCache();let r=null===(t=this.connectionManager)||void 0===t?void 0:t.tonsdkConnectStorage.getItem("ton_connect_info_adapter_universal");if(!r||!(null==r?void 0:r.content))throw new i.OKXConnectError(i.OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR);let c=JSON.parse(null==r?void 0:r.content),l=c.connectEvent.payload.items.find(e=>"name"in e&&"ton_addr"===e.name);if(this.dappInfo=c.dappInfo,l&&"address"in l&&(o=l.address),!o)throw new i.OKXConnectError(i.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED);if((0,a.logDebug)(`inject-connector localTonaddress : ${o}`),(0,s.isDevice)("mobile")){let e;e={namespace:i.NameSpaceKeyTON,chains:[i.TON_CHAINS.MAINNET],params:{ton_addr:{name:"ton_addr"}}};let t=yield this.getAccountByRequestWallets(!1,!1,!1,[e],[]);if(t&&1==t.length){let e=null===(n=t[0].data)||void 0===n?void 0:n.ton_addr;if(o===(null==e?void 0:e.address))return}}else{let e=yield window.okxTonWallet.tonconnect.restoreConnection();if("connect"===e.event&&e.payload.items.find(e=>"ton_addr"===e.name).address==o)return}throw new i.OKXConnectError(i.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED)})}}t.OkxwalletInjectTonsdkConnector=c},53317:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});var o=n(20993),r=n(40853),i=class extends o.${constructor(e,t){super(e,t)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(e,t){super.setOptions({...e,behavior:(0,r.PL)()},t)}getOptimisticResult(e){return e.behavior=(0,r.PL)(),super.getOptimisticResult(e)}fetchNextPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"backward"}}})}createResult(e,t){let{state:n}=e,o=super.createResult(e,t),{isFetching:i,isRefetching:a,isError:s,isRefetchError:c}=o,l=n.fetchMeta?.fetchMore?.direction,d=s&&"forward"===l,u=i&&"forward"===l,h=s&&"backward"===l,f=i&&"backward"===l;return{...o,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:(0,r.rB)(t,n.data),hasPreviousPage:(0,r.RQ)(t,n.data),isFetchNextPageError:d,isFetchingNextPage:u,isFetchPreviousPageError:h,isFetchingPreviousPage:f,isRefetchError:c&&!d&&!h,isRefetching:a&&!u&&!f}}}},54479:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;let o=n(19019),r=n(86271),i=n(94306);function a(e,n=t.defaultRandomSource){return n.randomBytes(e)}t.defaultRandomSource=new o.SystemRandomSource,t.randomBytes=a,t.randomUint32=function(e=t.defaultRandomSource){let n=a(4,e),o=(0,r.readUint32LE)(n);return(0,i.wipe)(n),o};let s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(e,n=s,o=t.defaultRandomSource){if(n.length<2)throw Error("randomString charset is too short");if(n.length>256)throw Error("randomString charset is too long");let r="",l=n.length,d=256-256%l;for(;e>0;){let t=a(Math.ceil(256*e/d),o);for(let o=0;o<t.length&&e>0;o++){let i=t[o];i<d&&(r+=n.charAt(i%l),e--)}(0,i.wipe)(t)}return r}t.randomString=c,t.randomStringForEntropy=function(e,n=s,o=t.defaultRandomSource){return c(Math.ceil(e/(Math.log(n.length)/Math.LN2)),n,o)}},61125:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeRandomSource=void 0;let o=n(94306);class r{constructor(){this.isAvailable=!1,this.isInstantiated=!1;{let e=n(69147);e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw Error("NodeRandomSource: got fewer bytes than requested");let n=new Uint8Array(e);for(let e=0;e<n.length;e++)n[e]=t[e];return(0,o.wipe)(t),n}}t.NodeRandomSource=r},62332:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.getNamespaceKeyByChain=t.chainName2IdMap=t.replaceChainIdToChainName=t.replaceChainNameToChainId=t.checkMetaData=t.versionCompare=t.isBrowser=t.isOS=t.isMobileUserAgent=t.openDeeplinkWithFallback=t.openLinkBlank=t.openLink=t.getChainId=t.useShortLink=t.toSafeBase64FromBase64=t.isValidObject=t.isIos=t.base64decode=t.base64encode=t.splitToUint8Arrays=t.concatUint8Arrays=t.toHexString=t.hexToByteArray=t.getOKXLink=t.getAppWalletShortDeepLink=t.encodeTWAConnectURLParams=t.encodeConnectParams=t.openOKXTMAWalletlinkWithFallback=t.getTelegramWalletTWAUrl=t.getAppWalletDeepLink=t.encodeTelegramUrlParameters=t.isTelegramUrl=t.openOKXDeeplinkWithFallback=t.openOKXDeeplink=t.getUniversalLink=t.safeJsonStringify=t.safeJsonParse=t.getDefaultReporter=t.reportEvent=t.reportLog=t.logWarning=t.logError=t.logDebug=t.callForSuccess=void 0;var i=n(2476);Object.defineProperty(t,"callForSuccess",{enumerable:!0,get:function(){return i.callForSuccess}});var a=n(33394);Object.defineProperty(t,"logDebug",{enumerable:!0,get:function(){return a.logDebug}}),Object.defineProperty(t,"logError",{enumerable:!0,get:function(){return a.logError}}),Object.defineProperty(t,"logWarning",{enumerable:!0,get:function(){return a.logWarning}}),Object.defineProperty(t,"reportLog",{enumerable:!0,get:function(){return a.reportLog}}),Object.defineProperty(t,"reportEvent",{enumerable:!0,get:function(){return a.reportEvent}}),Object.defineProperty(t,"getDefaultReporter",{enumerable:!0,get:function(){return a.getDefaultReporter}}),r(n(36003),t),r(n(17322),t);var s=n(82091);Object.defineProperty(t,"safeJsonParse",{enumerable:!0,get:function(){return s.safeJsonParse}}),Object.defineProperty(t,"safeJsonStringify",{enumerable:!0,get:function(){return s.safeJsonStringify}});var c=n(29477);Object.defineProperty(t,"getUniversalLink",{enumerable:!0,get:function(){return c.getUniversalLink}}),Object.defineProperty(t,"openOKXDeeplink",{enumerable:!0,get:function(){return c.openOKXDeeplink}}),Object.defineProperty(t,"openOKXDeeplinkWithFallback",{enumerable:!0,get:function(){return c.openOKXDeeplinkWithFallback}}),Object.defineProperty(t,"isTelegramUrl",{enumerable:!0,get:function(){return c.isTelegramUrl}}),Object.defineProperty(t,"encodeTelegramUrlParameters",{enumerable:!0,get:function(){return c.encodeTelegramUrlParameters}}),Object.defineProperty(t,"getAppWalletDeepLink",{enumerable:!0,get:function(){return c.getAppWalletDeepLink}}),Object.defineProperty(t,"getTelegramWalletTWAUrl",{enumerable:!0,get:function(){return c.getTelegramWalletTWAUrl}}),Object.defineProperty(t,"openOKXTMAWalletlinkWithFallback",{enumerable:!0,get:function(){return c.openOKXTMAWalletlinkWithFallback}}),Object.defineProperty(t,"encodeConnectParams",{enumerable:!0,get:function(){return c.encodeConnectParams}}),Object.defineProperty(t,"encodeTWAConnectURLParams",{enumerable:!0,get:function(){return c.encodeTWAConnectURLParams}}),Object.defineProperty(t,"getAppWalletShortDeepLink",{enumerable:!0,get:function(){return c.getAppWalletShortDeepLink}}),Object.defineProperty(t,"getOKXLink",{enumerable:!0,get:function(){return c.getOKXLink}});var l=n(11769);Object.defineProperty(t,"hexToByteArray",{enumerable:!0,get:function(){return l.hexToByteArray}}),Object.defineProperty(t,"toHexString",{enumerable:!0,get:function(){return l.toHexString}}),Object.defineProperty(t,"concatUint8Arrays",{enumerable:!0,get:function(){return l.concatUint8Arrays}}),Object.defineProperty(t,"splitToUint8Arrays",{enumerable:!0,get:function(){return l.splitToUint8Arrays}}),Object.defineProperty(t,"base64encode",{enumerable:!0,get:function(){return l.base64encode}}),Object.defineProperty(t,"base64decode",{enumerable:!0,get:function(){return l.base64decode}}),Object.defineProperty(t,"isIos",{enumerable:!0,get:function(){return l.isIos}}),Object.defineProperty(t,"isValidObject",{enumerable:!0,get:function(){return l.isValidObject}}),Object.defineProperty(t,"toSafeBase64FromBase64",{enumerable:!0,get:function(){return l.toSafeBase64FromBase64}}),Object.defineProperty(t,"useShortLink",{enumerable:!0,get:function(){return l.useShortLink}}),Object.defineProperty(t,"getChainId",{enumerable:!0,get:function(){return l.getChainId}});var d=n(9423);Object.defineProperty(t,"openLink",{enumerable:!0,get:function(){return d.openLink}}),Object.defineProperty(t,"openLinkBlank",{enumerable:!0,get:function(){return d.openLinkBlank}}),Object.defineProperty(t,"openDeeplinkWithFallback",{enumerable:!0,get:function(){return d.openDeeplinkWithFallback}}),Object.defineProperty(t,"isMobileUserAgent",{enumerable:!0,get:function(){return d.isMobileUserAgent}}),Object.defineProperty(t,"isOS",{enumerable:!0,get:function(){return d.isOS}}),Object.defineProperty(t,"isBrowser",{enumerable:!0,get:function(){return d.isBrowser}});var u=n(19903);Object.defineProperty(t,"versionCompare",{enumerable:!0,get:function(){return u.versionCompare}});var h=n(10737);Object.defineProperty(t,"checkMetaData",{enumerable:!0,get:function(){return h.checkMetaData}});var f=n(11769);Object.defineProperty(t,"replaceChainNameToChainId",{enumerable:!0,get:function(){return f.replaceChainNameToChainId}}),Object.defineProperty(t,"replaceChainIdToChainName",{enumerable:!0,get:function(){return f.replaceChainIdToChainName}}),Object.defineProperty(t,"chainName2IdMap",{enumerable:!0,get:function(){return f.chainName2IdMap}}),Object.defineProperty(t,"getNamespaceKeyByChain",{enumerable:!0,get:function(){return f.getNamespaceKeyByChain}})},62418:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(87096),t)},63172:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};function r(e){return"object"==typeof e&&"id"in e&&"jsonrpc"in e&&"2.0"===e.jsonrpc}function i(e){return"result"in e}function a(e){return"error"in e}Object.defineProperty(t,"__esModule",{value:!0}),t.isJsonRpcPayload=r,t.isJsonRpcRequest=function(e){return r(e)&&"method"in e},t.isJsonRpcResponse=function(e){return r(e)&&(i(e)||a(e))},t.isJsonRpcResult=i,t.isJsonRpcError=a,t.payloadId=h,t.getBigIntRpcId=function(){return BigInt(Date.now())*BigInt(1e6)+BigInt(u.getNextValue())},t.formatJsonRpcRequest=function(e,t,n){return{id:n||h(),jsonrpc:"2.0",method:e,params:t}},t.formatJsonRpcResult=function(e,t){return{id:e,jsonrpc:"2.0",result:t}},t.formatJsonRpcError=function(e,t,n){return{id:e,jsonrpc:"2.0",error:v(t,n)}},t.isReservedErrorCode=f,t.getError=g,t.getErrorByCode=p,t.formatErrorMessage=v,t.isHttpUrl=function(e){return b(e,"^https?:")},t.isWsUrl=function(e){return b(e,"^wss?:")},t.parseConnectionError=function(e,t,n){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?Error(`Unavailable ${n} RPC url at ${t}`):e};let s=n(36893),c=o(n(87124));class l{constructor(e){this.i=1,8===e?new Uint8Array(1):16===e?new Uint16Array(1):new Uint32Array(1),e?this.initialValue=c.default.randomBytes(e/8)[0]:this.initialValue=0}getNextValue(){return this.initialValue+this.i++}}let d=new l(8),u=new l(16);function h(){return 1e3*Date.now()+d.getNextValue()}function f(e){return s.RESERVED_ERROR_CODES.includes(e)}function g(e){return Object.keys(s.STANDARD_ERROR_MAP).includes(e)?s.STANDARD_ERROR_MAP[e]:s.STANDARD_ERROR_MAP[s.DEFAULT_ERROR]}function p(e){let t=Object.values(s.STANDARD_ERROR_MAP).find(t=>t.code===e);return t||s.STANDARD_ERROR_MAP[s.DEFAULT_ERROR]}function v(e,t){return void 0===e?g(s.INTERNAL_ERROR):("string"==typeof e&&(e=Object.assign(Object.assign({},g(s.SERVER_ERROR)),{message:e})),void 0!==t&&(e.data=t),f(e.code)&&(e=p(e.code)),e)}function b(e,t){let n=function(e){let t=e.match(RegExp(/^\w+:/,"gi"));if(t&&t.length)return t[0]}(e);return void 0!==n&&new RegExp(t).test(n)}},65716:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;let o=n(54479),r=n(85469),i=n(94306);function a(e){let t=new Float64Array(16);if(e)for(let n=0;n<e.length;n++)t[n]=e[n];return t}t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32,new Uint8Array(32)[0]=9;let s=a(),c=a([1]),l=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),d=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),u=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),h=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),f=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function g(e,t){for(let n=0;n<16;n++)e[n]=0|t[n]}function p(e){let t=1;for(let n=0;n<16;n++){let o=e[n]+t+65535;t=Math.floor(o/65536),e[n]=o-65536*t}e[0]+=t-1+37*(t-1)}function v(e,t,n){let o=~(n-1);for(let n=0;n<16;n++){let r=o&(e[n]^t[n]);e[n]^=r,t[n]^=r}}function b(e,t){let n=a(),o=a();for(let e=0;e<16;e++)o[e]=t[e];p(o),p(o),p(o);for(let e=0;e<2;e++){n[0]=o[0]-65517;for(let e=1;e<15;e++)n[e]=o[e]-65535-(n[e-1]>>16&1),n[e-1]&=65535;n[15]=o[15]-32767-(n[14]>>16&1);let e=n[15]>>16&1;n[14]&=65535,v(o,n,1-e)}for(let t=0;t<16;t++)e[2*t]=255&o[t],e[2*t+1]=o[t]>>8}function _(e,t){let n=0;for(let o=0;o<32;o++)n|=e[o]^t[o];return(1&n-1>>>8)-1}function y(e,t){let n=new Uint8Array(32),o=new Uint8Array(32);return b(n,e),b(o,t),_(n,o)}function m(e){let t=new Uint8Array(32);return b(t,e),1&t[0]}function O(e,t,n){for(let o=0;o<16;o++)e[o]=t[o]+n[o]}function C(e,t,n){for(let o=0;o<16;o++)e[o]=t[o]-n[o]}function E(e,t,n){let o,r,i=0,a=0,s=0,c=0,l=0,d=0,u=0,h=0,f=0,g=0,p=0,v=0,b=0,_=0,y=0,m=0,O=0,C=0,E=0,w=0,N=0,S=0,T=0,R=0,D=0,I=0,P=0,k=0,K=0,A=0,x=0,L=n[0],M=n[1],j=n[2],U=n[3],W=n[4],X=n[5],H=n[6],B=n[7],J=n[8],q=n[9],$=n[10],F=n[11],V=n[12],G=n[13],z=n[14],Y=n[15];i+=(o=t[0])*L,a+=o*M,s+=o*j,c+=o*U,l+=o*W,d+=o*X,u+=o*H,h+=o*B,f+=o*J,g+=o*q,p+=o*$,v+=o*F,b+=o*V,_+=o*G,y+=o*z,m+=o*Y,a+=(o=t[1])*L,s+=o*M,c+=o*j,l+=o*U,d+=o*W,u+=o*X,h+=o*H,f+=o*B,g+=o*J,p+=o*q,v+=o*$,b+=o*F,_+=o*V,y+=o*G,m+=o*z,O+=o*Y,s+=(o=t[2])*L,c+=o*M,l+=o*j,d+=o*U,u+=o*W,h+=o*X,f+=o*H,g+=o*B,p+=o*J,v+=o*q,b+=o*$,_+=o*F,y+=o*V,m+=o*G,O+=o*z,C+=o*Y,c+=(o=t[3])*L,l+=o*M,d+=o*j,u+=o*U,h+=o*W,f+=o*X,g+=o*H,p+=o*B,v+=o*J,b+=o*q,_+=o*$,y+=o*F,m+=o*V,O+=o*G,C+=o*z,E+=o*Y,l+=(o=t[4])*L,d+=o*M,u+=o*j,h+=o*U,f+=o*W,g+=o*X,p+=o*H,v+=o*B,b+=o*J,_+=o*q,y+=o*$,m+=o*F,O+=o*V,C+=o*G,E+=o*z,w+=o*Y,d+=(o=t[5])*L,u+=o*M,h+=o*j,f+=o*U,g+=o*W,p+=o*X,v+=o*H,b+=o*B,_+=o*J,y+=o*q,m+=o*$,O+=o*F,C+=o*V,E+=o*G,w+=o*z,N+=o*Y,u+=(o=t[6])*L,h+=o*M,f+=o*j,g+=o*U,p+=o*W,v+=o*X,b+=o*H,_+=o*B,y+=o*J,m+=o*q,O+=o*$,C+=o*F,E+=o*V,w+=o*G,N+=o*z,S+=o*Y,h+=(o=t[7])*L,f+=o*M,g+=o*j,p+=o*U,v+=o*W,b+=o*X,_+=o*H,y+=o*B,m+=o*J,O+=o*q,C+=o*$,E+=o*F,w+=o*V,N+=o*G,S+=o*z,T+=o*Y,f+=(o=t[8])*L,g+=o*M,p+=o*j,v+=o*U,b+=o*W,_+=o*X,y+=o*H,m+=o*B,O+=o*J,C+=o*q,E+=o*$,w+=o*F,N+=o*V,S+=o*G,T+=o*z,R+=o*Y,g+=(o=t[9])*L,p+=o*M,v+=o*j,b+=o*U,_+=o*W,y+=o*X,m+=o*H,O+=o*B,C+=o*J,E+=o*q,w+=o*$,N+=o*F,S+=o*V,T+=o*G,R+=o*z,D+=o*Y,p+=(o=t[10])*L,v+=o*M,b+=o*j,_+=o*U,y+=o*W,m+=o*X,O+=o*H,C+=o*B,E+=o*J,w+=o*q,N+=o*$,S+=o*F,T+=o*V,R+=o*G,D+=o*z,I+=o*Y,v+=(o=t[11])*L,b+=o*M,_+=o*j,y+=o*U,m+=o*W,O+=o*X,C+=o*H,E+=o*B,w+=o*J,N+=o*q,S+=o*$,T+=o*F,R+=o*V,D+=o*G,I+=o*z,P+=o*Y,b+=(o=t[12])*L,_+=o*M,y+=o*j,m+=o*U,O+=o*W,C+=o*X,E+=o*H,w+=o*B,N+=o*J,S+=o*q,T+=o*$,R+=o*F,D+=o*V,I+=o*G,P+=o*z,k+=o*Y,_+=(o=t[13])*L,y+=o*M,m+=o*j,O+=o*U,C+=o*W,E+=o*X,w+=o*H,N+=o*B,S+=o*J,T+=o*q,R+=o*$,D+=o*F,I+=o*V,P+=o*G,k+=o*z,K+=o*Y,y+=(o=t[14])*L,m+=o*M,O+=o*j,C+=o*U,E+=o*W,w+=o*X,N+=o*H,S+=o*B,T+=o*J,R+=o*q,D+=o*$,I+=o*F,P+=o*V,k+=o*G,K+=o*z,A+=o*Y,m+=(o=t[15])*L,O+=o*M,C+=o*j,E+=o*U,w+=o*W,N+=o*X,S+=o*H,T+=o*B,R+=o*J,D+=o*q,I+=o*$,P+=o*F,k+=o*V,K+=o*G,A+=o*z,x+=o*Y,i+=38*O,a+=38*C,s+=38*E,c+=38*w,l+=38*N,d+=38*S,u+=38*T,h+=38*R,f+=38*D,g+=38*I,p+=38*P,v+=38*k,b+=38*K,_+=38*A,y+=38*x,r=Math.floor((o=i+(r=1)+65535)/65536),i=o-65536*r,r=Math.floor((o=a+r+65535)/65536),a=o-65536*r,r=Math.floor((o=s+r+65535)/65536),s=o-65536*r,r=Math.floor((o=c+r+65535)/65536),c=o-65536*r,r=Math.floor((o=l+r+65535)/65536),l=o-65536*r,r=Math.floor((o=d+r+65535)/65536),d=o-65536*r,r=Math.floor((o=u+r+65535)/65536),u=o-65536*r,r=Math.floor((o=h+r+65535)/65536),h=o-65536*r,r=Math.floor((o=f+r+65535)/65536),f=o-65536*r,r=Math.floor((o=g+r+65535)/65536),g=o-65536*r,r=Math.floor((o=p+r+65535)/65536),p=o-65536*r,r=Math.floor((o=v+r+65535)/65536),v=o-65536*r,r=Math.floor((o=b+r+65535)/65536),b=o-65536*r,r=Math.floor((o=_+r+65535)/65536),_=o-65536*r,r=Math.floor((o=y+r+65535)/65536),y=o-65536*r,r=Math.floor((o=m+r+65535)/65536),m=o-65536*r,i+=r-1+37*(r-1),r=Math.floor((o=i+(r=1)+65535)/65536),i=o-65536*r,r=Math.floor((o=a+r+65535)/65536),a=o-65536*r,r=Math.floor((o=s+r+65535)/65536),s=o-65536*r,r=Math.floor((o=c+r+65535)/65536),c=o-65536*r,r=Math.floor((o=l+r+65535)/65536),l=o-65536*r,r=Math.floor((o=d+r+65535)/65536),d=o-65536*r,r=Math.floor((o=u+r+65535)/65536),u=o-65536*r,r=Math.floor((o=h+r+65535)/65536),h=o-65536*r,r=Math.floor((o=f+r+65535)/65536),f=o-65536*r,r=Math.floor((o=g+r+65535)/65536),g=o-65536*r,r=Math.floor((o=p+r+65535)/65536),p=o-65536*r,r=Math.floor((o=v+r+65535)/65536),v=o-65536*r,r=Math.floor((o=b+r+65535)/65536),b=o-65536*r,r=Math.floor((o=_+r+65535)/65536),_=o-65536*r,r=Math.floor((o=y+r+65535)/65536),y=o-65536*r,r=Math.floor((o=m+r+65535)/65536),m=o-65536*r,i+=r-1+37*(r-1),e[0]=i,e[1]=a,e[2]=s,e[3]=c,e[4]=l,e[5]=d,e[6]=u,e[7]=h,e[8]=f,e[9]=g,e[10]=p,e[11]=v,e[12]=b,e[13]=_,e[14]=y,e[15]=m}function w(e,t){let n;let o=a();for(n=0;n<16;n++)o[n]=t[n];for(n=253;n>=0;n--)E(o,o,o),2!==n&&4!==n&&E(o,o,t);for(n=0;n<16;n++)e[n]=o[n]}function N(e,t){let n=a(),o=a(),r=a(),i=a(),s=a(),c=a(),l=a(),u=a(),h=a();C(n,e[1],e[0]),C(h,t[1],t[0]),E(n,n,h),O(o,e[0],e[1]),O(h,t[0],t[1]),E(o,o,h),E(r,e[3],t[3]),E(r,r,d),E(i,e[2],t[2]),O(i,i,i),C(s,o,n),C(c,i,r),O(l,i,r),O(u,o,n),E(e[0],s,c),E(e[1],u,l),E(e[2],l,c),E(e[3],s,u)}function S(e,t,n){for(let o=0;o<4;o++)v(e[o],t[o],n)}function T(e,t){let n=a(),o=a(),r=a();w(r,t[2]),E(n,t[0],r),E(o,t[1],r),b(e,o),e[31]^=m(n)<<7}function R(e,t,n){g(e[0],s),g(e[1],c),g(e[2],c),g(e[3],s);for(let o=255;o>=0;--o){let r=n[o/8|0]>>(7&o)&1;S(e,t,r),N(t,e),N(e,e),S(e,t,r)}}function D(e,t){let n=[a(),a(),a(),a()];g(n[0],u),g(n[1],h),g(n[2],c),E(n[3],u,h),R(e,n,t)}function I(e){if(e.length!==t.SEED_LENGTH)throw Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);let n=(0,r.hash)(e);n[0]&=248,n[31]&=127,n[31]|=64;let o=new Uint8Array(32),i=[a(),a(),a(),a()];D(i,n),T(o,i);let s=new Uint8Array(64);return s.set(e),s.set(o,32),{publicKey:o,secretKey:s}}t.generateKeyPairFromSeed=I,t.generateKeyPair=function(e){let t=(0,o.randomBytes)(32,e),n=I(t);return(0,i.wipe)(t),n},t.extractPublicKeyFromSecretKey=function(e){if(e.length!==t.SECRET_KEY_LENGTH)throw Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(e.subarray(32))};let P=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function k(e,t){let n,o,r,i;for(o=63;o>=32;--o){for(n=0,r=o-32,i=o-12;r<i;++r)t[r]+=n-16*t[o]*P[r-(o-32)],n=Math.floor((t[r]+128)/256),t[r]-=256*n;t[r]+=n,t[o]=0}for(r=0,n=0;r<32;r++)t[r]+=n-(t[31]>>4)*P[r],n=t[r]>>8,t[r]&=255;for(r=0;r<32;r++)t[r]-=n*P[r];for(o=0;o<32;o++)t[o+1]+=t[o]>>8,e[o]=255&t[o]}function K(e){let t=new Float64Array(64);for(let n=0;n<64;n++)t[n]=e[n];for(let t=0;t<64;t++)e[t]=0;k(e,t)}function A(e,t){var n,o,r;let i=a(),d=a(),u=a(),h=a(),p=a(),v=a(),b=a();return(g(e[2],c),!function(e,t){for(let n=0;n<16;n++)e[n]=t[2*n]+(t[2*n+1]<<8);e[15]&=32767}(e[1],t),E(u,n=e[1],n),E(h,u,l),C(u,u,e[2]),O(h,e[2],h),E(p,h,h),E(v,p,p),E(b,v,p),E(i,b,u),E(i,i,h),!function(e,t){let n;let o=a();for(n=0;n<16;n++)o[n]=t[n];for(n=250;n>=0;n--)E(o,o,o),1!==n&&E(o,o,t);for(n=0;n<16;n++)e[n]=o[n]}(i,i),E(i,i,u),E(i,i,h),E(i,i,h),E(e[0],i,h),E(d,o=e[0],o),E(d,d,h),y(d,u)&&E(e[0],e[0],f),E(d,r=e[0],r),E(d,d,h),y(d,u))?-1:(m(e[0])===t[31]>>7&&C(e[0],s,e[0]),E(e[3],e[0],e[1]),0)}t.sign=function(e,t){let n=new Float64Array(64),o=[a(),a(),a(),a()],i=(0,r.hash)(e.subarray(0,32));i[0]&=248,i[31]&=127,i[31]|=64;let s=new Uint8Array(64);s.set(i.subarray(32),32);let c=new r.SHA512;c.update(s.subarray(32)),c.update(t);let l=c.digest();c.clean(),K(l),D(o,l),T(s,o),c.reset(),c.update(s.subarray(0,32)),c.update(e.subarray(32)),c.update(t);let d=c.digest();K(d);for(let e=0;e<32;e++)n[e]=l[e];for(let e=0;e<32;e++)for(let t=0;t<32;t++)n[e+t]+=d[e]*i[t];return k(s.subarray(32),n),s},t.verify=function(e,n,o){let i=new Uint8Array(32),s=[a(),a(),a(),a()],c=[a(),a(),a(),a()];if(o.length!==t.SIGNATURE_LENGTH)throw Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(A(c,e))return!1;let l=new r.SHA512;l.update(o.subarray(0,32)),l.update(e),l.update(n);let d=l.digest();return K(d),R(s,c,d),D(c,o.subarray(32)),N(s,c),T(i,s),!_(o,i)},t.convertPublicKeyToX25519=function(e){let t=[a(),a(),a(),a()];if(A(t,e))throw Error("Ed25519: invalid public key");let n=a(),o=a(),r=t[1];O(n,c,r),C(o,c,r),w(o,o),E(n,n,o);let i=new Uint8Array(32);return b(i,n),i},t.convertSecretKeyToX25519=function(e){let t=(0,r.hash)(e.subarray(0,32));t[0]&=248,t[31]&=127,t[31]|=64;let n=new Uint8Array(t.subarray(0,32));return(0,i.wipe)(t),n}},66122:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.WsConnector=void 0;let r=n(82091),i=n(33394);class a{constructor(){this.disconnectListener=[],this.walletName="",this.walletNameKey="",this.enable=!0,this.pendingRequests=new Map,(0,i.getDefaultReporter)().beginReport()}setAccountChangeListener(e){this.accountChangeListener=e}setConnectionManager(e){this.connectionManager=e}addConnectionListener(){var e;null===(e=this.connectionManager)||void 0===e||e.addListener("sdk_response",(e,t)=>{var n=(0,r.safeJsonParse)(t);(0,i.logDebug)(`Engine ==>> addListener ==> success ==> ${n}`),this.handleResponse(e,n)},function(){})}addDisconnectListener(e){this.disconnectListener.push(e)}connectManagerDisconnect(){return o(this,arguments,void 0,function*(e=!1){var t;yield null===(t=this.connectionManager)||void 0===t?void 0:t.disconnect(e)})}openWallet(e,t){}bindRequestForPromise(e,t){this.pendingRequests.set(e,t)}send(e,t,n){return o(this,void 0,void 0,function*(){var o,a;try{delete e.injectParams}catch(e){}(0,i.logDebug)("Engine ==>> send  request==>",JSON.stringify(e));let s=this.getRequestId();try{let c=yield null===(o=this.connectionManager)||void 0===o?void 0:o.send(JSON.stringify(Object.assign(Object.assign({},e),{requestId:s})),n);c&&(null===(a=this.connectionManager)||void 0===a||a.events.once(c.toString(),e=>{var n;(0,i.logDebug)(`Engine ==> send => onAck => ${(0,r.safeJsonStringify)(e)}`),e&&e.result&&(null===(n=t.onAck)||void 0===n||n.call(t))})),t.resolve&&this.bindRequestForPromise(s,t.resolve)}catch(e){return Promise.reject(e)}})}restoreconnect(e,t){return o(this,void 0,void 0,function*(){var n;yield null===(n=this.connectionManager)||void 0===n?void 0:n.restoreConnect(e.topic),t(e)})}restoreconnectFromTopic(e){return o(this,void 0,void 0,function*(){var t;yield null===(t=this.connectionManager)||void 0===t?void 0:t.restoreConnect(e)})}getRequestId(){let e=Date.now().toString();return(0,i.logDebug)("Engine ==>> getRequestId ==>",e),e}handleResponse(e,t){if((0,i.logDebug)(`Engine ==>> handleResponse_1  ======>response: ${(0,r.safeJsonStringify)(t)}`,e),"requestId"in t){(0,i.logDebug)("Engine ==>> handleResponse_2  ===> in response");let e=t.requestId,n=this.pendingRequests.get(e);n?((0,i.logDebug)("Engine ==>> handleResponse_3  ===> find resolve:",n),n(t),this.pendingRequests.delete(e)):((0,i.logDebug)("Engine ==>> handleResponse_3  ===> not find resolve:"),"disconnect"===t.method&&(this.disconnectListener.forEach(e=>e()),this.disconnectListener=[],this.clearData()))}}getCurrentConnectionReady(){var e;return!!(null===(e=this.connectionManager)||void 0===e?void 0:e.getCurrentConnectionReady())}saveSessionContent(e,t){var n;null===(n=this.connectionManager)||void 0===n||n.saveSessionContent(e,t)}getSessionContent(e){var t;return null===(t=this.connectionManager)||void 0===t?void 0:t.getSessionContent(e)}setOnConnectResultListener(e){this.connectResultListener=e}getTag(){return""}toJSON(){return"ws-connector"}clearData(){this.pendingRequests.clear()}}t.WsConnector=a},66352:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mediaNotTouch=t.mediaTouch=t.maxWidth=void 0,t.isDevice=function(e){var n;let s=(0,i.getWindow)();if(!s)return"desktop"===e;if((0,r.isTmaPlatform)("weba"))return!0;let c=s.innerWidth;switch(e){case"desktop":return c>t.maxWidth.tablet;case"tablet":return c>t.maxWidth.mobile;default:let l=c<=t.maxWidth.mobile||(0,o.isOS)("ios","android","ipad");if(l){let e=!!(null===(n=(0,i.getWindow)())||void 0===n?void 0:n.TelegramWebviewProxy),t=navigator.maxTouchPoints||0;e&&0===t&&(l=!1),(0,a.logDebug)("isDevice mobile isTelegram and maxTouchPoints:",l,e,t)}return l}},t.media=function(e){switch(e){case"mobile":return`@media (max-width: ${t.maxWidth.mobile}px)`;case"tablet":return`@media (max-width: ${t.maxWidth.tablet}px) (min-width: ${t.maxWidth.mobile}px)`;default:return`@media (min-width: ${t.maxWidth.tablet}px)`}},t.mediaMin=function(e){return`@media (min-width: ${e}px)`},t.mediaMax=function(e){return`@media (max-width: ${e}px)`},t.mediaMinMax=function(e,t){return`@media (min-width: ${e}px) and (max-width: ${t}px)`};let o=n(9423),r=n(19903),i=n(29477),a=n(33394);t.maxWidth={mobile:440,tablet:1020},t.mediaTouch="@media (hover: none)",t.mediaNotTouch="@media not all and (hover: none)"},66600:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{default:function(){return c},getImageProps:function(){return s}});let o=n(37216),r=n(6636),i=n(47680),a=o._(n(32360));function s(e){let{props:t}=(0,r.getImgProps)(e,{defaultLoader:a.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,n]of Object.entries(t))void 0===n&&delete t[e];return{props:t}}let c=i.Image},67679:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.NameSpaceKeyStarknet=t.NameSpaceKeyTron=t.NameSpaceKeyCosmos=t.NameSpaceKeyAptos=t.NameSpaceKeyBtc=t.NameSpaceKeySui=t.NameSpaceKeyTON=t.NameSpaceKeySOL=t.NameSpaceKeyEip155=t.OpenAppLinkType=void 0,function(e){e.UniversalLink="universallink",e.DeepLink="deeplink"}(n||(t.OpenAppLinkType=n={})),t.NameSpaceKeyEip155="eip155",t.NameSpaceKeySOL="solana",t.NameSpaceKeyTON="ton",t.NameSpaceKeySui="sui",t.NameSpaceKeyBtc="btc",t.NameSpaceKeyAptos="aptos",t.NameSpaceKeyCosmos="cosmos",t.NameSpaceKeyTron="tron",t.NameSpaceKeyStarknet="starknet"},68836:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OKX_CONNECT_ERROR_CODES=t.OKXConnectError=void 0;var o=n(36893);Object.defineProperty(t,"OKXConnectError",{enumerable:!0,get:function(){return o.OKXConnectError}}),Object.defineProperty(t,"OKX_CONNECT_ERROR_CODES",{enumerable:!0,get:function(){return o.OKX_CONNECT_ERROR_CODES}})},68950:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OkxwalletInjectTonsdkConnector=t.OkxwalletInjectConnector=t.WsConnector=t.TgwalletConnector=t.InjectConnector=t.getTagByappName=t.OKX_INJECT_WALLET=t.OKX_APP_WALLET=t.OKX_TG_WALLET=t.AppwalletConnector=void 0;var o=n(12302);Object.defineProperty(t,"AppwalletConnector",{enumerable:!0,get:function(){return o.AppwalletConnector}});var r=n(14103);Object.defineProperty(t,"OKX_TG_WALLET",{enumerable:!0,get:function(){return r.OKX_TG_WALLET}}),Object.defineProperty(t,"OKX_APP_WALLET",{enumerable:!0,get:function(){return r.OKX_APP_WALLET}}),Object.defineProperty(t,"OKX_INJECT_WALLET",{enumerable:!0,get:function(){return r.OKX_INJECT_WALLET}}),Object.defineProperty(t,"getTagByappName",{enumerable:!0,get:function(){return r.getTagByappName}});var i=n(88193);Object.defineProperty(t,"InjectConnector",{enumerable:!0,get:function(){return i.InjectConnector}});var a=n(7536);Object.defineProperty(t,"TgwalletConnector",{enumerable:!0,get:function(){return a.TgwalletConnector}});var s=n(66122);Object.defineProperty(t,"WsConnector",{enumerable:!0,get:function(){return s.WsConnector}});var c=n(803);Object.defineProperty(t,"OkxwalletInjectConnector",{enumerable:!0,get:function(){return c.OkxwalletInjectConnector}});var l=n(52741);Object.defineProperty(t,"OkxwalletInjectTonsdkConnector",{enumerable:!0,get:function(){return l.OkxwalletInjectTonsdkConnector}})},70742:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.AptosProvider=void 0;let r=n(1461),i=n(62332),a=n(97950),s=n(66352),c=n(331),l=Object.freeze(["637","70000060","70000066"]),d=new Map;d.set("aptos:637","Mainnet"),d.set("aptos:70000060","Movement Testnet"),d.set("aptos:70000066","Movement Mainnet");class u{send(e){return o(this,void 0,void 0,function*(){try{let t;(0,i.logDebug)("AptosProvider send request:",(0,i.safeJsonStringify)(e)),yield this.restoreConnect();let n=yield window.okxwallet.aptos.network(),o=this.searchChainIdToInjectChainName(e.chainId);if((0,i.logDebug)("AptosProvider send network and searchNetwork:",n,"-----",o),!(n&&o&&n.toLowerCase()===o.toLowerCase()))throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`Please switch your wallet link to '${o}'`);let a=e.method;switch(a){case"aptos_signMessage":if(e.injectParams){let n=yield window.okxwallet.aptos.signMessage(e.injectParams);return t={method:e.method,result:n.signature,injectResult:n},(0,i.logDebug)("AptosProvider send result:",(0,i.safeJsonStringify)(t)),t}throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,`param is error method: '${a}'`);case"aptos_signTransaction":{(0,i.logDebug)("AptosProvider Method>>>> :",a);let n=yield window.okxwallet.aptos.signTransaction(e.params);return t={method:e.method,result:n},(0,i.logDebug)("AptosProvider send result:",(0,i.safeJsonStringify)(t)),t}case"aptos_signAndSubmitTransaction":{(0,i.logDebug)("AptosProvider Method>>>> :",a);let n=yield window.okxwallet.aptos.signAndSubmitTransaction(e.params);return t={method:e.method,result:n.hash},(0,i.logDebug)("AptosProvider send result:",(0,i.safeJsonStringify)(t)),t}default:throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED,` method: '${a}'`)}}catch(e){throw(0,i.logDebug)("AptosProvider send error:",e),e}})}searchChainIdToInjectChainName(e){let t=e;return d.forEach((n,o)=>{e.includes(o)&&(t=n)}),t}connectReady(){return!0}disconnect(){}restoreConnect(){return(0,s.isDevice)("mobile")?this.connect():Promise.resolve()}parseConnectResponse(e,t,n,c,d,u){return o(this,void 0,void 0,function*(){let e,t=[];c.forEach(e=>{e.namespace===r.NameSpaceKeyAptos&&t.push(...e.chains)});let n=[],o={};if((0,i.logDebug)("AptosProvider parseConnectResponse connectChain",JSON.stringify(t)),!(0,s.isDevice)("mobile")&&t&&t.length>0&&(e=(yield window.okxwallet.aptos.connect()).publicKey),t.forEach(t=>{let r=d.address.find(e=>l.includes(e.chainId)&&637===e.coinType||e.namespaceChainId===t);r&&(n.push(t+":"+r.address),o[t]={publicKey:r.publicKey?r.publicKey:e})}),(0,i.logDebug)("AptosProvider parseConnectResponse addresses",JSON.stringify(n)),n&&n.length>0)return{namespace:r.NameSpaceKeyAptos,addresses:n,methods:[...a.AptosMethods],extra:o}})}connect(){return o(this,void 0,void 0,function*(){return window.okxwallet.aptos.connect()})}singleConnect(){return this.connect()}addListener(e){window.okxwallet.aptos.onAccountChange(t=>{console.log("window.okxwallet configEventWithKey_aptos:",Date.now(),c.key,JSON.stringify(t)),t&&e()})}removeListener(){}}t.AptosProvider=u},74302:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.okxfromString=function(e,t="utf8"){let n=l[t];if((0,r.logDebug)("okxfromstring ====> "),!n)throw Error(`Unsupported encoding "${t}"`);return n.decoder.decode(`${n.prefix}${e}`)},t.okxtoString=function(e,t="utf8"){let n=l[t];if((0,r.logDebug)("okxtoString ====> "),!n)throw Error(`Unsupported encoding "${t}"`);return n.encoder.encode(e).substring(1)},t.alloc=function(e=0){return new Uint8Array(e)},t.allocUnsafe=i;let o=n(21098),r=n(33394);function i(e=0){return new Uint8Array(e)}function a(e,t,n,o){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:o}}}let s=a("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),c=a("ascii","a",e=>{let t="a";for(let n=0;n<e.length;n++){let o=e[n];o&&String.fromCharCode(o)&&(t+=String.fromCharCode(o))}return t},e=>{let t=i((e=e.substring(1)).length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}),l=Object.assign({utf8:s,"utf-8":s,hex:o.bases.base16,latin1:c,ascii:c,binary:c},o.bases)},74538:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectorState=t.CONNECT_PROTOCOL_VER=t.CONNECT_JSONRPC_VER=t.OKXCONNECTOR_SESSION_LIVE_TTL=t.OKXCONNECTOR_MESSAGE_DISCONNECT_TTL=t.OKXCONNECTOR_MESSAGE_TTL=t.OKXCONNECTOR_WS_URL_PENDING_CLOSE_CODE=t.OKXCONNECTOR_WS_URL_LIST=t.OKXCONNECTOR_WS_URL_IDX_KEY=t.OKXCONNECTOR_WS_URL_3=t.OKXCONNECTOR_WS_URL_2=t.OKXCONNECTOR_WS_URL_1=t.EVENT_EMITTER_MAX_LISTENERS=t.OKXCONNECTOR_PROTOCOL_VERSION=void 0,t.OKXCONNECTOR_PROTOCOL_VERSION=2,t.EVENT_EMITTER_MAX_LISTENERS=10,t.OKXCONNECTOR_WS_URL_1="wss://wsdexpri.okx.com/ws/v1/wallet-connect-relay",t.OKXCONNECTOR_WS_URL_2="wss://wsdexpri.okx.ac/ws/v1/wallet-connect-relay",t.OKXCONNECTOR_WS_URL_3="wss://wsdexpri.coinall.ltd/ws/v1/wallet-connect-relay",t.OKXCONNECTOR_WS_URL_IDX_KEY="wuik",t.OKXCONNECTOR_WS_URL_LIST=[t.OKXCONNECTOR_WS_URL_1,t.OKXCONNECTOR_WS_URL_2,t.OKXCONNECTOR_WS_URL_3],t.OKXCONNECTOR_WS_URL_PENDING_CLOSE_CODE={TIME_OUT:3990,CANCELED:3991,FINISHED:3992},t.OKXCONNECTOR_MESSAGE_TTL=3e5,t.OKXCONNECTOR_MESSAGE_DISCONNECT_TTL=864e5,t.OKXCONNECTOR_SESSION_LIVE_TTL=864e5,t.CONNECT_JSONRPC_VER="2.0",t.CONNECT_PROTOCOL_VER=2,t.ConnectorState={InitState:0,Connecting:1,Connected:2,Disconnected:3,OnError:4}},74823:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.Engine=void 0;let r=n(1461),i=n(74538),a=n(62332),s=n(14103),c=n(39628),l=n(14904),d=n(78944);class u{constructor(e){this.connectors=[],this.useConnector=void 0,this.connectionManager=new c.ConnectionManager(e),this.addConnectionListener()}getConnector(){if(this.useConnector)return this.useConnector}setAccountChangeListener(e){for(let t of(this.accountChangeListener=e,(0,a.logDebug)("setAccountChangeListener: engine",e),this.connectors))t.setAccountChangeListener(e)}registerConnector(e){for(let t of(this.connectors=e,e))t.setConnectionManager(this.connectionManager)}hasWsConnector(){for(let e of this.connectors)if(this.isWsConnector(e))return!0;return!1}isWsConnector(e){return!!e&&(e.getTag()===s.OKX_TG_WALLET||e.getTag()===s.OKX_APP_WALLET)}isInjectedConnector(e){return!!e&&e.getTag()===s.OKX_INJECT_WALLET}universalConnect(e,t,n){return o(this,void 0,void 0,function*(){return this.addConnectionListener(),new Promise((i,c)=>o(this,void 0,void 0,function*(){var o,u,h,f,g;try{(0,a.logDebug)("engine universalConnect request :",JSON.stringify(e)),(0,a.logDebug)("engine universalConnect sessionConfig :",JSON.stringify(t));let p=[];e.forEach(e=>{let t=e.name;(t.startsWith("requestAccounts")||t.startsWith("ton"))&&p.push(e)}),(0,a.logDebug)("engine universalConnect universalRequest :",JSON.stringify(p));let v=this.connectionManager.getConnectInfo(),b=Date.now().toString(),_=null!==(o=t.openUniversalUrl)&&void 0!==o&&o,y=null!==(u=t.openAppLinkType)&&void 0!==u?u:r.OpenAppLinkType.UniversalLink,m={protocolVer:Number(r.tonConnectSdkVersion),topic:v.channelId,clientId:v.clientId,requestId:b,dAppInfo:this.fixDappName(t.dappInfo),requests:p,redirect:null!==(h=null==t?void 0:t.redirect)&&void 0!==h?h:"none"},O=(0,a.encodeConnectParams)(m);m.redirect=null!==(f=null==t?void 0:t.redirect)&&void 0!==f?f:"none",(0,a.logDebug)("engine universalConnect ==>>universalConnectRequest:",JSON.stringify(m));let C="",E="";if(_){let e=(0,a.getOKXLink)(m,t.useMini,t.tmaReturnUrl);C=e.universalLink,E=e.deepLink||"",(0,a.logDebug)("engine universalConnect ==>>openOKXLink:",C)}let w=()=>1==this.connectors.length&&this.connectors[0].getTag()===s.OKX_INJECT_WALLET?this.connectors[0].openWallet({connectRequest:m},y):t.useMini?(0,a.openOKXTMAWalletlinkWithFallback)(C):(0,a.openOKXDeeplinkWithFallback)(E,C,y);(0,a.logDebug)("engine universalConnect ==>>openOKXLink:",C);let N=(0,a.isIos)();if(N&&_&&((0,a.logDebug)(`engine universalConnect ==>>isIOS: ${N}   openUniversalLink: ${_}`),w()),this.addOnConnectResultListener(e=>{var n,o,u,h;try{if(this.addOnConnectResultListener(void 0),"connect"==e.method){(0,a.logDebug)("engin  universalConnect success connectResponse:>>>",JSON.stringify(e));let c=(0,l.buildNameSpacesByConnectResponse)(e);if(c){let l;(null===(o=null===(n=e.payload)||void 0===n?void 0:n.responses)||void 0===o?void 0:o[0])&&"walletName"in e.payload.responses[0]&&(l=e.payload.responses[0].walletName);let h=null===(u=e.payload)||void 0===u?void 0:u.wallet.appName;var f="";switch(h){case d.OKXWalletName:f=s.OKX_APP_WALLET;break;case d.OKXMiniWalletName:f=s.OKX_TG_WALLET;break;case d.OKXInjectWalletName:f=s.OKX_INJECT_WALLET}var g=this.connectors.find(e=>e.getTag()===f);if(!g)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR);let p=Object.assign({topic:v.channelId,sessionConfig:t,namespaces:c},e.payload&&{wallet:Object.assign(Object.assign({},e.payload.wallet),{walletName:l})}),b=e.payload.responses.find(e=>"requestAccounts"===e.name);b&&b.connectRequestMethods&&(p.signResponse=b.connectRequestMethods),(0,a.logDebug)("engin  universalConnect success session:>>>",JSON.stringify(p)),this.isWsConnector(g)&&((0,a.logDebug)("engine update protocol version"),this.connectionManager.updateProtocolVersion(v.channelId,e.payload.wallet.maxProtocolVersion)),this.deviceInfo=Object.assign({},p.wallet),i(p),this.setUseConnector(g),(0,a.reportEvent)(a.OKXReportType.PAGE_IN,a.Report_OKXConnectSDKExtension_ConnectDapp_ConnectSuccess_View,f)}else throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR)}else if("connect_error"==e.method&&(null===(h=e.payload)||void 0===h?void 0:h.code)!=void 0)throw new r.OKXConnectError(e.payload.code)}catch(e){c(e)}}),this.hasWsConnector()){yield null===(g=this.connectionManager)||void 0===g?void 0:g.disconnect(!1);try{yield this.connectionManager.connect()}catch(e){throw(0,a.logDebug)("Engine universalConnect error",e),e}(0,a.logDebug)("engin  universalConnect ==>> connectInfoAndUrl:",n),this.sendSession(O)}if(!N&&_&&w(),(0,a.logDebug)("engin  universalConnect ==>> connectInfoAndUrl:",n),n){let e={connectRequest:m,redirect:t.redirect,tmaReturnUrl:t.tmaReturnUrl};(0,a.logDebug)("universalConnect connectInfoAndUrl info :",JSON.stringify(e)),n(e)}}catch(e){(0,a.logDebug)("Engine universalConnect catch error",e),c(e)}}))})}fixDappName(e){try{if("dapp portal"===e.name.toLowerCase()){let t=document.title;if(t||(t=this.getOGSiteName()),t)return Object.assign(Object.assign({},e),{name:e.name+" - "+t})}return e}catch(t){return e}}getOGSiteName(){let e=document.getElementsByTagName("meta"),t=["og:site_name","og:title","twitter:title"];for(let n of e){let e=n.getAttribute("property");for(let o of t)if(e==o)return n.getAttribute("content")}}addOnConnectResultListener(e){for(let t of this.connectors)this.isInjectedConnector(t)&&t.setOnConnectResultListener(e);this.connectResultListener=e}openWallet(e,t,n){var o;t?t.openWallet(e,n):null===(o=this.getConnector())||void 0===o||o.openWallet(e,n)}send(e,t,n){return o(this,void 0,void 0,function*(){var n,o,r,i,s,c,l,d,u;let h;"chainId"in e&&null!=e.chainId&&(h=e.chainId.toString());try{(0,a.reportEvent)(a.OKXReportType.LOG,a.Report_OKXConnectSDK_RequestStart_Log,"",null!==(o=null===(n=this.getConnector())||void 0===n?void 0:n.getTag())&&void 0!==o?o:"",e.method,null!==(i=null===(r=this.deviceInfo)||void 0===r?void 0:r.platform)&&void 0!==i?i:"",h),null===(s=this.getConnector())||void 0===s||s.send(e,{resolve:n=>{var o,r,i,s,c,l,d,u,f;null===(o=null==t?void 0:t.resolve)||void 0===o||o.call(t,n),"error"in n&&n.error?(0,a.reportEvent)(a.OKXReportType.LOG,a.Report_OKXConnectSDK_RequestError_Log,"",null!==(i=null===(r=this.getConnector())||void 0===r?void 0:r.getTag())&&void 0!==i?i:"",e.method,null!==(c=null===(s=this.deviceInfo)||void 0===s?void 0:s.platform)&&void 0!==c?c:"",h):(0,a.reportEvent)(a.OKXReportType.LOG,a.Report_OKXConnectSDK_RequestSuccess_Log,"",null!==(d=null===(l=this.getConnector())||void 0===l?void 0:l.getTag())&&void 0!==d?d:"",e.method,null!==(f=null===(u=this.deviceInfo)||void 0===u?void 0:u.platform)&&void 0!==f?f:"",h)},onAck:()=>{var e;null===(e=null==t?void 0:t.onAck)||void 0===e||e.call(t)}})}catch(t){throw(0,a.reportEvent)(a.OKXReportType.LOG,a.Report_OKXConnectSDK_RequestError_Log,"",null!==(l=null===(c=this.getConnector())||void 0===c?void 0:c.getTag())&&void 0!==l?l:"",e.method,null!==(u=null===(d=this.deviceInfo)||void 0===d?void 0:d.platform)&&void 0!==u?u:"",h),t}})}clearData(){var e;null===(e=this.getConnector())||void 0===e||e.clearData()}addDisconnectListener(e){var t;null===(t=this.getConnector())||void 0===t||t.addDisconnectListener(e)}saveSessionContent(e,t){this.connectionManager.saveSessionContent(e,t)}getSessionContent(e){var t,n=this.connectionManager.getSessionContent(e);if(n){var o="";if("object"==typeof n&&(o=(0,s.getTagByappName)(null===(t=n.wallet)||void 0===t?void 0:t.appName)),this.connectors.find(e=>e.getTag()===o))return n}}setConnectConnector(e){var t=(0,s.getTagByappName)(null==e?void 0:e.appName);t&&this.setUseConnector(this.connectors.find(e=>e.getTag()===t))}setUseConnector(e){this.useConnector=e,this.isWsConnector(e)&&e.addConnectionListener()}setSessionConnectingListener(e){this.sessionConnectingListener=e}restoreconnect(e,t){return o(this,void 0,void 0,function*(){var n;yield null===(n=this.getConnector())||void 0===n?void 0:n.restoreconnect(e,e=>{var n,o;t(e),e&&(this.deviceInfo=Object.assign({},e.wallet),(0,a.reportEvent)(a.OKXReportType.PAGE_IN,a.Report_OKXConnectSDKExtension_ConnectDapp_ConnectSuccess_View,null!==(o=null===(n=this.getConnector())||void 0===n?void 0:n.getTag())&&void 0!==o?o:""))})})}restoreconnectFromTopic(e){return o(this,void 0,void 0,function*(){this.isWsConnector(this.getConnector())&&(yield this.getConnector().restoreconnectFromTopic(e))})}getCurrentConnectionReady(e){var t;return!!(null===(t=this.getConnector())||void 0===t?void 0:t.getCurrentConnectionReady(e))}connectManagerDisconnect(){return o(this,arguments,void 0,function*(e=!1){var t;yield null===(t=this.getConnector())||void 0===t?void 0:t.connectManagerDisconnect(e)})}sendSession(e){return o(this,void 0,void 0,function*(){(0,a.logDebug)("[Connect] sendSession called:",e);let t=Date.now().toString(),n={method:"session_info",params:{protocolVersion:i.CONNECT_PROTOCOL_VER,sessionInfo:e}};yield this.connectionManager.sendRaw(JSON.stringify(Object.assign(Object.assign({},n),{requestId:t})))})}addConnectionListener(){var e;null===(e=this.connectionManager)||void 0===e||e.addListener("sdk_response",(e,t)=>{var n=(0,a.safeJsonParse)(t);(0,a.logDebug)(`Engine ==>> addListener ==> success ==> ${n}`),"connect"===n.method||"connect_error"===n.method?this.connectResultListener&&this.connectResultListener(n):"session_connecting"===n.method&&((0,a.logDebug)("Engine ==>> handleResponse_4  ===> sessionConnectingListener"),this.sessionConnectingListener&&((0,a.logDebug)("Engine ==>> handleResponse_4  ===> sessionConnectingListener not null"),this.sessionConnectingListener(),this.sessionConnectingListener=void 0))},function(){})}}t.Engine=u},78944:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OKXInjectWalletName=t.OKXMiniWalletName=t.OKXWalletName=void 0,t.creatOKXWalletInfo=function(){return{appName:"okxAppWallet",name:t.OKXWalletName,imageUrl:"https://static.okx.com/cdn/assets/imgs/247/58E63FEA47A2B7D7.png"}},t.creatOKXMiniAppWalletInfo=function(){return{appName:"okxMiniApp",name:t.OKXMiniWalletName,imageUrl:"https://static.okx.com/cdn/assets/imgs/247/58E63FEA47A2B7D7.png"}},t.creatOKXInjectWalletInfo=function(){return{appName:"okxInjectWallet",name:t.OKXInjectWalletName,imageUrl:""}},t.OKXWalletName="OKX Wallet",t.OKXMiniWalletName="OKX Mini Wallet",t.OKXInjectWalletName="OKX Inject Wallet"},80462:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.OKXSolanaProvider=void 0;let i=n(24786),a=r(n(1560)),s=n(46674);class c{getRealChainId(e){if(null==e){if(1==this.chainsSet.size){let e="",t=this.defaultChainMap;if(this.chainsSet.forEach(function(n){t.has(n)&&(e=t.get(n))}),""!=e)return e;throw Error("unsupported chainId")}throw Error("connected to multiple solana chains,chainId can not be null")}if(e.startsWith("svm")||this.caip.includes(e))return e;throw Error("wrong chainId")}getConnectedNamespace(){var e,t,n;null===(n=null===(t=null===(e=this.provider.session)||void 0===e?void 0:e.namespaces)||void 0===t?void 0:t.solana)||void 0===n||n.chains.forEach(e=>{this.chainsSet.add(e.split(":")[0])})}constructor(e){this.chainsSet=new Set,this.caip=["solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","sonic:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","sonic:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","soon:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","soon:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eclipse:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","sonic:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp"],this.SOON_MAIN_NET_CAIP="soon:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",this.SOON_TEST_NET_CAIP="soon:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",this.ECLIPSE_MAIN_NET_CAIP="eclipse:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",this.SOON_MAIN_NET_ID="svm:70000069",this.SOON_TEST_NET_ID="svm:70000067",this.ECLIPSE_MAIN_NET_ID="svm:70000068",this.defaultChainMap=new Map,this.provider=e,this.defaultChainMap.set("solana","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp"),this.defaultChainMap.set("sonic","sonic:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"),this.defaultChainMap.set("soon",this.SOON_MAIN_NET_CAIP),this.defaultChainMap.set("eclipse",this.ECLIPSE_MAIN_NET_CAIP),this.getConnectedNamespace()}signMessage(e,t){return o(this,void 0,void 0,function*(){var n,o,r,c;if("string"!=typeof e)try{e=new TextDecoder().decode(e)}catch(e){}let l=e,d=null;try{let t=a.default.decode(e);try{d=i.Transaction.from(t)}catch(e){d=i.VersionedTransaction.deserialize(t)}}catch(e){}if(null!=d)return new Promise((e,t)=>{t("Please sign with normal message")});l=(null===(o=null===(n=this.provider.session)||void 0===n?void 0:n.wallet)||void 0===o?void 0:o.appName)=="OKX Wallet"?a.default.encode(new TextEncoder().encode(e)):e,t=this.getRealChainId(t);try{let n={chainId:t,method:"solana_signMessage",params:{message:l,pubkey:null===(r=this.getAccount(t))||void 0===r?void 0:r.address},injectParams:{message:e,pubkey:null===(c=this.getAccount(t))||void 0===c?void 0:c.address}},o=yield this.provider.request(n,t);if((0,s.logDebug)("signMessage111",o),!("result"in o))return(0,s.logDebug)("signMessage111",o),new Promise((e,t)=>{e(o.error)});{let e=o.result;return new Promise((n,o)=>{var r;n({signature:a.default.decode(e),publicKey:null===(r=this.getAccount(t))||void 0===r?void 0:r.address})})}}catch(e){return console.error(" --Error--",e),new Promise((t,n)=>{t(e)})}})}getAccount(e){var t,n,o,r;let a=null===(n=null===(t=this.provider.session)||void 0===t?void 0:t.namespaces.solana)||void 0===n?void 0:n.accounts[0];if(null!=e&&(a=null===(r=null===(o=this.provider.session)||void 0===o?void 0:o.namespaces.solana)||void 0===r?void 0:r.accounts.filter(function(t){return t.startsWith(e)})[0]),(0,s.logDebug)("getAccount",a),!a)return;let c=a.split(":")[2];if(c)return{address:c,publicKey:new i.PublicKey(c)}}signTransaction(e,t){var n,o;(0,s.logDebug)("OKXSolanaProvider",typeof e),t=this.getRealChainId(t);try{let o=e.serialize({requireAllSignatures:!1,verifySignatures:!1}),r={data:a.default.encode(o),from:null===(n=this.getAccount(t))||void 0===n?void 0:n.address};return this.getSignedTransaction("solana_signTransaction",r,t,e)}catch(i){let n=e.serialize(),r={data:a.default.encode(n),from:null===(o=this.getAccount(t))||void 0===o?void 0:o.address};return this.getSignedTransaction("solana_signTransaction",r,t,e)}}signAllTransactions(e,t){return o(this,void 0,void 0,function*(){t=this.getRealChainId(t);try{var n=e.map(e=>{var n,o;return o=e instanceof i.VersionedTransaction?e.serialize():e.serialize({requireAllSignatures:!1,verifySignatures:!1}),{data:a.default.encode(o),from:null===(n=this.getAccount(t))||void 0===n?void 0:n.address}});let o=yield this.provider.request({method:"solana_signAllTransactions",params:{transactions:n},injectParams:e},t);if(!("result"in o))return new Promise((e,t)=>{e(o)});{let e=o.result,t=JSON.parse(e).map(e=>{let t=a.default.decode(e);try{let e=i.Transaction.from(t);return(0,s.logDebug)("verifySignatures",e.verifySignatures()),e}catch(e){return i.VersionedTransaction.deserialize(t)}});return new Promise((e,n)=>{e(t)})}}catch(e){return(0,s.logDebug)("getSignedTransaction",e),new Promise((t,n)=>{t(e)})}})}signAndSendTransaction(e,t){return o(this,void 0,void 0,function*(){var n,o;t=this.getRealChainId(t);try{let r={};try{let o=e.serialize({requireAllSignatures:!1,verifySignatures:!1});r={data:a.default.encode(o),from:null===(n=this.getAccount(t))||void 0===n?void 0:n.address}}catch(i){let n=e.serialize();r={data:a.default.encode(n),from:null===(o=this.getAccount(t))||void 0===o?void 0:o.address}}let i=yield this.provider.request({method:"solana_signAndSendTransaction",params:r,injectParams:e},t);if(!("result"in i))return new Promise((e,t)=>{e(i)});{let e=i.result;return new Promise((t,n)=>{t(e)})}}catch(e){return(0,s.logDebug)("getSignedTransaction",e),new Promise((t,n)=>{t(e)})}})}getSignedTransaction(e,t,n,r){return o(this,void 0,void 0,function*(){try{let o=yield this.provider.request({method:e,params:t,injectParams:r},n);if("result"in o){let e,t=o.result,n=a.default.decode(t);try{e=i.Transaction.from(n)}catch(t){e=i.VersionedTransaction.deserialize(n)}return e instanceof i.VersionedTransaction||(0,s.logDebug)("verifySignatures",e.verifySignatures()),new Promise((t,n)=>{t(e)})}if(!("injectResult"in o))return new Promise((e,t)=>{t(o)});{(0,s.logDebug)("getSignedTransaction injectResult");let e=o.injectResult;return new Promise((t,n)=>{t(e)})}}catch(e){return(0,s.logDebug)("getSignedTransaction",e),new Promise((t,n)=>{t(e)})}})}}t.OKXSolanaProvider=c,t.default=c},81478:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TONCHAIN=void 0,(n||(t.TONCHAIN=n={})).MAINNET="-239"},82091:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.safeJsonParse=function(e){if("string"!=typeof e)throw(0,o.logDebug)(e),Error(`Cannot safe json parse value of type ${typeof e}`);try{return i(e)}catch(t){return console.error("safeJsonParse error:",t),e}},t.safeJsonStringify=function(e){return"string"==typeof e?e:r(e)||""};let o=n(33394),r=e=>JSON.stringify(e,(e,t)=>"bigint"==typeof t?t.toString()+"n":t),i=e=>{let t=e.replace(/:(\b\d{17,}|\b(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))(?=[,\}\]]|$)/g,(e,t)=>`:"${t}n"`);try{return JSON.parse(t,(e,t)=>"string"==typeof t&&t.match(/^\d+n$/)?BigInt(t.substring(0,t.length-1)):t)}catch(t){return JSON.parse(e)}}},83151:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OKXCONNECTOR_STORAGE_TOPIC_WALLET_EXPIRE_CACHE=t.OKXCONNECTOR_STORAGE_TOPIC_EXPIRE_CACHE=t.OKXCONNECTOR_STORAGE_PROTOCOL_CACHE=t.OKXCONNECTOR_STORAGE_CIPHER_METHOD=t.OKXCONNECTOR_STORAGE_CRYPTO_CIPHERIV=t.OKXCONNECTOR_STORAGER_CRYPTO_SALT=t.OKXCONNECTOR_STORAGE_CRYPTO_PASSWORD=t.OKXCONNECTOR_TON_KEY=t.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE=t.OKXCONNECTOR_TOKEN_CACHE=t.OKXCONNECTOR_JWT_KEY=t.OKXCONNECTOR_SESSION_PREFIX_KEY=t.OKXCONNECTOR_CRYPTO_KEY=t.OKXCONNECTOR_CACHE_KEY_DAPP=t.OKXCONNECTOR_CACHE_KEY=void 0,t.OKXCONNECTOR_CACHE_KEY="ck",t.OKXCONNECTOR_CACHE_KEY_DAPP="ck_dapp",t.OKXCONNECTOR_CRYPTO_KEY="cck_k",t.OKXCONNECTOR_SESSION_PREFIX_KEY="cspk_",t.OKXCONNECTOR_JWT_KEY="cjk_k",t.OKXCONNECTOR_TOKEN_CACHE="ct",t.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE="csp",t.OKXCONNECTOR_TON_KEY="OKXStorage_ctc",t.OKXCONNECTOR_STORAGE_CRYPTO_PASSWORD="scp",t.OKXCONNECTOR_STORAGER_CRYPTO_SALT="scs",t.OKXCONNECTOR_STORAGE_CRYPTO_CIPHERIV="scpc",t.OKXCONNECTOR_STORAGE_CIPHER_METHOD="aes-256-cbc",t.OKXCONNECTOR_STORAGE_PROTOCOL_CACHE="okx_connect_split_cache_key",t.OKXCONNECTOR_STORAGE_TOPIC_EXPIRE_CACHE="okx_connect_te_cache_key",t.OKXCONNECTOR_STORAGE_TOPIC_WALLET_EXPIRE_CACHE="okx_connect_twe_cache_key"},85236:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.OKXWalletName=t.creatOKXInjectWalletInfo=t.creatOKXMiniAppWalletInfo=t.creatOKXWalletInfo=t.ISignClientEvents=t.IEngine=t.IEngineEvents=t.ISignClient=t.getBigIntRpcId=t.formatJsonRpcRequest=t.isJsonRpcError=t.isJsonRpcResponse=t.parseConnectionError=t.isHttpUrl=t.formatJsonRpcError=void 0;var i=n(63172);Object.defineProperty(t,"formatJsonRpcError",{enumerable:!0,get:function(){return i.formatJsonRpcError}}),Object.defineProperty(t,"isHttpUrl",{enumerable:!0,get:function(){return i.isHttpUrl}}),Object.defineProperty(t,"parseConnectionError",{enumerable:!0,get:function(){return i.parseConnectionError}}),Object.defineProperty(t,"isJsonRpcResponse",{enumerable:!0,get:function(){return i.isJsonRpcResponse}}),Object.defineProperty(t,"isJsonRpcError",{enumerable:!0,get:function(){return i.isJsonRpcError}}),Object.defineProperty(t,"formatJsonRpcRequest",{enumerable:!0,get:function(){return i.formatJsonRpcRequest}}),Object.defineProperty(t,"getBigIntRpcId",{enumerable:!0,get:function(){return i.getBigIntRpcId}});var a=n(47381);Object.defineProperty(t,"ISignClient",{enumerable:!0,get:function(){return a.ISignClient}}),Object.defineProperty(t,"IEngineEvents",{enumerable:!0,get:function(){return a.IEngineEvents}}),Object.defineProperty(t,"IEngine",{enumerable:!0,get:function(){return a.IEngine}}),Object.defineProperty(t,"ISignClientEvents",{enumerable:!0,get:function(){return a.ISignClientEvents}}),r(n(51754),t);var s=n(78944);Object.defineProperty(t,"creatOKXWalletInfo",{enumerable:!0,get:function(){return s.creatOKXWalletInfo}}),Object.defineProperty(t,"creatOKXMiniAppWalletInfo",{enumerable:!0,get:function(){return s.creatOKXMiniAppWalletInfo}}),Object.defineProperty(t,"creatOKXInjectWalletInfo",{enumerable:!0,get:function(){return s.creatOKXInjectWalletInfo}}),Object.defineProperty(t,"OKXWalletName",{enumerable:!0,get:function(){return s.OKXWalletName}})},85469:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(86271),r=n(94306);t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var i=function(){function e(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return e.prototype._initState=function(){this._stateHi[0]=0x6a09e667,this._stateHi[1]=0xbb67ae85,this._stateHi[2]=0x3c6ef372,this._stateHi[3]=0xa54ff53a,this._stateHi[4]=0x510e527f,this._stateHi[5]=0x9b05688c,this._stateHi[6]=0x1f83d9ab,this._stateHi[7]=0x5be0cd19,this._stateLo[0]=0xf3bcc908,this._stateLo[1]=0x84caa73b,this._stateLo[2]=0xfe94f82b,this._stateLo[3]=0x5f1d36f1,this._stateLo[4]=0xade682d1,this._stateLo[5]=0x2b3e6c1f,this._stateLo[6]=0xfb41bd6b,this._stateLo[7]=0x137e2179},e.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},e.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},e.prototype.update=function(e,n){if(void 0===n&&(n=e.length),this._finished)throw Error("SHA512: can't update because hash was finished.");var o=0;if(this._bytesHashed+=n,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&n>0;)this._buffer[this._bufferLength++]=e[o++],n--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(n>=this.blockSize&&(o=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,e,o,n),n%=this.blockSize);n>0;)this._buffer[this._bufferLength++]=e[o++],n--;return this},e.prototype.finish=function(e){if(!this._finished){var t=this._bytesHashed,n=this._bufferLength,r=t%128<112?128:256;this._buffer[n]=128;for(var i=n+1;i<r-8;i++)this._buffer[i]=0;o.writeUint32BE(t/0x20000000|0,this._buffer,r-8),o.writeUint32BE(t<<3,this._buffer,r-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,r),this._finished=!0}for(var i=0;i<this.digestLength/8;i++)o.writeUint32BE(this._stateHi[i],e,8*i),o.writeUint32BE(this._stateLo[i],e,8*i+4);return this},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e.prototype.saveState=function(){if(this._finished)throw Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},e.prototype.restoreState=function(e){return this._stateHi.set(e.stateHi),this._stateLo.set(e.stateLo),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},e.prototype.cleanSavedState=function(e){r.wipe(e.stateHi),r.wipe(e.stateLo),e.buffer&&r.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},e}();t.SHA512=i;var a=new Int32Array([0x428a2f98,0xd728ae22,0x71374491,0x23ef65cd,0xb5c0fbcf,0xec4d3b2f,0xe9b5dba5,0x8189dbbc,0x3956c25b,0xf348b538,0x59f111f1,0xb605d019,0x923f82a4,0xaf194f9b,0xab1c5ed5,0xda6d8118,0xd807aa98,0xa3030242,0x12835b01,0x45706fbe,0x243185be,0x4ee4b28c,0x550c7dc3,0xd5ffb4e2,0x72be5d74,0xf27b896f,0x80deb1fe,0x3b1696b1,0x9bdc06a7,0x25c71235,0xc19bf174,0xcf692694,0xe49b69c1,0x9ef14ad2,0xefbe4786,0x384f25e3,0xfc19dc6,0x8b8cd5b5,0x240ca1cc,0x77ac9c65,0x2de92c6f,0x592b0275,0x4a7484aa,0x6ea6e483,0x5cb0a9dc,0xbd41fbd4,0x76f988da,0x831153b5,0x983e5152,0xee66dfab,0xa831c66d,0x2db43210,0xb00327c8,0x98fb213f,0xbf597fc7,0xbeef0ee4,0xc6e00bf3,0x3da88fc2,0xd5a79147,0x930aa725,0x6ca6351,0xe003826f,0x14292967,0xa0e6e70,0x27b70a85,0x46d22ffc,0x2e1b2138,0x5c26c926,0x4d2c6dfc,0x5ac42aed,0x53380d13,0x9d95b3df,0x650a7354,0x8baf63de,0x766a0abb,0x3c77b2a8,0x81c2c92e,0x47edaee6,0x92722c85,0x1482353b,0xa2bfe8a1,0x4cf10364,0xa81a664b,0xbc423001,0xc24b8b70,0xd0f89791,0xc76c51a3,0x654be30,0xd192e819,0xd6ef5218,0xd6990624,0x5565a910,0xf40e3585,0x5771202a,0x106aa070,0x32bbd1b8,0x19a4c116,0xb8d2d0c8,0x1e376c08,0x5141ab53,0x2748774c,0xdf8eeb99,0x34b0bcb5,0xe19b48a8,0x391c0cb3,0xc5c95a63,0x4ed8aa4a,0xe3418acb,0x5b9cca4f,0x7763e373,0x682e6ff3,0xd6b2b8a3,0x748f82ee,0x5defb2fc,0x78a5636f,0x43172f60,0x84c87814,0xa1f0ab72,0x8cc70208,0x1a6439ec,0x90befffa,0x23631e28,0xa4506ceb,0xde82bde9,0xbef9a3f7,0xb2c67915,0xc67178f2,0xe372532b,0xca273ece,0xea26619c,0xd186b8c7,0x21c0c207,0xeada7dd6,0xcde0eb1e,0xf57d4f7f,0xee6ed178,0x6f067aa,0x72176fba,0xa637dc5,0xa2c898a6,0x113f9804,0xbef90dae,0x1b710b35,0x131c471b,0x28db77f5,0x23047d84,0x32caab7b,0x40c72493,0x3c9ebe0a,0x15c9bebc,0x431d67c4,0x9c100d4c,0x4cc5d4be,0xcb3e42b6,0x597f299c,0xfc657e2a,0x5fcb6fab,0x3ad6faec,0x6c44198c,0x4a475817]);function s(e,t,n,r,i,s,c){for(var l,d,u,h,f,g,p,v,b=n[0],_=n[1],y=n[2],m=n[3],O=n[4],C=n[5],E=n[6],w=n[7],N=r[0],S=r[1],T=r[2],R=r[3],D=r[4],I=r[5],P=r[6],k=r[7];c>=128;){for(var K=0;K<16;K++){var A=8*K+s;e[K]=o.readUint32BE(i,A),t[K]=o.readUint32BE(i,A+4)}for(var K=0;K<80;K++){var x=b,L=_,M=y,j=m,U=O,W=C,X=E,H=w,B=N,J=S,q=T,$=R,F=D,V=I,G=P,z=k;if(l=w,f=65535&(d=k),g=d>>>16,p=65535&l,v=l>>>16,l=(O>>>14|D<<18)^(O>>>18|D<<14)^(D>>>9|O<<23),f+=65535&(d=(D>>>14|O<<18)^(D>>>18|O<<14)^(O>>>9|D<<23)),g+=d>>>16,p+=65535&l,v+=l>>>16,l=O&C^~O&E,f+=65535&(d=D&I^~D&P),g+=d>>>16,p+=65535&l,v+=l>>>16,l=a[2*K],f+=65535&(d=a[2*K+1]),g+=d>>>16,p+=65535&l,v+=l>>>16,l=e[K%16],f+=65535&(d=t[K%16]),g+=d>>>16,p+=65535&l,v+=l>>>16,g+=f>>>16,p+=g>>>16,v+=p>>>16,u=65535&p|v<<16,h=65535&f|g<<16,l=u,f=65535&(d=h),g=d>>>16,p=65535&l,v=l>>>16,l=(b>>>28|N<<4)^(N>>>2|b<<30)^(N>>>7|b<<25),f+=65535&(d=(N>>>28|b<<4)^(b>>>2|N<<30)^(b>>>7|N<<25)),g+=d>>>16,p+=65535&l,v+=l>>>16,l=b&_^b&y^_&y,f+=65535&(d=N&S^N&T^S&T),g+=d>>>16,p+=65535&l,v+=l>>>16,g+=f>>>16,p+=g>>>16,v+=p>>>16,H=65535&p|v<<16,z=65535&f|g<<16,l=j,f=65535&(d=$),g=d>>>16,p=65535&l,v=l>>>16,l=u,f+=65535&(d=h),g+=d>>>16,p+=65535&l,v+=l>>>16,g+=f>>>16,p+=g>>>16,v+=p>>>16,j=65535&p|v<<16,$=65535&f|g<<16,_=x,y=L,m=M,O=j,C=U,E=W,w=X,b=H,S=B,T=J,R=q,D=$,I=F,P=V,k=G,N=z,K%16==15)for(var A=0;A<16;A++)l=e[A],f=65535&(d=t[A]),g=d>>>16,p=65535&l,v=l>>>16,l=e[(A+9)%16],f+=65535&(d=t[(A+9)%16]),g+=d>>>16,p+=65535&l,v+=l>>>16,l=((u=e[(A+1)%16])>>>1|(h=t[(A+1)%16])<<31)^(u>>>8|h<<24)^u>>>7,f+=65535&(d=(h>>>1|u<<31)^(h>>>8|u<<24)^(h>>>7|u<<25)),g+=d>>>16,p+=65535&l,v+=l>>>16,l=((u=e[(A+14)%16])>>>19|(h=t[(A+14)%16])<<13)^(h>>>29|u<<3)^u>>>6,f+=65535&(d=(h>>>19|u<<13)^(u>>>29|h<<3)^(h>>>6|u<<26)),g+=d>>>16,p+=65535&l,v+=l>>>16,g+=f>>>16,p+=g>>>16,v+=p>>>16,e[A]=65535&p|v<<16,t[A]=65535&f|g<<16}l=b,f=65535&(d=N),g=d>>>16,p=65535&l,v=l>>>16,l=n[0],f+=65535&(d=r[0]),g+=d>>>16,p+=65535&l,v+=l>>>16,g+=f>>>16,p+=g>>>16,v+=p>>>16,n[0]=b=65535&p|v<<16,r[0]=N=65535&f|g<<16,l=_,f=65535&(d=S),g=d>>>16,p=65535&l,v=l>>>16,l=n[1],f+=65535&(d=r[1]),g+=d>>>16,p+=65535&l,v+=l>>>16,g+=f>>>16,p+=g>>>16,v+=p>>>16,n[1]=_=65535&p|v<<16,r[1]=S=65535&f|g<<16,l=y,f=65535&(d=T),g=d>>>16,p=65535&l,v=l>>>16,l=n[2],f+=65535&(d=r[2]),g+=d>>>16,p+=65535&l,v+=l>>>16,g+=f>>>16,p+=g>>>16,v+=p>>>16,n[2]=y=65535&p|v<<16,r[2]=T=65535&f|g<<16,l=m,f=65535&(d=R),g=d>>>16,p=65535&l,v=l>>>16,l=n[3],f+=65535&(d=r[3]),g+=d>>>16,p+=65535&l,v+=l>>>16,g+=f>>>16,p+=g>>>16,v+=p>>>16,n[3]=m=65535&p|v<<16,r[3]=R=65535&f|g<<16,l=O,f=65535&(d=D),g=d>>>16,p=65535&l,v=l>>>16,l=n[4],f+=65535&(d=r[4]),g+=d>>>16,p+=65535&l,v+=l>>>16,g+=f>>>16,p+=g>>>16,v+=p>>>16,n[4]=O=65535&p|v<<16,r[4]=D=65535&f|g<<16,l=C,f=65535&(d=I),g=d>>>16,p=65535&l,v=l>>>16,l=n[5],f+=65535&(d=r[5]),g+=d>>>16,p+=65535&l,v+=l>>>16,g+=f>>>16,p+=g>>>16,v+=p>>>16,n[5]=C=65535&p|v<<16,r[5]=I=65535&f|g<<16,l=E,f=65535&(d=P),g=d>>>16,p=65535&l,v=l>>>16,l=n[6],f+=65535&(d=r[6]),g+=d>>>16,p+=65535&l,v+=l>>>16,g+=f>>>16,p+=g>>>16,v+=p>>>16,n[6]=E=65535&p|v<<16,r[6]=P=65535&f|g<<16,l=w,f=65535&(d=k),g=d>>>16,p=65535&l,v=l>>>16,l=n[7],f+=65535&(d=r[7]),g+=d>>>16,p+=65535&l,v+=l>>>16,g+=f>>>16,p+=g>>>16,v+=p>>>16,n[7]=w=65535&p|v<<16,r[7]=k=65535&f|g<<16,s+=128,c-=128}return s}t.hash=function(e){var t=new i;t.update(e);var n=t.digest();return t.clean(),n}},86271:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(46366);function r(e,t,n){return void 0===t&&(t=new Uint8Array(2)),void 0===n&&(n=0),t[n+0]=e>>>8,t[n+1]=e>>>0,t}function i(e,t,n){return void 0===t&&(t=new Uint8Array(2)),void 0===n&&(n=0),t[n+0]=e>>>0,t[n+1]=e>>>8,t}function a(e,t){return void 0===t&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function s(e,t){return void 0===t&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function c(e,t){return void 0===t&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function l(e,t){return void 0===t&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}function d(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),t[n+0]=e>>>24,t[n+1]=e>>>16,t[n+2]=e>>>8,t[n+3]=e>>>0,t}function u(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),t[n+0]=e>>>0,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24,t}function h(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),d(e/0x100000000>>>0,t,n),d(e>>>0,t,n+4),t}function f(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),u(e>>>0,t,n),u(e/0x100000000>>>0,t,n+4),t}t.readInt16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16},t.readUint16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])>>>0},t.readInt16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])<<16>>16},t.readUint16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])>>>0},t.writeUint16BE=r,t.writeInt16BE=r,t.writeUint16LE=i,t.writeInt16LE=i,t.readInt32BE=a,t.readUint32BE=s,t.readInt32LE=c,t.readUint32LE=l,t.writeUint32BE=d,t.writeInt32BE=d,t.writeUint32LE=u,t.writeInt32LE=u,t.readInt64BE=function(e,t){void 0===t&&(t=0);var n=a(e,t),o=a(e,t+4);return 0x100000000*n+o-(o>>31)*0x100000000},t.readUint64BE=function(e,t){return void 0===t&&(t=0),0x100000000*s(e,t)+s(e,t+4)},t.readInt64LE=function(e,t){void 0===t&&(t=0);var n=c(e,t);return 0x100000000*c(e,t+4)+n-(n>>31)*0x100000000},t.readUint64LE=function(e,t){void 0===t&&(t=0);var n=l(e,t);return 0x100000000*l(e,t+4)+n},t.writeUint64BE=h,t.writeInt64BE=h,t.writeUint64LE=f,t.writeInt64LE=f,t.readUintBE=function(e,t,n){if(void 0===n&&(n=0),e%8!=0)throw Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-n)throw Error("readUintBE: array is too short for the given bitLength");for(var o=0,r=1,i=e/8+n-1;i>=n;i--)o+=t[i]*r,r*=256;return o},t.readUintLE=function(e,t,n){if(void 0===n&&(n=0),e%8!=0)throw Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-n)throw Error("readUintLE: array is too short for the given bitLength");for(var o=0,r=1,i=n;i<n+e/8;i++)o+=t[i]*r,r*=256;return o},t.writeUintBE=function(e,t,n,r){if(void 0===n&&(n=new Uint8Array(e/8)),void 0===r&&(r=0),e%8!=0)throw Error("writeUintBE supports only bitLengths divisible by 8");if(!o.isSafeInteger(t))throw Error("writeUintBE value must be an integer");for(var i=1,a=e/8+r-1;a>=r;a--)n[a]=t/i&255,i*=256;return n},t.writeUintLE=function(e,t,n,r){if(void 0===n&&(n=new Uint8Array(e/8)),void 0===r&&(r=0),e%8!=0)throw Error("writeUintLE supports only bitLengths divisible by 8");if(!o.isSafeInteger(t))throw Error("writeUintLE value must be an integer");for(var i=1,a=r;a<r+e/8;a++)n[a]=t/i&255,i*=256;return n},t.readFloat32BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t)},t.readFloat32LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!0)},t.readFloat64BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t)},t.readFloat64LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!0)},t.writeFloat32BE=function(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(n,e),t},t.writeFloat32LE=function(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(n,e,!0),t},t.writeFloat64BE=function(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(n,e),t},t.writeFloat64LE=function(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(n,e,!0),t}},86761:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CONNECT_ITEM_ERROR_CODES=void 0,function(e){e[e.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",e[e.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"}(n||(t.CONNECT_ITEM_ERROR_CODES=n={}))},86958:e=>{"use strict";e.exports=JSON.parse('{"name":"@okxconnect/core","version":"1.8.0","description":"OKX Connect core","main":"./src/index.js","keywords":["OKXConnect","OKX Connect"],"scripts":{"build":"npx tsc","local":"yarn install && npx tsc","remove":"rm -rf ./src  && rm -rf ./node_modules"},"author":"OKX Wallet","license":"MIT","dependencies":{"@stablelib/ed25519":"^1.0.2","@stablelib/random":"^1.0.1","@stablelib/sha256":"1.0.1","bs58":"^5.0.0","core-js":"2.6.12","cross-fetch":"^4.0.0","crypto-js":"^4.2.0","eventemitter3":"^5.0.1","isutf8":"^4.0.0","localforage":"^1.10.0","multiformats":"9.4.2","process":"^0.11.10","tweetnacl":"^1.0.3","tweetnacl-util":"^0.15.1","ua-parser-js":"^1.0.35","uint8arrays":"3.1.0"},"devDependencies":{"@types/crypto-js":"^4.2.2","@types/ua-parser-js":"^0.7.36","assert":"^2.1.0","eslint":"^9.7.0","events":"^3.3.0","jest":"^29.7.0","ts-loader":"^9.5.1","typescript":"^5.5.2"},"peerDependencies":{"@solana/web3.js":"^1.78.4"}}')},87096:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.Eip155Provider=void 0;let r=n(1461),i=n(62332),a=n(66352),s=n(97950);class c{constructor(){this.accountChangedEVMHandler=null}send(e){return o(this,void 0,void 0,function*(){var t;try{(0,i.logDebug)("Eip155Provider send request:",(0,i.safeJsonStringify)(e)),yield this.restoreConnect();let n=null;switch(e.method){case"personal_sign":e.params&&"message"in e.params&&(n={method:e.method,params:[e.params.message,e.address]});break;case"eth_sendTransaction":case"wallet_addEthereumChain":case"wallet_switchEthereumChain":e.params&&(n={method:e.method,params:[e.params]});break;case"eth_signTypedData_v4":e.params&&"typedDataJson"in e.params&&(null===(t=e.params)||void 0===t?void 0:t.typedDataJson)&&"string"==typeof e.params.typedDataJson&&(n={method:e.method,params:[e.address,e.params.typedDataJson]});break;case"wallet_watchAsset":e.params&&(n={method:e.method,params:e.params});break;default:n={method:e.method,params:e.injectParams}}if(n){if(("wallet_switchEthereumChain"===e.method||"wallet_addEthereumChain"===e.method)&&e.params&&"chainId"in e.params){(0,i.logDebug)("Eip155Provider send request switch requestParams:",(0,i.safeJsonStringify)(n));let t=parseInt(e.params.chainId,16).toString();yield window.okxwallet.request(n);let o=`eip155:${t}:${e.address}`;return(0,i.logDebug)("Eip155Provider send request switch result:",o),{result:o,method:e.method}}{let t=(0,i.getChainId)(e.chainId),o=`0x${Number(t).toString(16)}`;if((0,i.logDebug)("Eip155Provider current chainId:",t,o),o){yield window.okxwallet.request({method:"wallet_switchEthereumChain",params:[{chainId:o}]}),(0,i.logDebug)("Eip155Provider send request requestParams:",o,(0,i.safeJsonStringify)(n));let t=yield window.okxwallet.request(n);return(0,i.logDebug)("Eip155Provider send request result:",(0,i.safeJsonStringify)(t)),{result:t,method:e.method}}}}else throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED)}catch(e){throw(0,i.logDebug)("Eip155Provider encountered an error:",e),e}})}connectReady(){return!0}restoreConnect(){return(0,a.isDevice)("mobile")?window.okxwallet.request({method:"eth_requestAccounts"}):Promise.resolve()}parseConnectResponse(e,t,n,a,c,l){return o(this,void 0,void 0,function*(){try{let e=[];a.forEach(t=>{t.namespace===r.NameSpaceKeyEip155&&e.push(...t.chains)});let t=[],n={};if(e.forEach(e=>{let o=(0,i.getChainId)(e),r=c.address.find(t=>t.chainId===o&&60===t.coinType||t.namespaceChainId===e);r&&(t.push(e+":"+r.address),n[e]={publicKey:r.publicKey})}),t&&t.length>0)return{namespace:r.NameSpaceKeyEip155,addresses:t,methods:[...s.Eip55Methods],extra:n};return}catch(e){throw e}})}connect(){return o(this,void 0,void 0,function*(){return window.okxwallet.request({method:"eth_requestAccounts"})})}singleConnect(){return this.connect()}addListener(e){console.log("window.okxwallet configEventWithKey: eip155"),this.accountChangedEVMHandler=t=>{console.log("window.okxwallet configEventWithKey_evm:",Date.now(),"eip155",t),t&&t.length>0&&e()},window.okxwallet.on("accountsChanged",this.accountChangedEVMHandler)}removeListener(){this.accountChangedEVMHandler&&window.okxwallet.removeListener("accountsChanged",this.accountChangedEVMHandler)}}t.Eip155Provider=c},87849:(e,t,n)=>{"use strict";t.y=void 0;var o=n(80462);Object.defineProperty(t,"y",{enumerable:!0,get:function(){return o.OKXSolanaProvider}})},88193:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.InjectConnector=void 0;let r=n(1461),i=n(62332),a=n(14103),s=n(11509),c=n(78944),l=n(70742),d=n(66352),u=n(47813),h=n(42736),f=n(15985),g=n(11769),p=n(14904),v=n(11801);class b{constructor(){this.disconnectListener=[],this.providerMap=new Map,this.disconnectHandler=null,this.walletName="",this.walletNameKey="",this.enable=!0,this.providerMap.set(r.NameSpaceKeyEip155,new h.Eip155Provider),this.providerMap.set(r.NameSpaceKeySOL,new s.SolProvider),this.providerMap.set(r.NameSpaceKeyAptos,new l.AptosProvider),this.providerMap.set(r.NameSpaceKeyTON,new u.TONProvider),this.providerMap.set(r.NameSpaceKeySui,new f.SuiProvider),this.providerMap.set(r.NameSpaceKeyBtc,new v.BtcProvider)}setAccountChangeListener(e){(0,i.logDebug)("setAccountChangeListener: inject",e),this.accountChangeListener=e}setConnectionManager(e){this.connectionManager=e}getInjectProvider(e){if(e){for(let[t,n]of this.providerMap.entries())if(e.includes(t))return n}}openWallet(e,t){return o(this,void 0,void 0,function*(){if((0,i.logDebug)("InjectEngine connect begin:",JSON.stringify(e)),!e)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR);this.dappInfo=e.connectRequest.dAppInfo;var t,n,o,a=e.connectRequest;try{if(window&&window.okxwallet){if(a.requests){let e=a.requests.find(e=>"requestAccounts"===e.name),i=yield window.okxwallet.getVersion(),l={method:"connect",requestId:a.requestId,payload:{wallet:{platform:null!==(t=navigator.platform)&&void 0!==t?t:"/",appName:c.OKXInjectWalletName,appVersion:null!=i?i:"1.0.0",maxProtocolVersion:1},responses:[]}},u={name:"requestAccounts",accounts:[]};l.payload.responses.push(u),yield this.disconnect();let h=null!==(n=e.requiredNamespaces)&&void 0!==n?n:[],f=null!==(o=e.optionalNamespaces)&&void 0!==o?o:[],g=!0,p=!1;if(h.length+f.length===1&&!(0,d.isDevice)("mobile")){let e=1===h.length?h[0]:f[0],t=this.getInjectProvider(e.namespace);(yield null==t?void 0:t.singleConnect(e,this.dappInfo))&&(p=!0,g=!1)}var s=yield this.getAccountByRequestWallets(g,!1,p,h,f);if(s){if(u.accounts.push(...s),0===u.accounts.length)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"connect connectAccounts is null")}else throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"connect requestWallets is null");this.connectResultListener&&(this.disconnectHandler&&window.okxwallet.removeListener("disconnect",this.disconnectHandler),this.disconnectHandler=()=>{console.log("window.okxwallet disconnect:"),this.disconnectListener.forEach(e=>e()),this.disconnectListener=[]},window.okxwallet.on("disconnect",this.disconnectHandler),this.connectResultListener(l))}}else throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR)}catch(e){var l=r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR;e instanceof r.OKXConnectError&&(l=e.code,e.message),this.connectResultListener&&this.connectResultListener({requestId:"-1",method:"connect_error",payload:{code:l}})}})}disconnect(){return o(this,void 0,void 0,function*(){(0,i.logDebug)("InjectEngine ==>> disconnect  okxwallet.disconnect()"),window.okxwallet&&(yield window.okxwallet.disconnect(),(0,i.logDebug)("InjectEngine ==>> disconnect end okxwallet.disconnect()"))})}getRequestId(){let e=Date.now().toString();return(0,i.logDebug)("InjectEngine ==>> getRequestId ==>",e),e}send(e,t){return o(this,void 0,void 0,function*(){var n;try{if((0,i.logDebug)("InjectEngine send  > request:",(0,i.safeJsonStringify)(e)),"disconnect"===e.method){yield this.disconnect(),this.disconnectListener.forEach(e=>e()),this.disconnectListener=[],null===(n=t.onAck)||void 0===n||n.call(t);return}yield this.checkWalletMatch();let o=this.getInjectProvider((0,i.getNamespaceKeyByChain)(e.chainId));if(o){o.send(e).then(e=>{var n;(0,i.logDebug)("InjectEngine ==>> send > result:",e),null===(n=t.resolve)||void 0===n||n.call(t,e)}).catch(n=>{var o;let a=n.code;4001===a&&(a=r.OKX_CONNECT_ERROR_CODES.USER_REJECTS_ERROR);let s={requestId:this.getRequestId(),method:e.method,error:{code:a,message:n.message}};(0,i.logDebug)("InjectEngine ==>> send > errorResponse:",JSON.stringify(s)),null===(o=t.resolve)||void 0===o||o.call(t,s)});return}throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.CHAIN_NOT_SUPPORTED)}catch(e){return(0,i.logDebug)("InjectEngine ==>> send  ===> error:",e),Promise.reject(e)}})}checkWalletMatch(){return o(this,void 0,void 0,function*(){return new Promise((e,t)=>{var n;let o=null===(n=this.connectionManager)||void 0===n?void 0:n.getSessionContent("connectSession");o||t(new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED)),this.restoreconnect(o,n=>{n?e():t(new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED))})})})}checkAccountChanged(){return o(this,void 0,void 0,function*(){var e;try{let t=null===(e=this.connectionManager)||void 0===e?void 0:e.getSessionContent("connectSession");if(!t)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED);(0,i.logDebug)("inject-connector checkAccountChanged --sessionInfo:",JSON.stringify(t));let n=this.getRequireNameSpaceFromSession(t);(0,i.logDebug)("inject-connector checkAccountChanged --requiredNamespaces:",JSON.stringify(n));let o=yield this.getAccountByRequestWallets(!1,!0,!1,n,[]);if((0,i.logDebug)("inject-connector checkAccountChanged --accounts:",JSON.stringify(o)),o){let e={};(0,p.buildAccountNameSpaces)(o,e),this.compareAndModifyNamespaces(t.namespaces,e)||((0,i.logDebug)("inject-connector checkAccountChanged --result sessionLocal:",JSON.stringify(t)),this.accountChangeListener?((0,i.logDebug)("inject-connector checkAccountChanged -accountChangeListener:",this.accountChangeListener),this.accountChangeListener(t)):((0,i.logDebug)("inject-connector checkAccountChanged disconnect:"),yield this.disconnect()))}else throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR,"connect requestWallets is null")}catch(e){throw(0,i.logDebug)("inject-connector restoreconnect catch error",JSON.stringify(e)),e}})}compareAndModifyNamespaces(e,t){let n=!0;for(let o in e)if(t[o]){let r=e[o],a=t[o];(0,i.logDebug)("inject-connector checkAccountChanged ns1:",JSON.stringify(r)),(0,i.logDebug)("inject-connector checkAccountChanged ns2:",JSON.stringify(a)),JSON.stringify([...r.accounts].sort())!==JSON.stringify([...a.accounts].sort())&&(n=!1,r.accounts=[...a.accounts],r.extra=Object.assign({},a.extra),r.payload=Object.assign({},a.payload)),(0,i.logDebug)("inject-connector checkAccountChanged new ns1:",JSON.stringify(r))}return(0,i.logDebug)(`inject-connector checkAccountChanged compareAndModifyNamespaces ===> ${n}`),n}clearData(){this.connectResultListener=void 0}addDisconnectListener(e){this.disconnectListener.push(e)}setOnConnectResultListener(e){this.connectResultListener=e}connectManagerDisconnect(){return o(this,arguments,void 0,function*(e=!1){})}getCurrentConnectionReady(e){return!!e&&e.every(e=>{var t;return null===(t=this.getInjectProvider(e))||void 0===t?void 0:t.connectReady()})}getTag(){return a.OKX_INJECT_WALLET}toJSON(){return"inject-connector"}getRequireNameSpaceFromSession(e){var t,n,o=[];for(let i in e.namespaces){let a=e.namespaces[i],s={namespace:i,chains:a.chains};if(i===r.NameSpaceKeyAptos){let e=[];a.chains.forEach(t=>{let n=(0,g.replaceChainNameToChainId)(t);e.push(n)}),s={namespace:i,chains:e}}else if(i===r.NameSpaceKeyTON){let e,o;(null===(t=a.payload)||void 0===t?void 0:t.ton_proof)&&(e=null===(n=a.payload)||void 0===n?void 0:n.ton_proof).proof.payload&&(o={name:"ton_proof",payload:e.proof.payload}),s={namespace:i,chains:a.chains,params:{ton_addr:{name:"ton_addr"},ton_proof:o}}}o.push(s)}return o}restoreconnect(e,t){if(!window.okxwallet){t(null);return}this.dappInfo=null===(n=e.sessionConfig)||void 0===n?void 0:n.dappInfo,(0,i.logDebug)("inject-connector restoreconnect --sessionInfo:",JSON.stringify(e));var n,o=this.getRequireNameSpaceFromSession(e);(0,i.logDebug)("inject-connector restoreconnect --requiredNamespaces:",JSON.stringify(o)),this.getAccountByRequestWallets(!1,!1,!1,o,[]).then(n=>{(0,i.logDebug)("inject-connector restoreconnect --accounts:",JSON.stringify(n));let o=!0;for(let t in e.namespaces){var a=n.find(e=>e.namespace===t),s=e.namespaces[t].accounts;if(!a)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR,"resotreconnect error: accountItem error");let c=s;t===r.NameSpaceKeyAptos&&c&&c.length>0&&(c=s.map(e=>(0,g.replaceChainNameToChainId)(e))),a.addresses.length===c.length&&a.addresses.slice().sort().every((e,n)=>{if(t!==r.NameSpaceKeyAptos)return e===c.slice().sort()[n];{let t=c.slice().sort()[n];return(0,i.logDebug)("check aptos address -value and aptosAdd--",e,t),t===e}})||(o=!1)}if(o)t(e);else throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.BAD_REQUEST_ERROR,"resotreconnect error: address not as same as session")}).catch(e=>{(0,i.logDebug)("inject-connector restoreconnect catch error",JSON.stringify(e)),t(null)})}getAccountByRequestWallets(e,t,n,a,s){return o(this,void 0,void 0,function*(){try{let h;var o=[],c=[];if((0,d.isDevice)("mobile")){var l=yield window.okxwallet.connectWallet(e,{requiredNamespaces:a,optionalNamespaces:s});o.push(l)}else o=yield window.okxwallet.requestWallets(e);var u=[...null!=a?a:[],...null!=s?s:[]];let f=o[0];if((0,i.logDebug)(" InjectEngine connect connectAccounts:",JSON.stringify(f)),u&&f&&f.address)for(let[o,r]of this.providerMap.entries()){let i=yield r.parseConnectResponse(e,t,n,u,f,this.dappInfo);i&&(h=o,c.push(i))}let g=a.every(e=>{let t=c.find(t=>t.namespace===e.namespace);return!!t&&e.chains.every(e=>!!t.addresses.find(t=>t.startsWith(e+":")))});if((0,i.logDebug)("InjectEngine connect requiredNamespaces:",JSON.stringify(a)),(0,i.logDebug)("InjectEngine connect accountResult:",JSON.stringify(c)),!g)throw yield this.disconnect(),new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.CHAIN_NOT_SUPPORTED);return(0,d.isDevice)("mobile")||(this.configEventWithKey(h),yield window.okxwallet.requestWallets(e)),c}catch(e){if(e&&"object"==typeof e&&"code"in e&&4001===e.code)throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.USER_REJECTS_ERROR);throw new r.OKXConnectError(r.OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR)}})}configEventWithKey(e){var t,n;for(let e in this.providerMap)null===(t=this.providerMap.get(e))||void 0===t||t.removeListener();null===(n=this.getInjectProvider(e))||void 0===n||n.addListener(()=>{this.checkAccountChanged().catch(e=>{console.log("window.okxwallet configEventWithKey error: ",e)})})}}t.InjectConnector=b},89675:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Storage=t.Engine=t.WalletConnectionManager=t.ConnectionManager=t.OKXWalletConnector=void 0;var o=n(34221);Object.defineProperty(t,"OKXWalletConnector",{enumerable:!0,get:function(){return o.OKXWalletConnector}});var r=n(39628);Object.defineProperty(t,"ConnectionManager",{enumerable:!0,get:function(){return r.ConnectionManager}});var i=n(39819);Object.defineProperty(t,"WalletConnectionManager",{enumerable:!0,get:function(){return i.WalletConnectionManager}});var a=n(74823);Object.defineProperty(t,"Engine",{enumerable:!0,get:function(){return a.Engine}});var s=n(51766);Object.defineProperty(t,"Storage",{enumerable:!0,get:function(){return s.Storage}})},94306:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wipe=function(e){for(var t=0;t<e.length;t++)e[t]=0;return e}},97950:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BtcMethods=t.SuiMethods=t.TONMethods=t.AptosMethods=t.SOLANAMethods=t.Eip55Methods=void 0,t.hasOKXInjectedProvider=function(){return void 0!==function(e){let t=(e,n)=>{let[o,...r]=n.split("."),i=e[o];if(i)return 0===r.length?i:t(i,r.join("."))};if("undefined"!=typeof window)return t(window,e)}("okxwallet")},t.Eip55Methods=["personal_sign","eth_signTypedData_v4","eth_sendTransaction","wallet_addEthereumChain","wallet_watchAsset","wallet_switchEthereumChain","eth_requestAccounts","eth_accounts","eth_chainId"],t.SOLANAMethods=["solana_signTransaction","solana_signMessage","solana_signAllTransactions","solana_signAndSendTransaction"],t.AptosMethods=["aptos_signMessage","aptos_signTransaction","aptos_signAndSubmitTransaction"],t.TONMethods=["ton_sendTransaction"],t.SuiMethods=["sui_signMessage","sui_signPersonalMessage","sui_signTransactionBlock","sui_signAndExecuteTransactionBlock"],t.BtcMethods=["btc_signMessage","btc_signPsbts","btc_send","btc_sendInscription","btc_signAndPushPsbt","btc_inscribeTransfer","btc_sendRunes"]}}]);